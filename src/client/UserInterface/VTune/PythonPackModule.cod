; Listing generated by Microsoft (R) Optimizing Compiler Version 19.28.29335.0 

	TITLE	D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\UserInterface\PythonPackModule.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?g_adwEncryptKey@@3PAKA				; g_adwEncryptKey
PUBLIC	?g_adwDecryptKey@@3PAKA				; g_adwDecryptKey
_BSS	SEGMENT
?g_adwEncryptKey@@3PAKA DD 04H DUP (?)			; g_adwEncryptKey
?g_adwDecryptKey@@3PAKA DD 04H DUP (?)			; g_adwDecryptKey
_BSS	ENDS
PUBLIC	?initpack@@YAXXZ				; initpack
PUBLIC	?__BuildClientKey_20050304Myevan@CAccountConnector@@IAEXXZ ; CAccountConnector::__BuildClientKey_20050304Myevan
PUBLIC	?GetKey_20050304Myevan@@YAPBEXZ			; GetKey_20050304Myevan
PUBLIC	?packExist@@YAPAU_object@@PAU1@0@Z		; packExist
PUBLIC	?packGet@@YAPAU_object@@PAU1@0@Z		; packGet
PUBLIC	?ms_singleton@?$CSingleton@VCEterPackManager@@@@0PAVCEterPackManager@@A ; CSingleton<CEterPackManager>::ms_singleton
PUBLIC	?s_adwKey@?1??GetKey_20050304Myevan@@YAPBEXZ@4RCKC ; `GetKey_20050304Myevan'::`2'::s_adwKey
PUBLIC	??_C@_01KBJDNOO@i@				; `string'
PUBLIC	??_C@_03DEFKFCAB@?4py@				; `string'
PUBLIC	??_C@_04DJODFCKA@?4pyc@				; `string'
PUBLIC	??_C@_04LCMACLFG@?4txt@				; `string'
PUBLIC	??_C@_02OIKAIHIF@s?$CD@				; `string'
PUBLIC	??_C@_05IDMALMPP@Exist@				; `string'
PUBLIC	??_C@_03NNDHPFFO@Get@				; `string'
PUBLIC	??_C@_04IPANLPFO@pack@				; `string'
EXTRN	_memcpy:PROC
EXTRN	_strrchr:PROC
EXTRN	__stricmp:PROC
EXTRN	__imp__Py_BuildValue:PROC
EXTRN	__imp__Py_InitModule4:PROC
EXTRN	?PyTuple_GetString@@YA_NPAU_object@@HPAPAD@Z:PROC ; PyTuple_GetString
EXTRN	?Py_BuildException@@YAPAU_object@@PBDZZ:PROC	; Py_BuildException
EXTRN	??0CMappedFile@@QAE@XZ:PROC			; CMappedFile::CMappedFile
EXTRN	??1CMappedFile@@UAE@XZ:PROC			; CMappedFile::~CMappedFile
EXTRN	?Size@CMappedFile@@QAEKXZ:PROC			; CMappedFile::Size
EXTRN	?random@@YAKXZ:PROC				; random
EXTRN	?Get@CEterPackManager@@QAE_NAAVCMappedFile@@PBDPAPBX@Z:PROC ; CEterPackManager::Get
EXTRN	?isExist@CEterPackManager@@QAE_NPBD@Z:PROC	; CEterPackManager::isExist
EXTRN	_tea_encrypt:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	___CxxFrameHandler3:PROC
EXTRN	___security_cookie:DWORD
;	COMDAT ?ms_singleton@?$CSingleton@VCEterPackManager@@@@0PAVCEterPackManager@@A
_BSS	SEGMENT
?ms_singleton@?$CSingleton@VCEterPackManager@@@@0PAVCEterPackManager@@A DD 01H DUP (?) ; CSingleton<CEterPackManager>::ms_singleton
_BSS	ENDS
;	COMDAT ?s_adwKey@?1??GetKey_20050304Myevan@@YAPBEXZ@4RCKC
_BSS	SEGMENT
?s_adwKey@?1??GetKey_20050304Myevan@@YAPBEXZ@4RCKC DD 0792H DUP (?) ; `GetKey_20050304Myevan'::`2'::s_adwKey
_BSS	ENDS
;	COMDAT ??_C@_04IPANLPFO@pack@
CONST	SEGMENT
??_C@_04IPANLPFO@pack@ DB 'pack', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_03NNDHPFFO@Get@
CONST	SEGMENT
??_C@_03NNDHPFFO@Get@ DB 'Get', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_05IDMALMPP@Exist@
CONST	SEGMENT
??_C@_05IDMALMPP@Exist@ DB 'Exist', 00H			; `string'
CONST	ENDS
;	COMDAT ?s_methods@?1??initpack@@YAXXZ@4PAUPyMethodDef@@A
_DATA	SEGMENT
?s_methods@?1??initpack@@YAXXZ@4PAUPyMethodDef@@A DD FLAT:??_C@_05IDMALMPP@Exist@ ; `initpack'::`2'::s_methods
	DD	FLAT:?packExist@@YAPAU_object@@PAU1@0@Z
	DD	01H
	ORG $+4
	DD	FLAT:??_C@_03NNDHPFFO@Get@
	DD	FLAT:?packGet@@YAPAU_object@@PAU1@0@Z
	DD	01H
	ORG $+4
	DD	00H
	DD	00H
	ORG $+8
_DATA	ENDS
;	COMDAT ??_C@_02OIKAIHIF@s?$CD@
CONST	SEGMENT
??_C@_02OIKAIHIF@s?$CD@ DB 's#', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_04LCMACLFG@?4txt@
CONST	SEGMENT
??_C@_04LCMACLFG@?4txt@ DB '.txt', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_04DJODFCKA@?4pyc@
CONST	SEGMENT
??_C@_04DJODFCKA@?4pyc@ DB '.pyc', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_03DEFKFCAB@?4py@
CONST	SEGMENT
??_C@_03DEFKFCAB@?4py@ DB '.py', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_01KBJDNOO@i@
CONST	SEGMENT
??_C@_01KBJDNOO@i@ DB 'i', 00H				; `string'
CONST	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__unwindtable$?packGet@@YAPAU_object@@PAU1@0@Z DD 0ffffffffH
	DD	FLAT:__unwindfunclet$?packGet@@YAPAU_object@@PAU1@0@Z$0
__ehfuncinfo$?packGet@@YAPAU_object@@PAU1@0@Z DD 019930522H
	DD	01H
	DD	FLAT:__unwindtable$?packGet@@YAPAU_object@@PAU1@0@Z
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
xdata$x	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\UserInterface\PythonPackModule.cpp
; File C:\Program Files (x86)\Windows Kits\10\Include\10.0.18362.0\ucrt\string.h
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\UserInterface\PythonPackModule.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterBase\Singleton.h
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\UserInterface\PythonPackModule.cpp
;	COMDAT ?packGet@@YAPAU_object@@PAU1@0@Z
_TEXT	SEGMENT
$T2 = -36						; size = 4
$T3 = -32						; size = 4
__String$ = -28						; size = 4
_pData$4 = -24						; size = 4
_strFileName$ = -20					; size = 4
_pcExt$ = -16						; size = 4
__$EHRec$ = -12						; size = 12
_file$5 = 0						; size = 324
__$ArrayPad$ = 324					; size = 4
_poSelf$ = 336						; size = 4
_poArgs$ = 340						; size = 4
?packGet@@YAPAU_object@@PAU1@0@Z PROC			; packGet, COMDAT

; 52   : {

  00000	55		 push	 ebp
  00001	8d ac 24 b8 fe
	ff ff		 lea	 ebp, DWORD PTR [esp-328]
  00008	81 ec 48 01 00
	00		 sub	 esp, 328		; 00000148H
  0000e	6a ff		 push	 -1
  00010	68 00 00 00 00	 push	 __ehhandler$?packGet@@YAPAU_object@@PAU1@0@Z
  00015	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  0001b	50		 push	 eax
  0001c	83 ec 18	 sub	 esp, 24			; 00000018H
  0001f	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00024	33 c5		 xor	 eax, ebp
  00026	89 85 44 01 00
	00		 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  0002c	50		 push	 eax
  0002d	8d 45 f4	 lea	 eax, DWORD PTR __$EHRec$[ebp]
  00030	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax

; 53   : 	char * strFileName;
; 54   : 	
; 55   : 	if (!PyTuple_GetString(poArgs, 0, &strFileName))

  00036	8d 45 ec	 lea	 eax, DWORD PTR _strFileName$[ebp]
  00039	50		 push	 eax
  0003a	6a 00		 push	 0
  0003c	ff b5 54 01 00
	00		 push	 DWORD PTR _poArgs$[ebp]
  00042	e8 00 00 00 00	 call	 ?PyTuple_GetString@@YA_NPAU_object@@HPAPAD@Z ; PyTuple_GetString
  00047	83 c4 0c	 add	 esp, 12			; 0000000cH
  0004a	0f b6 c0	 movzx	 eax, al
  0004d	85 c0		 test	 eax, eax
  0004f	75 0d		 jne	 SHORT $LN2@packGet

; 56   : 		return Py_BuildException();

  00051	6a 00		 push	 0
  00053	e8 00 00 00 00	 call	 ?Py_BuildException@@YAPAU_object@@PBDZZ ; Py_BuildException
  00058	59		 pop	 ecx
  00059	e9 cc 00 00 00	 jmp	 $LN1@packGet
$LN2@packGet:

; 59   : 	const char* pcExt = strrchr(strFileName, '.');

  0005e	8b 45 ec	 mov	 eax, DWORD PTR _strFileName$[ebp]
  00061	89 45 e4	 mov	 DWORD PTR __String$[ebp], eax
; File C:\Program Files (x86)\Windows Kits\10\Include\10.0.18362.0\ucrt\string.h

; 518  :         return const_cast<char*>(strrchr(static_cast<char const*>(_String), _Ch));

  00064	6a 2e		 push	 46			; 0000002eH
  00066	ff 75 e4	 push	 DWORD PTR __String$[ebp]
  00069	e8 00 00 00 00	 call	 _strrchr
  0006e	59		 pop	 ecx
  0006f	59		 pop	 ecx
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\UserInterface\PythonPackModule.cpp

; 59   : 	const char* pcExt = strrchr(strFileName, '.');

  00070	89 45 f0	 mov	 DWORD PTR _pcExt$[ebp], eax

; 60   : 	if (pcExt) // 확장자가 있고

  00073	83 7d f0 00	 cmp	 DWORD PTR _pcExt$[ebp], 0
  00077	0f 84 a5 00 00
	00		 je	 $LN3@packGet

; 61   : 	{
; 62   : 		if ((stricmp(pcExt, ".py") == 0) ||
; 63   : 			(stricmp(pcExt, ".pyc") == 0) ||

  0007d	68 00 00 00 00	 push	 OFFSET ??_C@_03DEFKFCAB@?4py@
  00082	ff 75 f0	 push	 DWORD PTR _pcExt$[ebp]
  00085	e8 00 00 00 00	 call	 __stricmp
  0008a	59		 pop	 ecx
  0008b	59		 pop	 ecx
  0008c	85 c0		 test	 eax, eax
  0008e	74 26		 je	 SHORT $LN5@packGet
  00090	68 00 00 00 00	 push	 OFFSET ??_C@_04DJODFCKA@?4pyc@
  00095	ff 75 f0	 push	 DWORD PTR _pcExt$[ebp]
  00098	e8 00 00 00 00	 call	 __stricmp
  0009d	59		 pop	 ecx
  0009e	59		 pop	 ecx
  0009f	85 c0		 test	 eax, eax
  000a1	74 13		 je	 SHORT $LN5@packGet
  000a3	68 00 00 00 00	 push	 OFFSET ??_C@_04LCMACLFG@?4txt@
  000a8	ff 75 f0	 push	 DWORD PTR _pcExt$[ebp]
  000ab	e8 00 00 00 00	 call	 __stricmp
  000b0	59		 pop	 ecx
  000b1	59		 pop	 ecx
  000b2	85 c0		 test	 eax, eax
  000b4	75 6c		 jne	 SHORT $LN3@packGet
$LN5@packGet:

; 64   : 			(stricmp(pcExt, ".txt") == 0))
; 65   : 		{
; 66   : 			CMappedFile file;

  000b6	8d 4d 00	 lea	 ecx, DWORD PTR _file$5[ebp]
  000b9	e8 00 00 00 00	 call	 ??0CMappedFile@@QAE@XZ	; CMappedFile::CMappedFile
  000be	83 65 fc 00	 and	 DWORD PTR __$EHRec$[ebp+8], 0

; 67   : 			const void * pData = NULL;

  000c2	83 65 e8 00	 and	 DWORD PTR _pData$4[ebp], 0
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterBase\Singleton.h

; 27   : 		return (*ms_singleton);

  000c6	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_singleton@?$CSingleton@VCEterPackManager@@@@0PAVCEterPackManager@@A ; CSingleton<CEterPackManager>::ms_singleton
  000cb	89 45 e0	 mov	 DWORD PTR $T3[ebp], eax
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\UserInterface\PythonPackModule.cpp

; 69   : 			if (CEterPackManager::Instance().Get(file,strFileName,&pData))

  000ce	8d 45 e8	 lea	 eax, DWORD PTR _pData$4[ebp]
  000d1	50		 push	 eax
  000d2	ff 75 ec	 push	 DWORD PTR _strFileName$[ebp]
  000d5	8d 45 00	 lea	 eax, DWORD PTR _file$5[ebp]
  000d8	50		 push	 eax
  000d9	8b 4d e0	 mov	 ecx, DWORD PTR $T3[ebp]
  000dc	e8 00 00 00 00	 call	 ?Get@CEterPackManager@@QAE_NAAVCMappedFile@@PBDPAPBX@Z ; CEterPackManager::Get
  000e1	0f b6 c0	 movzx	 eax, al
  000e4	85 c0		 test	 eax, eax
  000e6	74 2e		 je	 SHORT $LN6@packGet

; 70   : 				return Py_BuildValue("s#",pData, file.Size());

  000e8	8d 4d 00	 lea	 ecx, DWORD PTR _file$5[ebp]
  000eb	e8 00 00 00 00	 call	 ?Size@CMappedFile@@QAEKXZ ; CMappedFile::Size
  000f0	50		 push	 eax
  000f1	ff 75 e8	 push	 DWORD PTR _pData$4[ebp]
  000f4	68 00 00 00 00	 push	 OFFSET ??_C@_02OIKAIHIF@s?$CD@
  000f9	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__Py_BuildValue
  000ff	83 c4 0c	 add	 esp, 12			; 0000000cH
  00102	89 45 dc	 mov	 DWORD PTR $T2[ebp], eax
  00105	83 4d fc ff	 or	 DWORD PTR __$EHRec$[ebp+8], -1
  00109	8d 4d 00	 lea	 ecx, DWORD PTR _file$5[ebp]
  0010c	e8 00 00 00 00	 call	 ??1CMappedFile@@UAE@XZ	; CMappedFile::~CMappedFile
  00111	8b 45 dc	 mov	 eax, DWORD PTR $T2[ebp]
  00114	eb 14		 jmp	 SHORT $LN1@packGet
$LN6@packGet:

; 71   : 		}

  00116	83 4d fc ff	 or	 DWORD PTR __$EHRec$[ebp+8], -1
  0011a	8d 4d 00	 lea	 ecx, DWORD PTR _file$5[ebp]
  0011d	e8 00 00 00 00	 call	 ??1CMappedFile@@UAE@XZ	; CMappedFile::~CMappedFile
$LN3@packGet:

; 72   : 	}
; 73   : 
; 74   : 	return Py_BuildException();

  00122	6a 00		 push	 0
  00124	e8 00 00 00 00	 call	 ?Py_BuildException@@YAPAU_object@@PBDZZ ; Py_BuildException
  00129	59		 pop	 ecx
$LN1@packGet:

; 75   : }

  0012a	8b 4d f4	 mov	 ecx, DWORD PTR __$EHRec$[ebp]
  0012d	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00134	59		 pop	 ecx
  00135	8b 8d 44 01 00
	00		 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0013b	33 cd		 xor	 ecx, ebp
  0013d	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00142	81 c5 48 01 00
	00		 add	 ebp, 328		; 00000148H
  00148	c9		 leave
  00149	c3		 ret	 0
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__unwindfunclet$?packGet@@YAPAU_object@@PAU1@0@Z$0:
  00000	8d 4d 00	 lea	 ecx, DWORD PTR _file$5[ebp]
  00003	e9 00 00 00 00	 jmp	 ??1CMappedFile@@UAE@XZ	; CMappedFile::~CMappedFile
  00008	cc		 int	 3
  00009	cc		 int	 3
  0000a	cc		 int	 3
  0000b	cc		 int	 3
  0000c	cc		 int	 3
__ehhandler$?packGet@@YAPAU_object@@PAU1@0@Z:
  0000d	90		 npad	 1
  0000e	90		 npad	 1
  0000f	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  00013	8d 42 0c	 lea	 eax, DWORD PTR [edx+12]
  00016	8b 4a e4	 mov	 ecx, DWORD PTR [edx-28]
  00019	33 c8		 xor	 ecx, eax
  0001b	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00020	8b 8a 50 01 00
	00		 mov	 ecx, DWORD PTR [edx+336]
  00026	33 c8		 xor	 ecx, eax
  00028	e8 00 00 00 00	 call	 @__security_check_cookie@4
  0002d	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$?packGet@@YAPAU_object@@PAU1@0@Z
  00032	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
?packGet@@YAPAU_object@@PAU1@0@Z ENDP			; packGet
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\UserInterface\PythonPackModule.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterBase\Singleton.h
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\UserInterface\PythonPackModule.cpp
;	COMDAT ?packExist@@YAPAU_object@@PAU1@0@Z
_TEXT	SEGMENT
$T1 = -12						; size = 4
_strFileName$ = -8					; size = 4
tv79 = -4						; size = 4
_poSelf$ = 8						; size = 4
_poArgs$ = 12						; size = 4
?packExist@@YAPAU_object@@PAU1@0@Z PROC			; packExist, COMDAT

; 42   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH

; 43   : 	char * strFileName;
; 44   : 
; 45   : 	if (!PyTuple_GetString(poArgs, 0, &strFileName))

  00006	8d 45 f8	 lea	 eax, DWORD PTR _strFileName$[ebp]
  00009	50		 push	 eax
  0000a	6a 00		 push	 0
  0000c	ff 75 0c	 push	 DWORD PTR _poArgs$[ebp]
  0000f	e8 00 00 00 00	 call	 ?PyTuple_GetString@@YA_NPAU_object@@HPAPAD@Z ; PyTuple_GetString
  00014	83 c4 0c	 add	 esp, 12			; 0000000cH
  00017	0f b6 c0	 movzx	 eax, al
  0001a	85 c0		 test	 eax, eax
  0001c	75 0a		 jne	 SHORT $LN2@packExist

; 46   : 		return Py_BuildException();

  0001e	6a 00		 push	 0
  00020	e8 00 00 00 00	 call	 ?Py_BuildException@@YAPAU_object@@PBDZZ ; Py_BuildException
  00025	59		 pop	 ecx
  00026	eb 37		 jmp	 SHORT $LN1@packExist
$LN2@packExist:
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterBase\Singleton.h

; 27   : 		return (*ms_singleton);

  00028	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_singleton@?$CSingleton@VCEterPackManager@@@@0PAVCEterPackManager@@A ; CSingleton<CEterPackManager>::ms_singleton
  0002d	89 45 f4	 mov	 DWORD PTR $T1[ebp], eax
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\UserInterface\PythonPackModule.cpp

; 48   : 	return Py_BuildValue("i", CEterPackManager::Instance().isExist(strFileName)?1:0);

  00030	ff 75 f8	 push	 DWORD PTR _strFileName$[ebp]
  00033	8b 4d f4	 mov	 ecx, DWORD PTR $T1[ebp]
  00036	e8 00 00 00 00	 call	 ?isExist@CEterPackManager@@QAE_NPBD@Z ; CEterPackManager::isExist
  0003b	0f b6 c0	 movzx	 eax, al
  0003e	85 c0		 test	 eax, eax
  00040	74 09		 je	 SHORT $LN4@packExist
  00042	c7 45 fc 01 00
	00 00		 mov	 DWORD PTR tv79[ebp], 1
  00049	eb 04		 jmp	 SHORT $LN5@packExist
$LN4@packExist:
  0004b	83 65 fc 00	 and	 DWORD PTR tv79[ebp], 0
$LN5@packExist:
  0004f	ff 75 fc	 push	 DWORD PTR tv79[ebp]
  00052	68 00 00 00 00	 push	 OFFSET ??_C@_01KBJDNOO@i@
  00057	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__Py_BuildValue
  0005d	59		 pop	 ecx
  0005e	59		 pop	 ecx
$LN1@packExist:

; 49   : }

  0005f	c9		 leave
  00060	c3		 ret	 0
?packExist@@YAPAU_object@@PAU1@0@Z ENDP			; packExist
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\UserInterface\PythonPackModule.cpp
;	COMDAT ?GetKey_20050304Myevan@@YAPBEXZ
_TEXT	SEGMENT
_i$1 = -8						; size = 4
_seed$ = -4						; size = 4
?GetKey_20050304Myevan@@YAPBEXZ PROC			; GetKey_20050304Myevan, COMDAT

; 12   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	51		 push	 ecx

; 13   : 	volatile static DWORD s_adwKey[1938];
; 14   : 
; 15   : 	volatile DWORD seed=1491971513;

  00005	c7 45 fc b9 ad
	ed 58		 mov	 DWORD PTR _seed$[ebp], 1491971513 ; 58edadb9H

; 16   : 	for (UINT i=0; i<BYTE(seed); i++)

  0000c	83 65 f8 00	 and	 DWORD PTR _i$1[ebp], 0
  00010	eb 07		 jmp	 SHORT $LN4@GetKey_200
$LN2@GetKey_200:
  00012	8b 45 f8	 mov	 eax, DWORD PTR _i$1[ebp]
  00015	40		 inc	 eax
  00016	89 45 f8	 mov	 DWORD PTR _i$1[ebp], eax
$LN4@GetKey_200:
  00019	0f b6 45 fc	 movzx	 eax, BYTE PTR _seed$[ebp]
  0001d	39 45 f8	 cmp	 DWORD PTR _i$1[ebp], eax
  00020	73 25		 jae	 SHORT $LN3@GetKey_200

; 17   : 	{
; 18   : 		seed^=2148941891;

  00022	8b 45 fc	 mov	 eax, DWORD PTR _seed$[ebp]
  00025	35 43 40 16 80	 xor	 eax, -2146025405	; 80164043H
  0002a	89 45 fc	 mov	 DWORD PTR _seed$[ebp], eax

; 19   : 		seed+=3592385981;

  0002d	8b 45 fc	 mov	 eax, DWORD PTR _seed$[ebp]
  00030	2d 43 8a e0 29	 sub	 eax, 702581315		; 29e08a43H
  00035	89 45 fc	 mov	 DWORD PTR _seed$[ebp], eax

; 20   : 		s_adwKey[i]=seed;

  00038	8b 45 f8	 mov	 eax, DWORD PTR _i$1[ebp]
  0003b	8b 4d fc	 mov	 ecx, DWORD PTR _seed$[ebp]
  0003e	89 0c 85 00 00
	00 00		 mov	 DWORD PTR ?s_adwKey@?1??GetKey_20050304Myevan@@YAPBEXZ@4RCKC[eax*4], ecx

; 21   : 	}

  00045	eb cb		 jmp	 SHORT $LN2@GetKey_200
$LN3@GetKey_200:

; 22   : 
; 23   : 	return (const BYTE*)s_adwKey;

  00047	b8 00 00 00 00	 mov	 eax, OFFSET ?s_adwKey@?1??GetKey_20050304Myevan@@YAPBEXZ@4RCKC ; `GetKey_20050304Myevan'::`2'::s_adwKey

; 24   : }

  0004c	c9		 leave
  0004d	c3		 ret	 0
?GetKey_20050304Myevan@@YAPBEXZ ENDP			; GetKey_20050304Myevan
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\UserInterface\PythonPackModule.cpp
;	COMDAT ?__BuildClientKey_20050304Myevan@CAccountConnector@@IAEXXZ
_TEXT	SEGMENT
_this$ = -12						; size = 4
_c_pszKey$ = -8						; size = 4
_i$1 = -4						; size = 4
?__BuildClientKey_20050304Myevan@CAccountConnector@@IAEXXZ PROC ; CAccountConnector::__BuildClientKey_20050304Myevan, COMDAT
; _this$ = ecx

; 29   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH
  00006	89 4d f4	 mov	 DWORD PTR _this$[ebp], ecx

; 30   : 	const BYTE * c_pszKey = GetKey_20050304Myevan();

  00009	e8 00 00 00 00	 call	 ?GetKey_20050304Myevan@@YAPBEXZ ; GetKey_20050304Myevan
  0000e	89 45 f8	 mov	 DWORD PTR _c_pszKey$[ebp], eax

; 31   : 	memcpy(g_adwEncryptKey, c_pszKey+157, 16);

  00011	6a 10		 push	 16			; 00000010H
  00013	8b 45 f8	 mov	 eax, DWORD PTR _c_pszKey$[ebp]
  00016	05 9d 00 00 00	 add	 eax, 157		; 0000009dH
  0001b	50		 push	 eax
  0001c	68 00 00 00 00	 push	 OFFSET ?g_adwEncryptKey@@3PAKA ; g_adwEncryptKey
  00021	e8 00 00 00 00	 call	 _memcpy
  00026	83 c4 0c	 add	 esp, 12			; 0000000cH

; 32   : 
; 33   : 	for (DWORD i = 0; i < 4; ++i)

  00029	83 65 fc 00	 and	 DWORD PTR _i$1[ebp], 0
  0002d	eb 07		 jmp	 SHORT $LN4@BuildClien
$LN2@BuildClien:
  0002f	8b 45 fc	 mov	 eax, DWORD PTR _i$1[ebp]
  00032	40		 inc	 eax
  00033	89 45 fc	 mov	 DWORD PTR _i$1[ebp], eax
$LN4@BuildClien:
  00036	83 7d fc 04	 cmp	 DWORD PTR _i$1[ebp], 4
  0003a	73 11		 jae	 SHORT $LN3@BuildClien

; 34   : 		g_adwEncryptKey[i] = random();

  0003c	e8 00 00 00 00	 call	 ?random@@YAKXZ		; random
  00041	8b 4d fc	 mov	 ecx, DWORD PTR _i$1[ebp]
  00044	89 04 8d 00 00
	00 00		 mov	 DWORD PTR ?g_adwEncryptKey@@3PAKA[ecx*4], eax
  0004b	eb e2		 jmp	 SHORT $LN2@BuildClien
$LN3@BuildClien:

; 35   : 
; 36   : 	tea_encrypt((DWORD *) g_adwDecryptKey, (const DWORD *) g_adwEncryptKey, (const DWORD *) (c_pszKey+37), 16);

  0004d	6a 10		 push	 16			; 00000010H
  0004f	8b 45 f8	 mov	 eax, DWORD PTR _c_pszKey$[ebp]
  00052	83 c0 25	 add	 eax, 37			; 00000025H
  00055	50		 push	 eax
  00056	68 00 00 00 00	 push	 OFFSET ?g_adwEncryptKey@@3PAKA ; g_adwEncryptKey
  0005b	68 00 00 00 00	 push	 OFFSET ?g_adwDecryptKey@@3PAKA ; g_adwDecryptKey
  00060	e8 00 00 00 00	 call	 _tea_encrypt
  00065	83 c4 10	 add	 esp, 16			; 00000010H

; 37   : //	TEA_Encrypt((DWORD *) g_adwDecryptKey, (const DWORD *) g_adwEncryptKey, (const DWORD *) (c_pszKey+37), 16);
; 38   : }

  00068	c9		 leave
  00069	c3		 ret	 0
?__BuildClientKey_20050304Myevan@CAccountConnector@@IAEXXZ ENDP ; CAccountConnector::__BuildClientKey_20050304Myevan
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\UserInterface\PythonPackModule.cpp
;	COMDAT ?initpack@@YAXXZ
_TEXT	SEGMENT
?initpack@@YAXXZ PROC					; initpack, COMDAT

; 78   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 79   : 	static PyMethodDef s_methods[] =
; 80   : 	{
; 81   : 		{ "Exist",		packExist,		METH_VARARGS },
; 82   : 		{ "Get",		packGet,		METH_VARARGS },
; 83   : 		{ NULL, NULL },		
; 84   : 	};
; 85   : 	
; 86   : 	Py_InitModule("pack", s_methods);

  00003	68 f5 03 00 00	 push	 1013			; 000003f5H
  00008	6a 00		 push	 0
  0000a	6a 00		 push	 0
  0000c	68 00 00 00 00	 push	 OFFSET ?s_methods@?1??initpack@@YAXXZ@4PAUPyMethodDef@@A
  00011	68 00 00 00 00	 push	 OFFSET ??_C@_04IPANLPFO@pack@
  00016	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__Py_InitModule4
  0001c	83 c4 14	 add	 esp, 20			; 00000014H

; 87   : }

  0001f	5d		 pop	 ebp
  00020	c3		 ret	 0
?initpack@@YAXXZ ENDP					; initpack
_TEXT	ENDS
END

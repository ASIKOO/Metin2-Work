; Listing generated by Microsoft (R) Optimizing Compiler Version 19.28.29335.0 

	TITLE	D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorQuadtree.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?BuildQuadTree@CMapOutdoor@@IAEXXZ		; CMapOutdoor::BuildQuadTree
PUBLIC	?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z ; CMapOutdoor::AllocQuadTreeNode
PUBLIC	?SubDivideNode@CMapOutdoor@@IAEXPAVCTerrainQuadtreeNode@@@Z ; CMapOutdoor::SubDivideNode
PUBLIC	?FreeQuadTree@CMapOutdoor@@IAEXXZ		; CMapOutdoor::FreeQuadTree
PUBLIC	??_C@_0GM@MFLCABEH@MapOutdoor?3?3BuildQuadTree?5?3?5m_w@ ; `string'
PUBLIC	??_C@_0CO@IAHBGCMJ@CMapOutdoor?3?3BuildQuadTree?$CI?$CJ?5Ro@ ; `string'
EXTRN	??2@YAPAXI@Z:PROC				; operator new
EXTRN	??3@YAXPAXI@Z:PROC				; operator delete
EXTRN	?TraceError@@YAXPBDZZ:PROC			; TraceError
EXTRN	??0CTerrainQuadtreeNode@@QAE@XZ:PROC		; CTerrainQuadtreeNode::CTerrainQuadtreeNode
EXTRN	@__security_check_cookie@4:PROC
EXTRN	___CxxFrameHandler3:PROC
EXTRN	___security_cookie:DWORD
EXTRN	__fltused:DWORD
;	COMDAT ??_C@_0CO@IAHBGCMJ@CMapOutdoor?3?3BuildQuadTree?$CI?$CJ?5Ro@
CONST	SEGMENT
??_C@_0CO@IAHBGCMJ@CMapOutdoor?3?3BuildQuadTree?$CI?$CJ?5Ro@ DB 'CMapOutd'
	DB	'oor::BuildQuadTree() RootNode is NULL', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0GM@MFLCABEH@MapOutdoor?3?3BuildQuadTree?5?3?5m_w@
CONST	SEGMENT
??_C@_0GM@MFLCABEH@MapOutdoor?3?3BuildQuadTree?5?3?5m_w@ DB 'MapOutdoor::'
	DB	'BuildQuadTree : m_wPatchCount is zero, you must call ConvertP'
	DB	'atchSplat before call this method.', 00H	; `string'
CONST	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__unwindtable$?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z DD 0ffffffffH
	DD	FLAT:__unwindfunclet$?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z$0
__ehfuncinfo$?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z DD 019930522H
	DD	01H
	DD	FLAT:__unwindtable$?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
xdata$x	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorQuadtree.cpp
;	COMDAT ?FreeQuadTree@CMapOutdoor@@IAEXXZ
_TEXT	SEGMENT
tv161 = -44						; size = 4
tv151 = -40						; size = 4
tv137 = -36						; size = 4
tv91 = -32						; size = 4
tv77 = -28						; size = 4
$T1 = -24						; size = 4
$T2 = -20						; size = 4
$T3 = -16						; size = 4
$T4 = -12						; size = 4
$T5 = -8						; size = 4
_this$ = -4						; size = 4
?FreeQuadTree@CMapOutdoor@@IAEXXZ PROC			; CMapOutdoor::FreeQuadTree, COMDAT
; _this$ = ecx

; 140  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 2c	 sub	 esp, 44			; 0000002cH
  00006	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 141  : 	if (NULL == m_pRootNode)

  00009	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000c	83 b8 14 01 00
	00 00		 cmp	 DWORD PTR [eax+276], 0
  00013	75 05		 jne	 SHORT $LN2@FreeQuadTr

; 142  : 		return;

  00015	e9 49 01 00 00	 jmp	 $LN1@FreeQuadTr
$LN2@FreeQuadTr:

; 143  : 
; 144  : 	if (m_pRootNode->NW_Node)

  0001a	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0001d	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  00023	83 78 14 00	 cmp	 DWORD PTR [eax+20], 0
  00027	74 37		 je	 SHORT $LN3@FreeQuadTr

; 145  : 	{
; 146  : 		delete m_pRootNode->NW_Node;

  00029	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0002c	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  00032	8b 40 14	 mov	 eax, DWORD PTR [eax+20]
  00035	89 45 f8	 mov	 DWORD PTR $T5[ebp], eax
  00038	83 7d f8 00	 cmp	 DWORD PTR $T5[ebp], 0
  0003c	74 11		 je	 SHORT $LN8@FreeQuadTr
  0003e	6a 01		 push	 1
  00040	8b 45 f8	 mov	 eax, DWORD PTR $T5[ebp]
  00043	8b 00		 mov	 eax, DWORD PTR [eax]
  00045	8b 4d f8	 mov	 ecx, DWORD PTR $T5[ebp]
  00048	ff 10		 call	 DWORD PTR [eax]
  0004a	89 45 e4	 mov	 DWORD PTR tv77[ebp], eax
  0004d	eb 04		 jmp	 SHORT $LN9@FreeQuadTr
$LN8@FreeQuadTr:
  0004f	83 65 e4 00	 and	 DWORD PTR tv77[ebp], 0
$LN9@FreeQuadTr:

; 147  : 		m_pRootNode->NW_Node = NULL;

  00053	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00056	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  0005c	83 60 14 00	 and	 DWORD PTR [eax+20], 0
$LN3@FreeQuadTr:

; 148  : 	}
; 149  : 	if (m_pRootNode->NE_Node)

  00060	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00063	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  00069	83 78 18 00	 cmp	 DWORD PTR [eax+24], 0
  0006d	74 37		 je	 SHORT $LN4@FreeQuadTr

; 150  : 	{
; 151  : 		delete m_pRootNode->NE_Node;

  0006f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00072	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  00078	8b 40 18	 mov	 eax, DWORD PTR [eax+24]
  0007b	89 45 f4	 mov	 DWORD PTR $T4[ebp], eax
  0007e	83 7d f4 00	 cmp	 DWORD PTR $T4[ebp], 0
  00082	74 11		 je	 SHORT $LN10@FreeQuadTr
  00084	6a 01		 push	 1
  00086	8b 45 f4	 mov	 eax, DWORD PTR $T4[ebp]
  00089	8b 00		 mov	 eax, DWORD PTR [eax]
  0008b	8b 4d f4	 mov	 ecx, DWORD PTR $T4[ebp]
  0008e	ff 10		 call	 DWORD PTR [eax]
  00090	89 45 e0	 mov	 DWORD PTR tv91[ebp], eax
  00093	eb 04		 jmp	 SHORT $LN11@FreeQuadTr
$LN10@FreeQuadTr:
  00095	83 65 e0 00	 and	 DWORD PTR tv91[ebp], 0
$LN11@FreeQuadTr:

; 152  : 		m_pRootNode->NE_Node = NULL;

  00099	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0009c	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  000a2	83 60 18 00	 and	 DWORD PTR [eax+24], 0
$LN4@FreeQuadTr:

; 153  : 	}
; 154  : 	if (m_pRootNode->SW_Node)

  000a6	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000a9	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  000af	83 78 1c 00	 cmp	 DWORD PTR [eax+28], 0
  000b3	74 37		 je	 SHORT $LN5@FreeQuadTr

; 155  : 	{
; 156  : 		delete m_pRootNode->SW_Node;

  000b5	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000b8	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  000be	8b 40 1c	 mov	 eax, DWORD PTR [eax+28]
  000c1	89 45 f0	 mov	 DWORD PTR $T3[ebp], eax
  000c4	83 7d f0 00	 cmp	 DWORD PTR $T3[ebp], 0
  000c8	74 11		 je	 SHORT $LN12@FreeQuadTr
  000ca	6a 01		 push	 1
  000cc	8b 45 f0	 mov	 eax, DWORD PTR $T3[ebp]
  000cf	8b 00		 mov	 eax, DWORD PTR [eax]
  000d1	8b 4d f0	 mov	 ecx, DWORD PTR $T3[ebp]
  000d4	ff 10		 call	 DWORD PTR [eax]
  000d6	89 45 dc	 mov	 DWORD PTR tv137[ebp], eax
  000d9	eb 04		 jmp	 SHORT $LN13@FreeQuadTr
$LN12@FreeQuadTr:
  000db	83 65 dc 00	 and	 DWORD PTR tv137[ebp], 0
$LN13@FreeQuadTr:

; 157  : 		m_pRootNode->SW_Node = NULL;

  000df	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000e2	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  000e8	83 60 1c 00	 and	 DWORD PTR [eax+28], 0
$LN5@FreeQuadTr:

; 158  : 	}
; 159  : 	if (m_pRootNode->SE_Node)

  000ec	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000ef	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  000f5	83 78 20 00	 cmp	 DWORD PTR [eax+32], 0
  000f9	74 37		 je	 SHORT $LN6@FreeQuadTr

; 160  : 	{
; 161  : 		delete m_pRootNode->SE_Node;

  000fb	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000fe	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  00104	8b 40 20	 mov	 eax, DWORD PTR [eax+32]
  00107	89 45 ec	 mov	 DWORD PTR $T2[ebp], eax
  0010a	83 7d ec 00	 cmp	 DWORD PTR $T2[ebp], 0
  0010e	74 11		 je	 SHORT $LN14@FreeQuadTr
  00110	6a 01		 push	 1
  00112	8b 45 ec	 mov	 eax, DWORD PTR $T2[ebp]
  00115	8b 00		 mov	 eax, DWORD PTR [eax]
  00117	8b 4d ec	 mov	 ecx, DWORD PTR $T2[ebp]
  0011a	ff 10		 call	 DWORD PTR [eax]
  0011c	89 45 d8	 mov	 DWORD PTR tv151[ebp], eax
  0011f	eb 04		 jmp	 SHORT $LN15@FreeQuadTr
$LN14@FreeQuadTr:
  00121	83 65 d8 00	 and	 DWORD PTR tv151[ebp], 0
$LN15@FreeQuadTr:

; 162  : 		m_pRootNode->SE_Node = NULL;

  00125	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00128	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  0012e	83 60 20 00	 and	 DWORD PTR [eax+32], 0
$LN6@FreeQuadTr:

; 163  : 	}
; 164  : 
; 165  : 	delete m_pRootNode;

  00132	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00135	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  0013b	89 45 e8	 mov	 DWORD PTR $T1[ebp], eax
  0013e	83 7d e8 00	 cmp	 DWORD PTR $T1[ebp], 0
  00142	74 11		 je	 SHORT $LN16@FreeQuadTr
  00144	6a 01		 push	 1
  00146	8b 45 e8	 mov	 eax, DWORD PTR $T1[ebp]
  00149	8b 00		 mov	 eax, DWORD PTR [eax]
  0014b	8b 4d e8	 mov	 ecx, DWORD PTR $T1[ebp]
  0014e	ff 10		 call	 DWORD PTR [eax]
  00150	89 45 d4	 mov	 DWORD PTR tv161[ebp], eax
  00153	eb 04		 jmp	 SHORT $LN17@FreeQuadTr
$LN16@FreeQuadTr:
  00155	83 65 d4 00	 and	 DWORD PTR tv161[ebp], 0
$LN17@FreeQuadTr:

; 166  : 	m_pRootNode = NULL;

  00159	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0015c	83 a0 14 01 00
	00 00		 and	 DWORD PTR [eax+276], 0
$LN1@FreeQuadTr:

; 167  : }

  00163	c9		 leave
  00164	c3		 ret	 0
?FreeQuadTree@CMapOutdoor@@IAEXXZ ENDP			; CMapOutdoor::FreeQuadTree
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorQuadtree.cpp
;	COMDAT ?SubDivideNode@CMapOutdoor@@IAEXPAVCTerrainQuadtreeNode@@@Z
_TEXT	SEGMENT
_this$ = -12						; size = 4
_nw_size$ = -8						; size = 4
_tempnode$ = -4						; size = 4
_Node$ = 8						; size = 4
?SubDivideNode@CMapOutdoor@@IAEXPAVCTerrainQuadtreeNode@@@Z PROC ; CMapOutdoor::SubDivideNode, COMDAT
; _this$ = ecx

; 83   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH
  00006	89 4d f4	 mov	 DWORD PTR _this$[ebp], ecx

; 84   : 	long nw_size;
; 85   : 	CTerrainQuadtreeNode * tempnode;
; 86   : 	
; 87   : 	nw_size = Node->Size / 2;

  00009	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  0000c	8b 40 24	 mov	 eax, DWORD PTR [eax+36]
  0000f	99		 cdq
  00010	2b c2		 sub	 eax, edx
  00012	d1 f8		 sar	 eax, 1
  00014	89 45 f8	 mov	 DWORD PTR _nw_size$[ebp], eax

; 88   : 	
; 89   : 	Node->NW_Node = AllocQuadTreeNode (Node->x0, Node->y0, Node->x0 + nw_size-1, Node->y0 + nw_size-1);

  00017	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  0001a	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  0001d	8b 4d f8	 mov	 ecx, DWORD PTR _nw_size$[ebp]
  00020	8d 44 08 ff	 lea	 eax, DWORD PTR [eax+ecx-1]
  00024	50		 push	 eax
  00025	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  00028	8b 40 04	 mov	 eax, DWORD PTR [eax+4]
  0002b	8b 4d f8	 mov	 ecx, DWORD PTR _nw_size$[ebp]
  0002e	8d 44 08 ff	 lea	 eax, DWORD PTR [eax+ecx-1]
  00032	50		 push	 eax
  00033	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  00036	ff 70 08	 push	 DWORD PTR [eax+8]
  00039	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  0003c	ff 70 04	 push	 DWORD PTR [eax+4]
  0003f	8b 4d f4	 mov	 ecx, DWORD PTR _this$[ebp]
  00042	e8 00 00 00 00	 call	 ?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z ; CMapOutdoor::AllocQuadTreeNode
  00047	8b 4d 08	 mov	 ecx, DWORD PTR _Node$[ebp]
  0004a	89 41 14	 mov	 DWORD PTR [ecx+20], eax

; 90   : 	Node->NE_Node = AllocQuadTreeNode (Node->x0 + nw_size, Node->y0, Node->x1, Node->y0 + nw_size-1);

  0004d	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  00050	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  00053	8b 4d f8	 mov	 ecx, DWORD PTR _nw_size$[ebp]
  00056	8d 44 08 ff	 lea	 eax, DWORD PTR [eax+ecx-1]
  0005a	50		 push	 eax
  0005b	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  0005e	ff 70 0c	 push	 DWORD PTR [eax+12]
  00061	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  00064	ff 70 08	 push	 DWORD PTR [eax+8]
  00067	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  0006a	8b 40 04	 mov	 eax, DWORD PTR [eax+4]
  0006d	03 45 f8	 add	 eax, DWORD PTR _nw_size$[ebp]
  00070	50		 push	 eax
  00071	8b 4d f4	 mov	 ecx, DWORD PTR _this$[ebp]
  00074	e8 00 00 00 00	 call	 ?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z ; CMapOutdoor::AllocQuadTreeNode
  00079	8b 4d 08	 mov	 ecx, DWORD PTR _Node$[ebp]
  0007c	89 41 18	 mov	 DWORD PTR [ecx+24], eax

; 91   : 	Node->SW_Node = AllocQuadTreeNode (Node->x0, Node->y0 + nw_size, Node->x0 + nw_size-1, Node->y1);

  0007f	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  00082	ff 70 10	 push	 DWORD PTR [eax+16]
  00085	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  00088	8b 40 04	 mov	 eax, DWORD PTR [eax+4]
  0008b	8b 4d f8	 mov	 ecx, DWORD PTR _nw_size$[ebp]
  0008e	8d 44 08 ff	 lea	 eax, DWORD PTR [eax+ecx-1]
  00092	50		 push	 eax
  00093	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  00096	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  00099	03 45 f8	 add	 eax, DWORD PTR _nw_size$[ebp]
  0009c	50		 push	 eax
  0009d	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  000a0	ff 70 04	 push	 DWORD PTR [eax+4]
  000a3	8b 4d f4	 mov	 ecx, DWORD PTR _this$[ebp]
  000a6	e8 00 00 00 00	 call	 ?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z ; CMapOutdoor::AllocQuadTreeNode
  000ab	8b 4d 08	 mov	 ecx, DWORD PTR _Node$[ebp]
  000ae	89 41 1c	 mov	 DWORD PTR [ecx+28], eax

; 92   : 	Node->SE_Node = AllocQuadTreeNode (Node->x0 + nw_size, Node->y0 + nw_size, Node->x1, Node->y1);

  000b1	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  000b4	ff 70 10	 push	 DWORD PTR [eax+16]
  000b7	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  000ba	ff 70 0c	 push	 DWORD PTR [eax+12]
  000bd	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  000c0	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  000c3	03 45 f8	 add	 eax, DWORD PTR _nw_size$[ebp]
  000c6	50		 push	 eax
  000c7	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  000ca	8b 40 04	 mov	 eax, DWORD PTR [eax+4]
  000cd	03 45 f8	 add	 eax, DWORD PTR _nw_size$[ebp]
  000d0	50		 push	 eax
  000d1	8b 4d f4	 mov	 ecx, DWORD PTR _this$[ebp]
  000d4	e8 00 00 00 00	 call	 ?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z ; CMapOutdoor::AllocQuadTreeNode
  000d9	8b 4d 08	 mov	 ecx, DWORD PTR _Node$[ebp]
  000dc	89 41 20	 mov	 DWORD PTR [ecx+32], eax

; 93   : 	
; 94   : 	tempnode = (CTerrainQuadtreeNode *) Node->NW_Node;

  000df	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  000e2	8b 40 14	 mov	 eax, DWORD PTR [eax+20]
  000e5	89 45 fc	 mov	 DWORD PTR _tempnode$[ebp], eax

; 95   : 	if ((tempnode != NULL) && (tempnode->Size > 1))

  000e8	83 7d fc 00	 cmp	 DWORD PTR _tempnode$[ebp], 0
  000ec	74 14		 je	 SHORT $LN2@SubDivideN
  000ee	8b 45 fc	 mov	 eax, DWORD PTR _tempnode$[ebp]
  000f1	83 78 24 01	 cmp	 DWORD PTR [eax+36], 1
  000f5	7e 0b		 jle	 SHORT $LN2@SubDivideN

; 96   : 		SubDivideNode (tempnode);

  000f7	ff 75 fc	 push	 DWORD PTR _tempnode$[ebp]
  000fa	8b 4d f4	 mov	 ecx, DWORD PTR _this$[ebp]
  000fd	e8 00 00 00 00	 call	 ?SubDivideNode@CMapOutdoor@@IAEXPAVCTerrainQuadtreeNode@@@Z ; CMapOutdoor::SubDivideNode
$LN2@SubDivideN:

; 97   : 	tempnode = (CTerrainQuadtreeNode *) Node->NE_Node;

  00102	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  00105	8b 40 18	 mov	 eax, DWORD PTR [eax+24]
  00108	89 45 fc	 mov	 DWORD PTR _tempnode$[ebp], eax

; 98   : 	if ((tempnode != NULL) && (tempnode->Size > 1))

  0010b	83 7d fc 00	 cmp	 DWORD PTR _tempnode$[ebp], 0
  0010f	74 14		 je	 SHORT $LN3@SubDivideN
  00111	8b 45 fc	 mov	 eax, DWORD PTR _tempnode$[ebp]
  00114	83 78 24 01	 cmp	 DWORD PTR [eax+36], 1
  00118	7e 0b		 jle	 SHORT $LN3@SubDivideN

; 99   : 		SubDivideNode (tempnode);

  0011a	ff 75 fc	 push	 DWORD PTR _tempnode$[ebp]
  0011d	8b 4d f4	 mov	 ecx, DWORD PTR _this$[ebp]
  00120	e8 00 00 00 00	 call	 ?SubDivideNode@CMapOutdoor@@IAEXPAVCTerrainQuadtreeNode@@@Z ; CMapOutdoor::SubDivideNode
$LN3@SubDivideN:

; 100  : 	tempnode = (CTerrainQuadtreeNode *) Node->SW_Node;

  00125	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  00128	8b 40 1c	 mov	 eax, DWORD PTR [eax+28]
  0012b	89 45 fc	 mov	 DWORD PTR _tempnode$[ebp], eax

; 101  : 	if ((tempnode != NULL) && (tempnode->Size > 1))

  0012e	83 7d fc 00	 cmp	 DWORD PTR _tempnode$[ebp], 0
  00132	74 14		 je	 SHORT $LN4@SubDivideN
  00134	8b 45 fc	 mov	 eax, DWORD PTR _tempnode$[ebp]
  00137	83 78 24 01	 cmp	 DWORD PTR [eax+36], 1
  0013b	7e 0b		 jle	 SHORT $LN4@SubDivideN

; 102  : 		SubDivideNode (tempnode);

  0013d	ff 75 fc	 push	 DWORD PTR _tempnode$[ebp]
  00140	8b 4d f4	 mov	 ecx, DWORD PTR _this$[ebp]
  00143	e8 00 00 00 00	 call	 ?SubDivideNode@CMapOutdoor@@IAEXPAVCTerrainQuadtreeNode@@@Z ; CMapOutdoor::SubDivideNode
$LN4@SubDivideN:

; 103  : 	tempnode = (CTerrainQuadtreeNode *) Node->SE_Node;

  00148	8b 45 08	 mov	 eax, DWORD PTR _Node$[ebp]
  0014b	8b 40 20	 mov	 eax, DWORD PTR [eax+32]
  0014e	89 45 fc	 mov	 DWORD PTR _tempnode$[ebp], eax

; 104  : 	if ((tempnode != NULL) && (tempnode->Size > 1))

  00151	83 7d fc 00	 cmp	 DWORD PTR _tempnode$[ebp], 0
  00155	74 14		 je	 SHORT $LN1@SubDivideN
  00157	8b 45 fc	 mov	 eax, DWORD PTR _tempnode$[ebp]
  0015a	83 78 24 01	 cmp	 DWORD PTR [eax+36], 1
  0015e	7e 0b		 jle	 SHORT $LN1@SubDivideN

; 105  : 		SubDivideNode (tempnode);

  00160	ff 75 fc	 push	 DWORD PTR _tempnode$[ebp]
  00163	8b 4d f4	 mov	 ecx, DWORD PTR _this$[ebp]
  00166	e8 00 00 00 00	 call	 ?SubDivideNode@CMapOutdoor@@IAEXPAVCTerrainQuadtreeNode@@@Z ; CMapOutdoor::SubDivideNode
$LN1@SubDivideN:

; 106  : }

  0016b	c9		 leave
  0016c	c2 04 00	 ret	 4
?SubDivideNode@CMapOutdoor@@IAEXPAVCTerrainQuadtreeNode@@@Z ENDP ; CMapOutdoor::SubDivideNode
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorQuadtree.cpp
;	COMDAT ?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z
_TEXT	SEGMENT
_this$ = -40						; size = 4
$T2 = -36						; size = 4
tv81 = -32						; size = 4
$T3 = -28						; size = 4
_xsize$ = -24						; size = 4
_ysize$ = -20						; size = 4
_Node$ = -16						; size = 4
__$EHRec$ = -12						; size = 12
_x0$ = 8						; size = 4
_y0$ = 12						; size = 4
_x1$ = 16						; size = 4
_y1$ = 20						; size = 4
?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z PROC ; CMapOutdoor::AllocQuadTreeNode, COMDAT
; _this$ = ecx

; 28   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	6a ff		 push	 -1
  00005	68 00 00 00 00	 push	 __ehhandler$?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z
  0000a	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  00010	50		 push	 eax
  00011	83 ec 1c	 sub	 esp, 28			; 0000001cH
  00014	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00019	33 c5		 xor	 eax, ebp
  0001b	50		 push	 eax
  0001c	8d 45 f4	 lea	 eax, DWORD PTR __$EHRec$[ebp]
  0001f	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00025	89 4d d8	 mov	 DWORD PTR _this$[ebp], ecx

; 29   : 	CTerrainQuadtreeNode * Node;
; 30   : 	long xsize, ysize;
; 31   : 	
; 32   : 	xsize = x1-x0+1;

  00028	8b 45 10	 mov	 eax, DWORD PTR _x1$[ebp]
  0002b	2b 45 08	 sub	 eax, DWORD PTR _x0$[ebp]
  0002e	40		 inc	 eax
  0002f	89 45 e8	 mov	 DWORD PTR _xsize$[ebp], eax

; 33   : 	ysize = y1-y0+1;

  00032	8b 45 14	 mov	 eax, DWORD PTR _y1$[ebp]
  00035	2b 45 0c	 sub	 eax, DWORD PTR _y0$[ebp]
  00038	40		 inc	 eax
  00039	89 45 ec	 mov	 DWORD PTR _ysize$[ebp], eax

; 34   : 	if ((xsize == 0) || (ysize == 0))

  0003c	83 7d e8 00	 cmp	 DWORD PTR _xsize$[ebp], 0
  00040	74 06		 je	 SHORT $LN3@AllocQuadT
  00042	83 7d ec 00	 cmp	 DWORD PTR _ysize$[ebp], 0
  00046	75 07		 jne	 SHORT $LN2@AllocQuadT
$LN3@AllocQuadT:

; 35   : 		return NULL;  

  00048	33 c0		 xor	 eax, eax
  0004a	e9 bc 00 00 00	 jmp	 $LN1@AllocQuadT
$LN2@AllocQuadT:

; 36   : 	
; 37   : 	Node = new CTerrainQuadtreeNode;

  0004f	6a 40		 push	 64			; 00000040H
  00051	e8 00 00 00 00	 call	 ??2@YAPAXI@Z		; operator new
  00056	59		 pop	 ecx
  00057	89 45 e4	 mov	 DWORD PTR $T3[ebp], eax
  0005a	83 65 fc 00	 and	 DWORD PTR __$EHRec$[ebp+8], 0
  0005e	83 7d e4 00	 cmp	 DWORD PTR $T3[ebp], 0
  00062	74 0d		 je	 SHORT $LN7@AllocQuadT
  00064	8b 4d e4	 mov	 ecx, DWORD PTR $T3[ebp]
  00067	e8 00 00 00 00	 call	 ??0CTerrainQuadtreeNode@@QAE@XZ ; CTerrainQuadtreeNode::CTerrainQuadtreeNode
  0006c	89 45 e0	 mov	 DWORD PTR tv81[ebp], eax
  0006f	eb 04		 jmp	 SHORT $LN8@AllocQuadT
$LN7@AllocQuadT:
  00071	83 65 e0 00	 and	 DWORD PTR tv81[ebp], 0
$LN8@AllocQuadT:
  00075	8b 45 e0	 mov	 eax, DWORD PTR tv81[ebp]
  00078	89 45 dc	 mov	 DWORD PTR $T2[ebp], eax
  0007b	83 4d fc ff	 or	 DWORD PTR __$EHRec$[ebp+8], -1
  0007f	8b 45 dc	 mov	 eax, DWORD PTR $T2[ebp]
  00082	89 45 f0	 mov	 DWORD PTR _Node$[ebp], eax

; 38   : 	Node->x0 = x0;

  00085	8b 45 f0	 mov	 eax, DWORD PTR _Node$[ebp]
  00088	8b 4d 08	 mov	 ecx, DWORD PTR _x0$[ebp]
  0008b	89 48 04	 mov	 DWORD PTR [eax+4], ecx

; 39   : 	Node->y0 = y0;

  0008e	8b 45 f0	 mov	 eax, DWORD PTR _Node$[ebp]
  00091	8b 4d 0c	 mov	 ecx, DWORD PTR _y0$[ebp]
  00094	89 48 08	 mov	 DWORD PTR [eax+8], ecx

; 40   : 	Node->x1 = x1;

  00097	8b 45 f0	 mov	 eax, DWORD PTR _Node$[ebp]
  0009a	8b 4d 10	 mov	 ecx, DWORD PTR _x1$[ebp]
  0009d	89 48 0c	 mov	 DWORD PTR [eax+12], ecx

; 41   : 	Node->y1 = y1;

  000a0	8b 45 f0	 mov	 eax, DWORD PTR _Node$[ebp]
  000a3	8b 4d 14	 mov	 ecx, DWORD PTR _y1$[ebp]
  000a6	89 48 10	 mov	 DWORD PTR [eax+16], ecx

; 42   : 	
; 43   : 	if (ysize > xsize)

  000a9	8b 45 ec	 mov	 eax, DWORD PTR _ysize$[ebp]
  000ac	3b 45 e8	 cmp	 eax, DWORD PTR _xsize$[ebp]
  000af	7e 0b		 jle	 SHORT $LN4@AllocQuadT

; 44   : 		Node->Size = ysize;

  000b1	8b 45 f0	 mov	 eax, DWORD PTR _Node$[ebp]
  000b4	8b 4d ec	 mov	 ecx, DWORD PTR _ysize$[ebp]
  000b7	89 48 24	 mov	 DWORD PTR [eax+36], ecx
  000ba	eb 09		 jmp	 SHORT $LN5@AllocQuadT
$LN4@AllocQuadT:

; 45   : 	else
; 46   : 		Node->Size = xsize;

  000bc	8b 45 f0	 mov	 eax, DWORD PTR _Node$[ebp]
  000bf	8b 4d e8	 mov	 ecx, DWORD PTR _xsize$[ebp]
  000c2	89 48 24	 mov	 DWORD PTR [eax+36], ecx
$LN5@AllocQuadT:

; 47   : 	
; 48   : 	Node->PatchNum = y0 * m_wPatchCount + x0;

  000c5	8b 45 d8	 mov	 eax, DWORD PTR _this$[ebp]
  000c8	0f b7 80 8c 00
	00 00		 movzx	 eax, WORD PTR [eax+140]
  000cf	0f af 45 0c	 imul	 eax, DWORD PTR _y0$[ebp]
  000d3	03 45 08	 add	 eax, DWORD PTR _x0$[ebp]
  000d6	8b 4d f0	 mov	 ecx, DWORD PTR _Node$[ebp]
  000d9	89 41 28	 mov	 DWORD PTR [ecx+40], eax

; 49   : 
; 50   : /*
; 51   : 	const float fTerrainMin = -(float) (m_lViewRadius * m_lCellScale);
; 52   : 	
; 53   : 	minx = fTerrainMin + x0 * c_byPatchSize * m_lCellScale;
; 54   : 	maxx = fTerrainMin + (x1 + 1) * c_byPatchSize * m_lCellScale;
; 55   : 	miny = fTerrainMin + y0 * c_byPatchSize * m_lCellScale;
; 56   : 	maxy = fTerrainMin + (y1 + 1) * c_byPatchSize * m_lCellScale;
; 57   : 	minz = 0.0f;
; 58   : 	maxz = 0.0f;
; 59   : 
; 60   : 	/ * Set up 8 vertices that belong to the bounding box * /
; 61   : 	Node->center.x = minx + (maxx - minx) * 0.5f;
; 62   : 	Node->center.y = miny + (maxy - miny) * 0.5f;
; 63   : 	Node->center.z = minz + (maxz - minz) * 0.5f;
; 64   : 
; 65   : 	Node->radius = sqrtf(
; 66   : 		(maxx-minx)*(maxx-minx)+
; 67   : 		(maxy-miny)*(maxy-miny)+
; 68   : 		(maxz-minz)*(maxz-minz)
; 69   : 		)/2.0f;
; 70   : */
; 71   : 
; 72   : 	Node->center.x = 0.0f;

  000dc	8b 45 f0	 mov	 eax, DWORD PTR _Node$[ebp]
  000df	0f 57 c0	 xorps	 xmm0, xmm0
  000e2	f3 0f 11 40 2c	 movss	 DWORD PTR [eax+44], xmm0

; 73   : 	Node->center.y = 0.0f;

  000e7	8b 45 f0	 mov	 eax, DWORD PTR _Node$[ebp]
  000ea	0f 57 c0	 xorps	 xmm0, xmm0
  000ed	f3 0f 11 40 30	 movss	 DWORD PTR [eax+48], xmm0

; 74   : 	Node->center.z = 0.0f;

  000f2	8b 45 f0	 mov	 eax, DWORD PTR _Node$[ebp]
  000f5	0f 57 c0	 xorps	 xmm0, xmm0
  000f8	f3 0f 11 40 34	 movss	 DWORD PTR [eax+52], xmm0

; 75   : 	
; 76   : 	Node->radius = 0.0f;

  000fd	8b 45 f0	 mov	 eax, DWORD PTR _Node$[ebp]
  00100	0f 57 c0	 xorps	 xmm0, xmm0
  00103	f3 0f 11 40 38	 movss	 DWORD PTR [eax+56], xmm0

; 77   : 
; 78   : 	return Node;

  00108	8b 45 f0	 mov	 eax, DWORD PTR _Node$[ebp]
$LN1@AllocQuadT:

; 79   : }

  0010b	8b 4d f4	 mov	 ecx, DWORD PTR __$EHRec$[ebp]
  0010e	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00115	59		 pop	 ecx
  00116	c9		 leave
  00117	c2 10 00	 ret	 16			; 00000010H
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__unwindfunclet$?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z$0:
  00000	6a 40		 push	 64			; 00000040H
  00002	ff 75 e4	 push	 DWORD PTR $T3[ebp]
  00005	e8 00 00 00 00	 call	 ??3@YAXPAXI@Z		; operator delete
  0000a	59		 pop	 ecx
  0000b	59		 pop	 ecx
  0000c	c3		 ret	 0
  0000d	cc		 int	 3
  0000e	cc		 int	 3
  0000f	cc		 int	 3
  00010	cc		 int	 3
  00011	cc		 int	 3
__ehhandler$?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z:
  00012	90		 npad	 1
  00013	90		 npad	 1
  00014	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  00018	8d 42 0c	 lea	 eax, DWORD PTR [edx+12]
  0001b	8b 4a e0	 mov	 ecx, DWORD PTR [edx-32]
  0001e	33 c8		 xor	 ecx, eax
  00020	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00025	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z
  0002a	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z ENDP ; CMapOutdoor::AllocQuadTreeNode
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorQuadtree.cpp
;	COMDAT ?BuildQuadTree@CMapOutdoor@@IAEXXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?BuildQuadTree@CMapOutdoor@@IAEXXZ PROC			; CMapOutdoor::BuildQuadTree, COMDAT
; _this$ = ecx

; 9    : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 10   : 	FreeQuadTree();

  00007	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0000a	e8 00 00 00 00	 call	 ?FreeQuadTree@CMapOutdoor@@IAEXXZ ; CMapOutdoor::FreeQuadTree

; 11   : 
; 12   : 	// m_wPatchCount는 ConvertPatchSplat에서도 정한다, 안전을 위해 여기서 체크한다.
; 13   : 	if (0 == m_wPatchCount)

  0000f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00012	0f b7 80 8c 00
	00 00		 movzx	 eax, WORD PTR [eax+140]
  00019	85 c0		 test	 eax, eax
  0001b	75 0d		 jne	 SHORT $LN2@BuildQuadT

; 14   : 	{
; 15   : 		TraceError("MapOutdoor::BuildQuadTree : m_wPatchCount is zero, you must call ConvertPatchSplat before call this method.");

  0001d	68 00 00 00 00	 push	 OFFSET ??_C@_0GM@MFLCABEH@MapOutdoor?3?3BuildQuadTree?5?3?5m_w@
  00022	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  00027	59		 pop	 ecx

; 16   : 		return;

  00028	eb 64		 jmp	 SHORT $LN1@BuildQuadT
$LN2@BuildQuadT:

; 17   : 	}
; 18   : 
; 19   : 	m_pRootNode = AllocQuadTreeNode(0, 0, m_wPatchCount - 1, m_wPatchCount - 1);

  0002a	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0002d	0f b7 80 8c 00
	00 00		 movzx	 eax, WORD PTR [eax+140]
  00034	48		 dec	 eax
  00035	50		 push	 eax
  00036	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00039	0f b7 80 8c 00
	00 00		 movzx	 eax, WORD PTR [eax+140]
  00040	48		 dec	 eax
  00041	50		 push	 eax
  00042	6a 00		 push	 0
  00044	6a 00		 push	 0
  00046	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00049	e8 00 00 00 00	 call	 ?AllocQuadTreeNode@CMapOutdoor@@IAEPAVCTerrainQuadtreeNode@@JJJJ@Z ; CMapOutdoor::AllocQuadTreeNode
  0004e	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00051	89 81 14 01 00
	00		 mov	 DWORD PTR [ecx+276], eax

; 20   : 	if (!m_pRootNode)

  00057	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0005a	83 b8 14 01 00
	00 00		 cmp	 DWORD PTR [eax+276], 0
  00061	75 0b		 jne	 SHORT $LN3@BuildQuadT

; 21   : 		TraceError("CMapOutdoor::BuildQuadTree() RootNode is NULL");

  00063	68 00 00 00 00	 push	 OFFSET ??_C@_0CO@IAHBGCMJ@CMapOutdoor?3?3BuildQuadTree?$CI?$CJ?5Ro@
  00068	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  0006d	59		 pop	 ecx
$LN3@BuildQuadT:

; 22   : 
; 23   : 	if (m_pRootNode->Size > 1)

  0006e	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00071	8b 80 14 01 00
	00		 mov	 eax, DWORD PTR [eax+276]
  00077	83 78 24 01	 cmp	 DWORD PTR [eax+36], 1
  0007b	7e 11		 jle	 SHORT $LN1@BuildQuadT

; 24   : 		SubDivideNode(m_pRootNode);

  0007d	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00080	ff b0 14 01 00
	00		 push	 DWORD PTR [eax+276]
  00086	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00089	e8 00 00 00 00	 call	 ?SubDivideNode@CMapOutdoor@@IAEXPAVCTerrainQuadtreeNode@@@Z ; CMapOutdoor::SubDivideNode
$LN1@BuildQuadT:

; 25   : }

  0008e	c9		 leave
  0008f	c3		 ret	 0
?BuildQuadTree@CMapOutdoor@@IAEXXZ ENDP			; CMapOutdoor::BuildQuadTree
_TEXT	ENDS
END

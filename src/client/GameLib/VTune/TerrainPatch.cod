; Listing generated by Microsoft (R) Optimizing Compiler Version 19.28.29335.0 

	TITLE	D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?SOFTWARE_TRANSFORM_PATCH_ENABLE@CTerrainPatch@@2_NA ; CTerrainPatch::SOFTWARE_TRANSFORM_PATCH_ENABLE
_DATA	SEGMENT
?SOFTWARE_TRANSFORM_PATCH_ENABLE@CTerrainPatch@@2_NA DB 01H ; CTerrainPatch::SOFTWARE_TRANSFORM_PATCH_ENABLE
_DATA	ENDS
PUBLIC	??_H@YGXPAXIIP6EPAX0@Z@Z			; `vector constructor iterator'
PUBLIC	?Clear@CTerrainPatch@@QAEXXZ			; CTerrainPatch::Clear
PUBLIC	?GetWaterFaceCount@CTerrainPatch@@QAEIXZ	; CTerrainPatch::GetWaterFaceCount
PUBLIC	?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatch@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z ; CTerrainPatch::SoftwareTransformPatch_UpdateTerrainLighting
PUBLIC	?BuildTerrainVertexBuffer@CTerrainPatch@@QAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ; CTerrainPatch::BuildTerrainVertexBuffer
PUBLIC	?BuildWaterVertexBuffer@CTerrainPatch@@QAEXPAUSWaterVertex@@I@Z ; CTerrainPatch::BuildWaterVertexBuffer
PUBLIC	?__BuildHardwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ; CTerrainPatch::__BuildHardwareTerrainVertexBuffer
PUBLIC	?__BuildSoftwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ; CTerrainPatch::__BuildSoftwareTerrainVertexBuffer
PUBLIC	??0SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ ; CTerrainPatch::SSoftwareTransformPatch::SSoftwareTransformPatch
PUBLIC	??1SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ ; CTerrainPatch::SSoftwareTransformPatch::~SSoftwareTransformPatch
PUBLIC	?Create@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::Create
PUBLIC	?Destroy@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::Destroy
PUBLIC	?__Initialize@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::__Initialize
PUBLIC	??0CTerrainPatchProxy@@QAE@XZ			; CTerrainPatchProxy::CTerrainPatchProxy
PUBLIC	??1CTerrainPatchProxy@@UAE@XZ			; CTerrainPatchProxy::~CTerrainPatchProxy
PUBLIC	?Clear@CTerrainPatchProxy@@QAEXXZ		; CTerrainPatchProxy::Clear
PUBLIC	?SetCenterPosition@CTerrainPatchProxy@@QAEXABUD3DXVECTOR3@@@Z ; CTerrainPatchProxy::SetCenterPosition
PUBLIC	?IsIn@CTerrainPatchProxy@@QAE_NABUD3DXVECTOR3@@M@Z ; CTerrainPatchProxy::IsIn
PUBLIC	?GetWaterFaceCount@CTerrainPatchProxy@@QAEIXZ	; CTerrainPatchProxy::GetWaterFaceCount
PUBLIC	?SoftwareTransformPatch_GetTerrainVertexDataPtr@CTerrainPatchProxy@@QAEPAUSoftwareTransformPatch_SSourceVertex@@XZ ; CTerrainPatchProxy::SoftwareTransformPatch_GetTerrainVertexDataPtr
PUBLIC	?HardwareTransformPatch_GetVertexBufferPtr@CTerrainPatchProxy@@QAEPAVCGraphicVertexBuffer@@XZ ; CTerrainPatchProxy::HardwareTransformPatch_GetVertexBufferPtr
PUBLIC	?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatchProxy@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z ; CTerrainPatchProxy::SoftwareTransformPatch_UpdateTerrainLighting
PUBLIC	??_GCTerrainPatchProxy@@UAEPAXI@Z		; CTerrainPatchProxy::`scalar deleting destructor'
PUBLIC	??_7CTerrainPatchProxy@@6B@			; CTerrainPatchProxy::`vftable'
PUBLIC	??_R4CTerrainPatchProxy@@6B@			; CTerrainPatchProxy::`RTTI Complete Object Locator'
PUBLIC	??_R0?AVCTerrainPatchProxy@@@8			; CTerrainPatchProxy `RTTI Type Descriptor'
PUBLIC	??_R3CTerrainPatchProxy@@8			; CTerrainPatchProxy::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2CTerrainPatchProxy@@8			; CTerrainPatchProxy::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@CTerrainPatchProxy@@8		; CTerrainPatchProxy::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	__real@437f0000
PUBLIC	__real@4b7fffff
PUBLIC	__xmm@80000000800000008000000080000000
EXTRN	??3@YAXPAXI@Z:PROC				; operator delete
EXTRN	??_U@YAPAXI@Z:PROC				; operator new[]
EXTRN	??_V@YAXPAX@Z:PROC				; operator delete[]
EXTRN	_memcpy:PROC
EXTRN	?Destroy@CGraphicVertexBuffer@@QAEXXZ:PROC	; CGraphicVertexBuffer::Destroy
EXTRN	?Unlock@CGraphicVertexBuffer@@QAE_NXZ:PROC	; CGraphicVertexBuffer::Unlock
EXTRN	??_ECTerrainPatchProxy@@UAEPAXI@Z:PROC		; CTerrainPatchProxy::`vector deleting destructor'
EXTRN	@__security_check_cookie@4:PROC
EXTRN	___CxxFrameHandler3:PROC
EXTRN	__ftoui3:PROC
EXTRN	??_7type_info@@6B@:QWORD			; type_info::`vftable'
EXTRN	___security_cookie:DWORD
EXTRN	__fltused:DWORD
;	COMDAT __xmm@80000000800000008000000080000000
CONST	SEGMENT
__xmm@80000000800000008000000080000000 DB 00H, 00H, 00H, 080H, 00H, 00H, 00H
	DB	080H, 00H, 00H, 00H, 080H, 00H, 00H, 00H, 080H
CONST	ENDS
;	COMDAT __real@4b7fffff
CONST	SEGMENT
__real@4b7fffff DD 04b7fffffr			; 1.67772e+07
CONST	ENDS
;	COMDAT __real@437f0000
CONST	SEGMENT
__real@437f0000 DD 0437f0000r			; 255
CONST	ENDS
;	COMDAT ??_R1A@?0A@EA@CTerrainPatchProxy@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@CTerrainPatchProxy@@8 DD FLAT:??_R0?AVCTerrainPatchProxy@@@8 ; CTerrainPatchProxy::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	00H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3CTerrainPatchProxy@@8
rdata$r	ENDS
;	COMDAT ??_R2CTerrainPatchProxy@@8
rdata$r	SEGMENT
??_R2CTerrainPatchProxy@@8 DD FLAT:??_R1A@?0A@EA@CTerrainPatchProxy@@8 ; CTerrainPatchProxy::`RTTI Base Class Array'
rdata$r	ENDS
;	COMDAT ??_R3CTerrainPatchProxy@@8
rdata$r	SEGMENT
??_R3CTerrainPatchProxy@@8 DD 00H			; CTerrainPatchProxy::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	01H
	DD	FLAT:??_R2CTerrainPatchProxy@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVCTerrainPatchProxy@@@8
data$rs	SEGMENT
??_R0?AVCTerrainPatchProxy@@@8 DD FLAT:??_7type_info@@6B@ ; CTerrainPatchProxy `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVCTerrainPatchProxy@@', 00H
data$rs	ENDS
;	COMDAT ??_R4CTerrainPatchProxy@@6B@
rdata$r	SEGMENT
??_R4CTerrainPatchProxy@@6B@ DD 00H			; CTerrainPatchProxy::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVCTerrainPatchProxy@@@8
	DD	FLAT:??_R3CTerrainPatchProxy@@8
rdata$r	ENDS
;	COMDAT ??_7CTerrainPatchProxy@@6B@
CONST	SEGMENT
??_7CTerrainPatchProxy@@6B@ DD FLAT:??_R4CTerrainPatchProxy@@6B@ ; CTerrainPatchProxy::`vftable'
	DD	FLAT:??_ECTerrainPatchProxy@@UAEPAXI@Z
CONST	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__ehfuncinfo$??1CTerrainPatchProxy@@UAE@XZ DD 019930522H
	DD	00H
	DD	00H
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	05H
xdata$x	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__ehfuncinfo$??1SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ DD 019930522H
	DD	00H
	DD	00H
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	05H
xdata$x	ENDS
; Function compile flags: /Odspy
;	COMDAT ??_GCTerrainPatchProxy@@UAEPAXI@Z
_TEXT	SEGMENT
_this$ = -4						; size = 4
___flags$ = 8						; size = 4
??_GCTerrainPatchProxy@@UAEPAXI@Z PROC			; CTerrainPatchProxy::`scalar deleting destructor', COMDAT
; _this$ = ecx
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx
  00007	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0000a	e8 00 00 00 00	 call	 ??1CTerrainPatchProxy@@UAE@XZ ; CTerrainPatchProxy::~CTerrainPatchProxy
  0000f	8b 45 08	 mov	 eax, DWORD PTR ___flags$[ebp]
  00012	83 e0 01	 and	 eax, 1
  00015	74 0c		 je	 SHORT $LN2@scalar
  00017	6a 1c		 push	 28			; 0000001cH
  00019	ff 75 fc	 push	 DWORD PTR _this$[ebp]
  0001c	e8 00 00 00 00	 call	 ??3@YAXPAXI@Z		; operator delete
  00021	59		 pop	 ecx
  00022	59		 pop	 ecx
$LN2@scalar:
  00023	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00026	c9		 leave
  00027	c2 04 00	 ret	 4
??_GCTerrainPatchProxy@@UAEPAXI@Z ENDP			; CTerrainPatchProxy::`scalar deleting destructor'
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatchProxy@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z
_TEXT	SEGMENT
_this$ = -4						; size = 4
_dwVersion$ = 8						; size = 4
_c_rkLight$ = 12					; size = 4
_c_rkMtrl$ = 16						; size = 4
?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatchProxy@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z PROC ; CTerrainPatchProxy::SoftwareTransformPatch_UpdateTerrainLighting, COMDAT
; _this$ = ecx

; 204  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 205  : 	if (m_pTerrainPatch)

  00007	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000a	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  0000e	74 14		 je	 SHORT $LN1@SoftwareTr

; 206  : 		m_pTerrainPatch->SoftwareTransformPatch_UpdateTerrainLighting(dwVersion, c_rkLight, c_rkMtrl);	

  00010	ff 75 10	 push	 DWORD PTR _c_rkMtrl$[ebp]
  00013	ff 75 0c	 push	 DWORD PTR _c_rkLight$[ebp]
  00016	ff 75 08	 push	 DWORD PTR _dwVersion$[ebp]
  00019	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0001c	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  0001f	e8 00 00 00 00	 call	 ?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatch@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z ; CTerrainPatch::SoftwareTransformPatch_UpdateTerrainLighting
$LN1@SoftwareTr:

; 207  : }

  00024	c9		 leave
  00025	c2 0c 00	 ret	 12			; 0000000cH
?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatchProxy@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z ENDP ; CTerrainPatchProxy::SoftwareTransformPatch_UpdateTerrainLighting
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.h
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?HardwareTransformPatch_GetVertexBufferPtr@CTerrainPatchProxy@@QAEPAVCGraphicVertexBuffer@@XZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?HardwareTransformPatch_GetVertexBufferPtr@CTerrainPatchProxy@@QAEPAVCGraphicVertexBuffer@@XZ PROC ; CTerrainPatchProxy::HardwareTransformPatch_GetVertexBufferPtr, COMDAT
; _this$ = ecx

; 210  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 211  : 	if (m_pTerrainPatch)

  00007	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000a	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  0000e	74 0b		 je	 SHORT $LN2@HardwareTr
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.h

; 129  : 	CGraphicVertexBuffer* HardwareTransformPatch_GetVertexBufferPtr() {return &m_kHT.m_kVB;}

  00010	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00013	8b 40 0c	 mov	 eax, DWORD PTR [eax+12]
  00016	83 c0 4c	 add	 eax, 76			; 0000004cH
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp

; 212  : 		return m_pTerrainPatch->HardwareTransformPatch_GetVertexBufferPtr();

  00019	eb 02		 jmp	 SHORT $LN1@HardwareTr
$LN2@HardwareTr:

; 213  : 
; 214  : 	return NULL;

  0001b	33 c0		 xor	 eax, eax
$LN1@HardwareTr:

; 215  : }

  0001d	c9		 leave
  0001e	c3		 ret	 0
?HardwareTransformPatch_GetVertexBufferPtr@CTerrainPatchProxy@@QAEPAVCGraphicVertexBuffer@@XZ ENDP ; CTerrainPatchProxy::HardwareTransformPatch_GetVertexBufferPtr
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.h
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?SoftwareTransformPatch_GetTerrainVertexDataPtr@CTerrainPatchProxy@@QAEPAUSoftwareTransformPatch_SSourceVertex@@XZ
_TEXT	SEGMENT
$T1 = -8						; size = 4
_this$ = -4						; size = 4
?SoftwareTransformPatch_GetTerrainVertexDataPtr@CTerrainPatchProxy@@QAEPAUSoftwareTransformPatch_SSourceVertex@@XZ PROC ; CTerrainPatchProxy::SoftwareTransformPatch_GetTerrainVertexDataPtr, COMDAT
; _this$ = ecx

; 218  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	51		 push	 ecx
  00005	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 219  : 	if (m_pTerrainPatch)

  00008	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000b	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  0000f	74 11		 je	 SHORT $LN2@SoftwareTr
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.h

; 140  : 	{return m_kST.m_akTerrainVertex;}

  00011	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00014	8b 40 0c	 mov	 eax, DWORD PTR [eax+12]
  00017	8b 40 6c	 mov	 eax, DWORD PTR [eax+108]
  0001a	89 45 f8	 mov	 DWORD PTR $T1[ebp], eax
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp

; 220  : 		return m_pTerrainPatch->SoftwareTransformPatch_GetTerrainVertexDataPtr();

  0001d	8b 45 f8	 mov	 eax, DWORD PTR $T1[ebp]
  00020	eb 02		 jmp	 SHORT $LN1@SoftwareTr
$LN2@SoftwareTr:

; 221  : 	
; 222  : 	return NULL;

  00022	33 c0		 xor	 eax, eax
$LN1@SoftwareTr:

; 223  : }

  00024	c9		 leave
  00025	c3		 ret	 0
?SoftwareTransformPatch_GetTerrainVertexDataPtr@CTerrainPatchProxy@@QAEPAUSoftwareTransformPatch_SSourceVertex@@XZ ENDP ; CTerrainPatchProxy::SoftwareTransformPatch_GetTerrainVertexDataPtr
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?GetWaterFaceCount@CTerrainPatchProxy@@QAEIXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?GetWaterFaceCount@CTerrainPatchProxy@@QAEIXZ PROC	; CTerrainPatchProxy::GetWaterFaceCount, COMDAT
; _this$ = ecx

; 226  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 227  : 	if (m_pTerrainPatch)

  00007	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000a	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  0000e	74 0d		 je	 SHORT $LN2@GetWaterFa

; 228  : 		return m_pTerrainPatch->GetWaterFaceCount();

  00010	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00013	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  00016	e8 00 00 00 00	 call	 ?GetWaterFaceCount@CTerrainPatch@@QAEIXZ ; CTerrainPatch::GetWaterFaceCount
  0001b	eb 02		 jmp	 SHORT $LN1@GetWaterFa
$LN2@GetWaterFa:

; 229  : 	
; 230  : 	return 0;

  0001d	33 c0		 xor	 eax, eax
$LN1@GetWaterFa:

; 231  : }

  0001f	c9		 leave
  00020	c3		 ret	 0
?GetWaterFaceCount@CTerrainPatchProxy@@QAEIXZ ENDP	; CTerrainPatchProxy::GetWaterFaceCount
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?IsIn@CTerrainPatchProxy@@QAE_NABUD3DXVECTOR3@@M@Z
_TEXT	SEGMENT
_fDist$ = -20						; size = 4
_fCheck$ = -16						; size = 4
_dy$ = -12						; size = 4
_dx$ = -8						; size = 4
_this$ = -4						; size = 4
_c_rv3Target$ = 8					; size = 4
_fRadius$ = 12						; size = 4
?IsIn@CTerrainPatchProxy@@QAE_NABUD3DXVECTOR3@@M@Z PROC	; CTerrainPatchProxy::IsIn, COMDAT
; _this$ = ecx

; 191  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 192  : 	float dx=m_v3Center.x-c_rv3Target.x;

  00009	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000c	8b 4d 08	 mov	 ecx, DWORD PTR _c_rv3Target$[ebp]
  0000f	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00014	f3 0f 5c 01	 subss	 xmm0, DWORD PTR [ecx]
  00018	f3 0f 11 45 f8	 movss	 DWORD PTR _dx$[ebp], xmm0

; 193  : 	float dy=m_v3Center.y-c_rv3Target.y;

  0001d	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00020	8b 4d 08	 mov	 ecx, DWORD PTR _c_rv3Target$[ebp]
  00023	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00028	f3 0f 5c 41 04	 subss	 xmm0, DWORD PTR [ecx+4]
  0002d	f3 0f 11 45 f4	 movss	 DWORD PTR _dy$[ebp], xmm0

; 194  : 	float fDist=dx*dx+dy*dy;

  00032	f3 0f 10 45 f8	 movss	 xmm0, DWORD PTR _dx$[ebp]
  00037	f3 0f 59 45 f8	 mulss	 xmm0, DWORD PTR _dx$[ebp]
  0003c	f3 0f 10 4d f4	 movss	 xmm1, DWORD PTR _dy$[ebp]
  00041	f3 0f 59 4d f4	 mulss	 xmm1, DWORD PTR _dy$[ebp]
  00046	f3 0f 58 c1	 addss	 xmm0, xmm1
  0004a	f3 0f 11 45 ec	 movss	 DWORD PTR _fDist$[ebp], xmm0

; 195  : 	float fCheck=fRadius*fRadius;

  0004f	f3 0f 10 45 0c	 movss	 xmm0, DWORD PTR _fRadius$[ebp]
  00054	f3 0f 59 45 0c	 mulss	 xmm0, DWORD PTR _fRadius$[ebp]
  00059	f3 0f 11 45 f0	 movss	 DWORD PTR _fCheck$[ebp], xmm0

; 196  : 
; 197  : 	if (fDist<fCheck)

  0005e	f3 0f 10 45 f0	 movss	 xmm0, DWORD PTR _fCheck$[ebp]
  00063	0f 2f 45 ec	 comiss	 xmm0, DWORD PTR _fDist$[ebp]
  00067	76 04		 jbe	 SHORT $LN2@IsIn

; 198  : 		return true;

  00069	b0 01		 mov	 al, 1
  0006b	eb 02		 jmp	 SHORT $LN1@IsIn
$LN2@IsIn:

; 199  : 
; 200  : 	return false;

  0006d	32 c0		 xor	 al, al
$LN1@IsIn:

; 201  : }

  0006f	c9		 leave
  00070	c2 08 00	 ret	 8
?IsIn@CTerrainPatchProxy@@QAE_NABUD3DXVECTOR3@@M@Z ENDP	; CTerrainPatchProxy::IsIn
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?SetCenterPosition@CTerrainPatchProxy@@QAEXABUD3DXVECTOR3@@@Z
_TEXT	SEGMENT
_this$ = -4						; size = 4
_c_rv3Center$ = 8					; size = 4
?SetCenterPosition@CTerrainPatchProxy@@QAEXABUD3DXVECTOR3@@@Z PROC ; CTerrainPatchProxy::SetCenterPosition, COMDAT
; _this$ = ecx

; 186  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	56		 push	 esi
  00005	57		 push	 edi
  00006	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 187  : 	m_v3Center=c_rv3Center;

  00009	8b 7d fc	 mov	 edi, DWORD PTR _this$[ebp]
  0000c	83 c7 10	 add	 edi, 16			; 00000010H
  0000f	8b 75 08	 mov	 esi, DWORD PTR _c_rv3Center$[ebp]
  00012	a5		 movsd
  00013	a5		 movsd
  00014	a5		 movsd

; 188  : }

  00015	5f		 pop	 edi
  00016	5e		 pop	 esi
  00017	c9		 leave
  00018	c2 04 00	 ret	 4
?SetCenterPosition@CTerrainPatchProxy@@QAEXABUD3DXVECTOR3@@@Z ENDP ; CTerrainPatchProxy::SetCenterPosition
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?Clear@CTerrainPatchProxy@@QAEXXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?Clear@CTerrainPatchProxy@@QAEXXZ PROC			; CTerrainPatchProxy::Clear, COMDAT
; _this$ = ecx

; 234  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 235  : 	m_bUsed = false;

  00007	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000a	c6 40 04 00	 mov	 BYTE PTR [eax+4], 0

; 236  : 	m_sPatchNum = 0;

  0000e	33 c0		 xor	 eax, eax
  00010	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00013	66 89 41 06	 mov	 WORD PTR [ecx+6], ax

; 237  : 	m_byTerrainNum = 0xFF;

  00017	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0001a	c6 40 08 ff	 mov	 BYTE PTR [eax+8], 255	; 000000ffH

; 238  : 
; 239  : 	m_pTerrainPatch = NULL;

  0001e	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00021	83 60 0c 00	 and	 DWORD PTR [eax+12], 0

; 240  : }

  00025	c9		 leave
  00026	c3		 ret	 0
?Clear@CTerrainPatchProxy@@QAEXXZ ENDP			; CTerrainPatchProxy::Clear
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ??1CTerrainPatchProxy@@UAE@XZ
_TEXT	SEGMENT
_this$ = -16						; size = 4
__$EHRec$ = -12						; size = 12
??1CTerrainPatchProxy@@UAE@XZ PROC			; CTerrainPatchProxy::~CTerrainPatchProxy, COMDAT
; _this$ = ecx

; 181  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	6a ff		 push	 -1
  00005	68 00 00 00 00	 push	 __ehhandler$??1CTerrainPatchProxy@@UAE@XZ
  0000a	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  00010	50		 push	 eax
  00011	51		 push	 ecx
  00012	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00017	33 c5		 xor	 eax, ebp
  00019	50		 push	 eax
  0001a	8d 45 f4	 lea	 eax, DWORD PTR __$EHRec$[ebp]
  0001d	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00023	89 4d f0	 mov	 DWORD PTR _this$[ebp], ecx
  00026	8b 45 f0	 mov	 eax, DWORD PTR _this$[ebp]
  00029	c7 00 00 00 00
	00		 mov	 DWORD PTR [eax], OFFSET ??_7CTerrainPatchProxy@@6B@

; 182  : 	Clear();

  0002f	8b 4d f0	 mov	 ecx, DWORD PTR _this$[ebp]
  00032	e8 00 00 00 00	 call	 ?Clear@CTerrainPatchProxy@@QAEXXZ ; CTerrainPatchProxy::Clear

; 183  : }

  00037	8b 4d f4	 mov	 ecx, DWORD PTR __$EHRec$[ebp]
  0003a	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00041	59		 pop	 ecx
  00042	c9		 leave
  00043	c3		 ret	 0
  00044	cc		 int	 3
  00045	cc		 int	 3
  00046	cc		 int	 3
  00047	cc		 int	 3
  00048	cc		 int	 3
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__ehhandler$??1CTerrainPatchProxy@@UAE@XZ:
  00000	90		 npad	 1
  00001	90		 npad	 1
  00002	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  00006	8d 42 0c	 lea	 eax, DWORD PTR [edx+12]
  00009	8b 4a f8	 mov	 ecx, DWORD PTR [edx-8]
  0000c	33 c8		 xor	 ecx, eax
  0000e	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00013	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$??1CTerrainPatchProxy@@UAE@XZ
  00018	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
??1CTerrainPatchProxy@@UAE@XZ ENDP			; CTerrainPatchProxy::~CTerrainPatchProxy
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ??0CTerrainPatchProxy@@QAE@XZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
??0CTerrainPatchProxy@@QAE@XZ PROC			; CTerrainPatchProxy::CTerrainPatchProxy, COMDAT
; _this$ = ecx

; 176  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx
  00007	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000a	c7 00 00 00 00
	00		 mov	 DWORD PTR [eax], OFFSET ??_7CTerrainPatchProxy@@6B@

; 177  : 	Clear();

  00010	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00013	e8 00 00 00 00	 call	 ?Clear@CTerrainPatchProxy@@QAEXXZ ; CTerrainPatchProxy::Clear

; 178  : }

  00018	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0001b	c9		 leave
  0001c	c3		 ret	 0
??0CTerrainPatchProxy@@QAE@XZ ENDP			; CTerrainPatchProxy::CTerrainPatchProxy
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?__Initialize@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?__Initialize@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ PROC ; CTerrainPatch::SSoftwareTransformPatch::__Initialize, COMDAT
; _this$ = ecx

; 37   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 38   : 	m_akTerrainVertex=NULL;

  00007	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000a	83 20 00	 and	 DWORD PTR [eax], 0

; 39   : }

  0000d	c9		 leave
  0000e	c3		 ret	 0
?__Initialize@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ENDP ; CTerrainPatch::SSoftwareTransformPatch::__Initialize
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?Destroy@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ
_TEXT	SEGMENT
$T1 = -8						; size = 4
_this$ = -4						; size = 4
?Destroy@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ PROC ; CTerrainPatch::SSoftwareTransformPatch::Destroy, COMDAT
; _this$ = ecx

; 29   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	51		 push	 ecx
  00005	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 30   : 	if (m_akTerrainVertex)

  00008	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000b	83 38 00	 cmp	 DWORD PTR [eax], 0
  0000e	74 11		 je	 SHORT $LN2@Destroy

; 31   : 		delete [] m_akTerrainVertex;

  00010	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00013	8b 00		 mov	 eax, DWORD PTR [eax]
  00015	89 45 f8	 mov	 DWORD PTR $T1[ebp], eax
  00018	ff 75 f8	 push	 DWORD PTR $T1[ebp]
  0001b	e8 00 00 00 00	 call	 ??_V@YAXPAX@Z		; operator delete[]
  00020	59		 pop	 ecx
$LN2@Destroy:

; 32   : 
; 33   : 	__Initialize();

  00021	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00024	e8 00 00 00 00	 call	 ?__Initialize@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::__Initialize

; 34   : }

  00029	c9		 leave
  0002a	c3		 ret	 0
?Destroy@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ENDP ; CTerrainPatch::SSoftwareTransformPatch::Destroy
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?Create@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ
_TEXT	SEGMENT
$T1 = -28						; size = 4
_this$ = -24						; size = 4
tv82 = -20						; size = 4
tv78 = -16						; size = 4
___t$ = -12						; size = 4
$T2 = -8						; size = 4
___n$ = -4						; size = 4
?Create@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ PROC ; CTerrainPatch::SSoftwareTransformPatch::Create, COMDAT
; _this$ = ecx

; 23   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 1c	 sub	 esp, 28			; 0000001cH
  00006	89 4d e8	 mov	 DWORD PTR _this$[ebp], ecx

; 24   : 	assert(NULL==m_akTerrainVertex);
; 25   : 	m_akTerrainVertex=new SoftwareTransformPatch_SSourceVertex[TERRAIN_VERTEX_COUNT];

  00009	68 9c 1f 00 00	 push	 8092			; 00001f9cH
  0000e	e8 00 00 00 00	 call	 ??_U@YAPAXI@Z		; operator new[]
  00013	59		 pop	 ecx
  00014	89 45 f8	 mov	 DWORD PTR $T2[ebp], eax
  00017	83 7d f8 00	 cmp	 DWORD PTR $T2[ebp], 0
  0001b	74 33		 je	 SHORT $LN3@Create
  0001d	c7 45 fc 21 01
	00 00		 mov	 DWORD PTR ___n$[ebp], 289 ; 00000121H
  00024	8b 45 f8	 mov	 eax, DWORD PTR $T2[ebp]
  00027	89 45 f4	 mov	 DWORD PTR ___t$[ebp], eax
$LN7@Create:
  0002a	8b 45 fc	 mov	 eax, DWORD PTR ___n$[ebp]
  0002d	89 45 ec	 mov	 DWORD PTR tv82[ebp], eax
  00030	8b 45 fc	 mov	 eax, DWORD PTR ___n$[ebp]
  00033	48		 dec	 eax
  00034	89 45 fc	 mov	 DWORD PTR ___n$[ebp], eax
  00037	83 7d ec 00	 cmp	 DWORD PTR tv82[ebp], 0
  0003b	76 0b		 jbe	 SHORT $LN6@Create
  0003d	8b 45 f4	 mov	 eax, DWORD PTR ___t$[ebp]
  00040	83 c0 1c	 add	 eax, 28			; 0000001cH
  00043	89 45 f4	 mov	 DWORD PTR ___t$[ebp], eax
  00046	eb e2		 jmp	 SHORT $LN7@Create
$LN6@Create:
  00048	8b 45 f8	 mov	 eax, DWORD PTR $T2[ebp]
  0004b	89 45 f0	 mov	 DWORD PTR tv78[ebp], eax
  0004e	eb 04		 jmp	 SHORT $LN4@Create
$LN3@Create:
  00050	83 65 f0 00	 and	 DWORD PTR tv78[ebp], 0
$LN4@Create:
  00054	8b 45 f0	 mov	 eax, DWORD PTR tv78[ebp]
  00057	89 45 e4	 mov	 DWORD PTR $T1[ebp], eax
  0005a	8b 45 e8	 mov	 eax, DWORD PTR _this$[ebp]
  0005d	8b 4d e4	 mov	 ecx, DWORD PTR $T1[ebp]
  00060	89 08		 mov	 DWORD PTR [eax], ecx

; 26   : }

  00062	c9		 leave
  00063	c3		 ret	 0
?Create@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ENDP ; CTerrainPatch::SSoftwareTransformPatch::Create
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ??1SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ
_TEXT	SEGMENT
_this$ = -16						; size = 4
__$EHRec$ = -12						; size = 12
??1SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ PROC	; CTerrainPatch::SSoftwareTransformPatch::~SSoftwareTransformPatch, COMDAT
; _this$ = ecx

; 18   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	6a ff		 push	 -1
  00005	68 00 00 00 00	 push	 __ehhandler$??1SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ
  0000a	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  00010	50		 push	 eax
  00011	51		 push	 ecx
  00012	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00017	33 c5		 xor	 eax, ebp
  00019	50		 push	 eax
  0001a	8d 45 f4	 lea	 eax, DWORD PTR __$EHRec$[ebp]
  0001d	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00023	89 4d f0	 mov	 DWORD PTR _this$[ebp], ecx

; 19   : 	Destroy();

  00026	8b 4d f0	 mov	 ecx, DWORD PTR _this$[ebp]
  00029	e8 00 00 00 00	 call	 ?Destroy@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::Destroy

; 20   : }

  0002e	8b 4d f4	 mov	 ecx, DWORD PTR __$EHRec$[ebp]
  00031	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00038	59		 pop	 ecx
  00039	c9		 leave
  0003a	c3		 ret	 0
  0003b	cc		 int	 3
  0003c	cc		 int	 3
  0003d	cc		 int	 3
  0003e	cc		 int	 3
  0003f	cc		 int	 3
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__ehhandler$??1SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ:
  00000	90		 npad	 1
  00001	90		 npad	 1
  00002	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  00006	8d 42 0c	 lea	 eax, DWORD PTR [edx+12]
  00009	8b 4a f8	 mov	 ecx, DWORD PTR [edx-8]
  0000c	33 c8		 xor	 ecx, eax
  0000e	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00013	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$??1SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ
  00018	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
??1SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ ENDP	; CTerrainPatch::SSoftwareTransformPatch::~SSoftwareTransformPatch
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ??0SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
??0SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ PROC	; CTerrainPatch::SSoftwareTransformPatch::SSoftwareTransformPatch, COMDAT
; _this$ = ecx

; 13   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 14   : 	__Initialize();	

  00007	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0000a	e8 00 00 00 00	 call	 ?__Initialize@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::__Initialize

; 15   : }

  0000f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00012	c9		 leave
  00013	c3		 ret	 0
??0SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ ENDP	; CTerrainPatch::SSoftwareTransformPatch::SSoftwareTransformPatch
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.h
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?__BuildSoftwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z
_TEXT	SEGMENT
_akDstVertex$ = -12					; size = 4
_this$ = -8						; size = 4
_uIndex$1 = -4						; size = 4
_akSrcVertex$ = 8					; size = 4
?__BuildSoftwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z PROC ; CTerrainPatch::__BuildSoftwareTerrainVertexBuffer, COMDAT
; _this$ = ecx

; 90   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH
  00006	56		 push	 esi
  00007	57		 push	 edi
  00008	89 4d f8	 mov	 DWORD PTR _this$[ebp], ecx

; 91   : 	//DWORD dwVBSize=sizeof(HardwareTransformPatch_SSourceVertex)*TERRAIN_VERTEX_COUNT;
; 92   : 
; 93   : 	m_kST.Create();

  0000b	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  0000e	83 c1 6c	 add	 ecx, 108		; 0000006cH
  00011	e8 00 00 00 00	 call	 ?Create@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::Create
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.h

; 140  : 	{return m_kST.m_akTerrainVertex;}

  00016	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00019	8b 40 6c	 mov	 eax, DWORD PTR [eax+108]
  0001c	89 45 f4	 mov	 DWORD PTR _akDstVertex$[ebp], eax
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp

; 96   : 	for (UINT uIndex=0; uIndex!=TERRAIN_VERTEX_COUNT; ++uIndex)

  0001f	83 65 fc 00	 and	 DWORD PTR _uIndex$1[ebp], 0
  00023	eb 07		 jmp	 SHORT $LN4@BuildSoftw
$LN2@BuildSoftw:
  00025	8b 45 fc	 mov	 eax, DWORD PTR _uIndex$1[ebp]
  00028	40		 inc	 eax
  00029	89 45 fc	 mov	 DWORD PTR _uIndex$1[ebp], eax
$LN4@BuildSoftw:
  0002c	81 7d fc 21 01
	00 00		 cmp	 DWORD PTR _uIndex$1[ebp], 289 ; 00000121H
  00033	74 21		 je	 SHORT $LN1@BuildSoftw

; 97   : 	{
; 98   : 		*((HardwareTransformPatch_SSourceVertex*)(akDstVertex+uIndex))=*(akSrcVertex+uIndex);

  00035	6b 75 fc 18	 imul	 esi, DWORD PTR _uIndex$1[ebp], 24
  00039	03 75 08	 add	 esi, DWORD PTR _akSrcVertex$[ebp]
  0003c	6b 7d fc 1c	 imul	 edi, DWORD PTR _uIndex$1[ebp], 28
  00040	03 7d f4	 add	 edi, DWORD PTR _akDstVertex$[ebp]
  00043	6a 06		 push	 6
  00045	59		 pop	 ecx
  00046	f3 a5		 rep movsd

; 99   : 		akDstVertex[uIndex].dwDiffuse=0xFFFFFFFF;

  00048	6b 45 fc 1c	 imul	 eax, DWORD PTR _uIndex$1[ebp], 28
  0004c	8b 4d f4	 mov	 ecx, DWORD PTR _akDstVertex$[ebp]
  0004f	83 4c 01 18 ff	 or	 DWORD PTR [ecx+eax+24], -1

; 100  : 	}

  00054	eb cf		 jmp	 SHORT $LN2@BuildSoftw
$LN1@BuildSoftw:

; 101  : }

  00056	5f		 pop	 edi
  00057	5e		 pop	 esi
  00058	c9		 leave
  00059	c2 04 00	 ret	 4
?__BuildSoftwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ENDP ; CTerrainPatch::__BuildSoftwareTerrainVertexBuffer
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?__BuildHardwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z
_TEXT	SEGMENT
_akDstVertex$ = -16					; size = 4
_uVBSize$1 = -12					; size = 4
_this$ = -8						; size = 4
_rkVB$ = -4						; size = 4
_akSrcVertex$ = 8					; size = 4
?__BuildHardwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z PROC ; CTerrainPatch::__BuildHardwareTerrainVertexBuffer, COMDAT
; _this$ = ecx

; 104  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 10	 sub	 esp, 16			; 00000010H
  00006	89 4d f8	 mov	 DWORD PTR _this$[ebp], ecx

; 105  : 	
; 106  : 	CGraphicVertexBuffer& rkVB=m_kHT.m_kVB;

  00009	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0000c	83 c0 4c	 add	 eax, 76			; 0000004cH
  0000f	89 45 fc	 mov	 DWORD PTR _rkVB$[ebp], eax

; 107  : 	if (!rkVB.Create(TERRAIN_VERTEX_COUNT, D3DFVF_XYZ | D3DFVF_NORMAL, D3DUSAGE_WRITEONLY, D3DPOOL_MANAGED)) 

  00012	6a 01		 push	 1
  00014	6a 08		 push	 8
  00016	6a 12		 push	 18			; 00000012H
  00018	68 21 01 00 00	 push	 289			; 00000121H
  0001d	8b 45 fc	 mov	 eax, DWORD PTR _rkVB$[ebp]
  00020	8b 00		 mov	 eax, DWORD PTR [eax]
  00022	8b 4d fc	 mov	 ecx, DWORD PTR _rkVB$[ebp]
  00025	ff 50 04	 call	 DWORD PTR [eax+4]
  00028	0f b6 c0	 movzx	 eax, al
  0002b	85 c0		 test	 eax, eax
  0002d	75 02		 jne	 SHORT $LN2@BuildHardw

; 108  : 		return;

  0002f	eb 36		 jmp	 SHORT $LN1@BuildHardw
$LN2@BuildHardw:

; 109  : 	
; 110  : 	HardwareTransformPatch_SSourceVertex* akDstVertex;
; 111  : 	if (rkVB.Lock((void **) &akDstVertex))

  00031	8d 45 f0	 lea	 eax, DWORD PTR _akDstVertex$[ebp]
  00034	50		 push	 eax
  00035	8b 45 fc	 mov	 eax, DWORD PTR _rkVB$[ebp]
  00038	8b 00		 mov	 eax, DWORD PTR [eax]
  0003a	8b 4d fc	 mov	 ecx, DWORD PTR _rkVB$[ebp]
  0003d	ff 50 08	 call	 DWORD PTR [eax+8]
  00040	0f b6 c0	 movzx	 eax, al
  00043	85 c0		 test	 eax, eax
  00045	74 20		 je	 SHORT $LN1@BuildHardw

; 112  : 	{
; 113  : 		UINT uVBSize=sizeof(HardwareTransformPatch_SSourceVertex)*TERRAIN_VERTEX_COUNT;

  00047	c7 45 f4 18 1b
	00 00		 mov	 DWORD PTR _uVBSize$1[ebp], 6936 ; 00001b18H

; 114  : 	
; 115  : 		memcpy(akDstVertex, akSrcVertex, uVBSize);

  0004e	ff 75 f4	 push	 DWORD PTR _uVBSize$1[ebp]
  00051	ff 75 08	 push	 DWORD PTR _akSrcVertex$[ebp]
  00054	ff 75 f0	 push	 DWORD PTR _akDstVertex$[ebp]
  00057	e8 00 00 00 00	 call	 _memcpy
  0005c	83 c4 0c	 add	 esp, 12			; 0000000cH

; 116  : 		rkVB.Unlock();		

  0005f	8b 4d fc	 mov	 ecx, DWORD PTR _rkVB$[ebp]
  00062	e8 00 00 00 00	 call	 ?Unlock@CGraphicVertexBuffer@@QAE_NXZ ; CGraphicVertexBuffer::Unlock
$LN1@BuildHardw:

; 117  : 	}
; 118  : }

  00067	c9		 leave
  00068	c2 04 00	 ret	 4
?__BuildHardwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ENDP ; CTerrainPatch::__BuildHardwareTerrainVertexBuffer
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?BuildWaterVertexBuffer@CTerrainPatch@@QAEXPAUSWaterVertex@@I@Z
_TEXT	SEGMENT
_akDstWaterVertex$ = -16				; size = 4
_uVBSize$1 = -12					; size = 4
_this$ = -8						; size = 4
_rkVB$ = -4						; size = 4
_akSrcVertex$ = 8					; size = 4
_uWaterVertexCount$ = 12				; size = 4
?BuildWaterVertexBuffer@CTerrainPatch@@QAEXPAUSWaterVertex@@I@Z PROC ; CTerrainPatch::BuildWaterVertexBuffer, COMDAT
; _this$ = ecx

; 64   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 10	 sub	 esp, 16			; 00000010H
  00006	89 4d f8	 mov	 DWORD PTR _this$[ebp], ecx

; 65   : 	CGraphicVertexBuffer& rkVB=m_WaterVertexBuffer;

  00009	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0000c	83 c0 24	 add	 eax, 36			; 00000024H
  0000f	89 45 fc	 mov	 DWORD PTR _rkVB$[ebp], eax

; 66   : 
; 67   : 	if (!rkVB.Create(uWaterVertexCount, D3DFVF_XYZ | D3DFVF_DIFFUSE, D3DUSAGE_WRITEONLY, D3DPOOL_MANAGED)) 

  00012	6a 01		 push	 1
  00014	6a 08		 push	 8
  00016	6a 42		 push	 66			; 00000042H
  00018	ff 75 0c	 push	 DWORD PTR _uWaterVertexCount$[ebp]
  0001b	8b 45 fc	 mov	 eax, DWORD PTR _rkVB$[ebp]
  0001e	8b 00		 mov	 eax, DWORD PTR [eax]
  00020	8b 4d fc	 mov	 ecx, DWORD PTR _rkVB$[ebp]
  00023	ff 50 04	 call	 DWORD PTR [eax+4]
  00026	0f b6 c0	 movzx	 eax, al
  00029	85 c0		 test	 eax, eax
  0002b	75 02		 jne	 SHORT $LN2@BuildWater

; 68   : 		return;

  0002d	eb 48		 jmp	 SHORT $LN1@BuildWater
$LN2@BuildWater:

; 69   : 	
; 70   : 	SWaterVertex* akDstWaterVertex;
; 71   : 	if (rkVB.Lock((void **) &akDstWaterVertex))

  0002f	8d 45 f0	 lea	 eax, DWORD PTR _akDstWaterVertex$[ebp]
  00032	50		 push	 eax
  00033	8b 45 fc	 mov	 eax, DWORD PTR _rkVB$[ebp]
  00036	8b 00		 mov	 eax, DWORD PTR [eax]
  00038	8b 4d fc	 mov	 ecx, DWORD PTR _rkVB$[ebp]
  0003b	ff 50 08	 call	 DWORD PTR [eax+8]
  0003e	0f b6 c0	 movzx	 eax, al
  00041	85 c0		 test	 eax, eax
  00043	74 32		 je	 SHORT $LN1@BuildWater

; 72   : 	{
; 73   : 		UINT uVBSize=sizeof(SWaterVertex)*uWaterVertexCount;

  00045	8b 45 0c	 mov	 eax, DWORD PTR _uWaterVertexCount$[ebp]
  00048	c1 e0 04	 shl	 eax, 4
  0004b	89 45 f4	 mov	 DWORD PTR _uVBSize$1[ebp], eax

; 74   : 		memcpy(akDstWaterVertex, akSrcVertex, uVBSize);

  0004e	ff 75 f4	 push	 DWORD PTR _uVBSize$1[ebp]
  00051	ff 75 08	 push	 DWORD PTR _akSrcVertex$[ebp]
  00054	ff 75 f0	 push	 DWORD PTR _akDstWaterVertex$[ebp]
  00057	e8 00 00 00 00	 call	 _memcpy
  0005c	83 c4 0c	 add	 esp, 12			; 0000000cH

; 75   : 		m_dwWaterPriCount=uWaterVertexCount/3;

  0005f	8b 45 0c	 mov	 eax, DWORD PTR _uWaterVertexCount$[ebp]
  00062	33 d2		 xor	 edx, edx
  00064	6a 03		 push	 3
  00066	59		 pop	 ecx
  00067	f7 f1		 div	 ecx
  00069	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  0006c	89 41 20	 mov	 DWORD PTR [ecx+32], eax

; 76   : 
; 77   : 		rkVB.Unlock();		

  0006f	8b 4d fc	 mov	 ecx, DWORD PTR _rkVB$[ebp]
  00072	e8 00 00 00 00	 call	 ?Unlock@CGraphicVertexBuffer@@QAE_NXZ ; CGraphicVertexBuffer::Unlock
$LN1@BuildWater:

; 78   : 	}	
; 79   : }

  00077	c9		 leave
  00078	c2 08 00	 ret	 8
?BuildWaterVertexBuffer@CTerrainPatch@@QAEXPAUSWaterVertex@@I@Z ENDP ; CTerrainPatch::BuildWaterVertexBuffer
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?BuildTerrainVertexBuffer@CTerrainPatch@@QAEXPAUHardwareTransformPatch_SSourceVertex@@@Z
_TEXT	SEGMENT
_this$ = -4						; size = 4
_akSrcVertex$ = 8					; size = 4
?BuildTerrainVertexBuffer@CTerrainPatch@@QAEXPAUHardwareTransformPatch_SSourceVertex@@@Z PROC ; CTerrainPatch::BuildTerrainVertexBuffer, COMDAT
; _this$ = ecx

; 82   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 83   : 	if (SOFTWARE_TRANSFORM_PATCH_ENABLE)

  00007	0f b6 05 00 00
	00 00		 movzx	 eax, BYTE PTR ?SOFTWARE_TRANSFORM_PATCH_ENABLE@CTerrainPatch@@2_NA ; CTerrainPatch::SOFTWARE_TRANSFORM_PATCH_ENABLE
  0000e	85 c0		 test	 eax, eax
  00010	74 0d		 je	 SHORT $LN2@BuildTerra

; 84   : 		__BuildSoftwareTerrainVertexBuffer(akSrcVertex);

  00012	ff 75 08	 push	 DWORD PTR _akSrcVertex$[ebp]
  00015	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00018	e8 00 00 00 00	 call	 ?__BuildSoftwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ; CTerrainPatch::__BuildSoftwareTerrainVertexBuffer
  0001d	eb 0b		 jmp	 SHORT $LN1@BuildTerra
$LN2@BuildTerra:

; 85   : 	else
; 86   : 		__BuildHardwareTerrainVertexBuffer(akSrcVertex);

  0001f	ff 75 08	 push	 DWORD PTR _akSrcVertex$[ebp]
  00022	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00025	e8 00 00 00 00	 call	 ?__BuildHardwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ; CTerrainPatch::__BuildHardwareTerrainVertexBuffer
$LN1@BuildTerra:

; 87   : }

  0002a	c9		 leave
  0002b	c2 04 00	 ret	 4
?BuildTerrainVertexBuffer@CTerrainPatch@@QAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ENDP ; CTerrainPatch::BuildTerrainVertexBuffer
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.h
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\M2Data\include\d3dx8math.inl
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\M2Data\include\d3dx8math.inl
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatch@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z
_TEXT	SEGMENT
_S$1 = -76						; size = 4
_N$2 = -72						; size = 4
_akSrcVertex$ = -68					; size = 4
_dwAmbientB$ = -64					; size = 4
_dwDiffuseB$ = -60					; size = 4
_dwAmbientG$ = -56					; size = 4
_dwDiffuseG$ = -52					; size = 4
_dwAmbientR$ = -48					; size = 4
_dwDiffuseR$ = -44					; size = 4
_fDot$3 = -40						; size = 4
_pV1$ = -36						; size = 4
_v$ = -32						; size = 4
_this$ = -28						; size = 4
_dwDot$ = -24						; size = 4
_uIndex$4 = -20						; size = 4
_kLightDir$ = -16					; size = 12
__$ArrayPad$ = -4					; size = 4
_dwVersion$ = 8						; size = 4
_c_rkLight$ = 12					; size = 4
_c_rkMtrl$ = 16						; size = 4
?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatch@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z PROC ; CTerrainPatch::SoftwareTransformPatch_UpdateTerrainLighting, COMDAT
; _this$ = ecx

; 121  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 4c	 sub	 esp, 76			; 0000004cH
  00006	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000b	33 c5		 xor	 eax, ebp
  0000d	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00010	89 4d e4	 mov	 DWORD PTR _this$[ebp], ecx

; 122  : 	if (m_dwVersion==dwVersion)

  00013	8b 45 e4	 mov	 eax, DWORD PTR _this$[ebp]
  00016	8b 40 48	 mov	 eax, DWORD PTR [eax+72]
  00019	3b 45 08	 cmp	 eax, DWORD PTR _dwVersion$[ebp]
  0001c	75 05		 jne	 SHORT $LN5@SoftwareTr

; 123  : 		return;

  0001e	e9 5c 02 00 00	 jmp	 $LN1@SoftwareTr
$LN5@SoftwareTr:

; 124  : 
; 125  : 	m_dwVersion=dwVersion;

  00023	8b 45 e4	 mov	 eax, DWORD PTR _this$[ebp]
  00026	8b 4d 08	 mov	 ecx, DWORD PTR _dwVersion$[ebp]
  00029	89 48 48	 mov	 DWORD PTR [eax+72], ecx
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.h

; 140  : 	{return m_kST.m_akTerrainVertex;}

  0002c	8b 45 e4	 mov	 eax, DWORD PTR _this$[ebp]
  0002f	8b 40 6c	 mov	 eax, DWORD PTR [eax+108]
  00032	89 45 bc	 mov	 DWORD PTR _akSrcVertex$[ebp], eax
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp

; 128  : 	if (!akSrcVertex)

  00035	83 7d bc 00	 cmp	 DWORD PTR _akSrcVertex$[ebp], 0
  00039	75 05		 jne	 SHORT $LN6@SoftwareTr

; 129  : 		return;

  0003b	e9 3f 02 00 00	 jmp	 $LN1@SoftwareTr
$LN6@SoftwareTr:

; 130  : 	
; 131  : 	D3DXVECTOR3 kLightDir=c_rkLight.Direction;	

  00040	8b 45 0c	 mov	 eax, DWORD PTR _c_rkLight$[ebp]
  00043	83 c0 40	 add	 eax, 64			; 00000040H
  00046	89 45 e0	 mov	 DWORD PTR _v$[ebp], eax
; File D:\Metin2 Server Files\mainline\SRC_2014\M2Data\include\d3dx8math.inl

; 172  :     x = v.x;

  00049	8b 45 e0	 mov	 eax, DWORD PTR _v$[ebp]
  0004c	f3 0f 10 00	 movss	 xmm0, DWORD PTR [eax]
  00050	f3 0f 11 45 f0	 movss	 DWORD PTR _kLightDir$[ebp], xmm0

; 173  :     y = v.y;

  00055	8b 45 e0	 mov	 eax, DWORD PTR _v$[ebp]
  00058	f3 0f 10 40 04	 movss	 xmm0, DWORD PTR [eax+4]
  0005d	f3 0f 11 45 f4	 movss	 DWORD PTR _kLightDir$[ebp+4], xmm0

; 174  :     z = v.z;

  00062	8b 45 e0	 mov	 eax, DWORD PTR _v$[ebp]
  00065	f3 0f 10 40 08	 movss	 xmm0, DWORD PTR [eax+8]
  0006a	f3 0f 11 45 f8	 movss	 DWORD PTR _kLightDir$[ebp+8], xmm0
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp

; 135  : 	DWORD dwAmbientR=(c_rkMtrl.Ambient.r*c_rkLight.Ambient.r+c_rkMtrl.Emissive.r)*255.0f;

  0006f	8b 45 10	 mov	 eax, DWORD PTR _c_rkMtrl$[ebp]
  00072	8b 4d 0c	 mov	 ecx, DWORD PTR _c_rkLight$[ebp]
  00075	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  0007a	f3 0f 59 41 24	 mulss	 xmm0, DWORD PTR [ecx+36]
  0007f	8b 45 10	 mov	 eax, DWORD PTR _c_rkMtrl$[ebp]
  00082	f3 0f 58 40 30	 addss	 xmm0, DWORD PTR [eax+48]
  00087	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  0008f	e8 00 00 00 00	 call	 __ftoui3
  00094	89 45 d0	 mov	 DWORD PTR _dwAmbientR$[ebp], eax

; 136  : 	DWORD dwAmbientG=(c_rkMtrl.Ambient.g*c_rkLight.Ambient.g+c_rkMtrl.Emissive.g)*255.0f;

  00097	8b 45 10	 mov	 eax, DWORD PTR _c_rkMtrl$[ebp]
  0009a	8b 4d 0c	 mov	 ecx, DWORD PTR _c_rkLight$[ebp]
  0009d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  000a2	f3 0f 59 41 28	 mulss	 xmm0, DWORD PTR [ecx+40]
  000a7	8b 45 10	 mov	 eax, DWORD PTR _c_rkMtrl$[ebp]
  000aa	f3 0f 58 40 34	 addss	 xmm0, DWORD PTR [eax+52]
  000af	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  000b7	e8 00 00 00 00	 call	 __ftoui3
  000bc	89 45 c8	 mov	 DWORD PTR _dwAmbientG$[ebp], eax

; 137  : 	DWORD dwAmbientB=(c_rkMtrl.Ambient.b*c_rkLight.Ambient.b+c_rkMtrl.Emissive.b)*255.0f;

  000bf	8b 45 10	 mov	 eax, DWORD PTR _c_rkMtrl$[ebp]
  000c2	8b 4d 0c	 mov	 ecx, DWORD PTR _c_rkLight$[ebp]
  000c5	f3 0f 10 40 18	 movss	 xmm0, DWORD PTR [eax+24]
  000ca	f3 0f 59 41 2c	 mulss	 xmm0, DWORD PTR [ecx+44]
  000cf	8b 45 10	 mov	 eax, DWORD PTR _c_rkMtrl$[ebp]
  000d2	f3 0f 58 40 38	 addss	 xmm0, DWORD PTR [eax+56]
  000d7	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  000df	e8 00 00 00 00	 call	 __ftoui3
  000e4	89 45 c0	 mov	 DWORD PTR _dwAmbientB$[ebp], eax

; 138  : 	DWORD dwDiffuseR=(c_rkMtrl.Diffuse.r*c_rkLight.Diffuse.r)*255.0f;

  000e7	8b 45 10	 mov	 eax, DWORD PTR _c_rkMtrl$[ebp]
  000ea	8b 4d 0c	 mov	 ecx, DWORD PTR _c_rkLight$[ebp]
  000ed	f3 0f 10 00	 movss	 xmm0, DWORD PTR [eax]
  000f1	f3 0f 59 41 04	 mulss	 xmm0, DWORD PTR [ecx+4]
  000f6	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  000fe	e8 00 00 00 00	 call	 __ftoui3
  00103	89 45 d4	 mov	 DWORD PTR _dwDiffuseR$[ebp], eax

; 139  : 	DWORD dwDiffuseG=(c_rkMtrl.Diffuse.g*c_rkLight.Diffuse.g)*255.0f;

  00106	8b 45 10	 mov	 eax, DWORD PTR _c_rkMtrl$[ebp]
  00109	8b 4d 0c	 mov	 ecx, DWORD PTR _c_rkLight$[ebp]
  0010c	f3 0f 10 40 04	 movss	 xmm0, DWORD PTR [eax+4]
  00111	f3 0f 59 41 08	 mulss	 xmm0, DWORD PTR [ecx+8]
  00116	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  0011e	e8 00 00 00 00	 call	 __ftoui3
  00123	89 45 cc	 mov	 DWORD PTR _dwDiffuseG$[ebp], eax

; 140  : 	DWORD dwDiffuseB=(c_rkMtrl.Diffuse.b*c_rkLight.Diffuse.b)*255.0f;

  00126	8b 45 10	 mov	 eax, DWORD PTR _c_rkMtrl$[ebp]
  00129	8b 4d 0c	 mov	 ecx, DWORD PTR _c_rkLight$[ebp]
  0012c	f3 0f 10 40 08	 movss	 xmm0, DWORD PTR [eax+8]
  00131	f3 0f 59 41 0c	 mulss	 xmm0, DWORD PTR [ecx+12]
  00136	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  0013e	e8 00 00 00 00	 call	 __ftoui3
  00143	89 45 c4	 mov	 DWORD PTR _dwDiffuseB$[ebp], eax

; 141  : 
; 142  : 	if (dwDiffuseR>255-dwAmbientR)

  00146	b8 ff 00 00 00	 mov	 eax, 255		; 000000ffH
  0014b	2b 45 d0	 sub	 eax, DWORD PTR _dwAmbientR$[ebp]
  0014e	39 45 d4	 cmp	 DWORD PTR _dwDiffuseR$[ebp], eax
  00151	76 0b		 jbe	 SHORT $LN7@SoftwareTr

; 143  : 		dwDiffuseR=255-dwAmbientR;

  00153	b8 ff 00 00 00	 mov	 eax, 255		; 000000ffH
  00158	2b 45 d0	 sub	 eax, DWORD PTR _dwAmbientR$[ebp]
  0015b	89 45 d4	 mov	 DWORD PTR _dwDiffuseR$[ebp], eax
$LN7@SoftwareTr:

; 144  : 
; 145  : 	if (dwDiffuseG+dwAmbientG>255)

  0015e	8b 45 cc	 mov	 eax, DWORD PTR _dwDiffuseG$[ebp]
  00161	03 45 c8	 add	 eax, DWORD PTR _dwAmbientG$[ebp]
  00164	3d ff 00 00 00	 cmp	 eax, 255		; 000000ffH
  00169	76 0b		 jbe	 SHORT $LN8@SoftwareTr

; 146  : 		dwDiffuseG=255-dwAmbientG;

  0016b	b8 ff 00 00 00	 mov	 eax, 255		; 000000ffH
  00170	2b 45 c8	 sub	 eax, DWORD PTR _dwAmbientG$[ebp]
  00173	89 45 cc	 mov	 DWORD PTR _dwDiffuseG$[ebp], eax
$LN8@SoftwareTr:

; 147  : 
; 148  : 	if (dwDiffuseB+dwAmbientB>255)

  00176	8b 45 c4	 mov	 eax, DWORD PTR _dwDiffuseB$[ebp]
  00179	03 45 c0	 add	 eax, DWORD PTR _dwAmbientB$[ebp]
  0017c	3d ff 00 00 00	 cmp	 eax, 255		; 000000ffH
  00181	76 0b		 jbe	 SHORT $LN9@SoftwareTr

; 149  : 		dwDiffuseB=255-dwAmbientB;

  00183	b8 ff 00 00 00	 mov	 eax, 255		; 000000ffH
  00188	2b 45 c0	 sub	 eax, DWORD PTR _dwAmbientB$[ebp]
  0018b	89 45 c4	 mov	 DWORD PTR _dwDiffuseB$[ebp], eax
$LN9@SoftwareTr:

; 150  : 
; 151  : 	for (UINT uIndex=0; uIndex!=CTerrainPatch::TERRAIN_VERTEX_COUNT; ++uIndex)

  0018e	83 65 ec 00	 and	 DWORD PTR _uIndex$4[ebp], 0
  00192	eb 07		 jmp	 SHORT $LN4@SoftwareTr
$LN2@SoftwareTr:
  00194	8b 45 ec	 mov	 eax, DWORD PTR _uIndex$4[ebp]
  00197	40		 inc	 eax
  00198	89 45 ec	 mov	 DWORD PTR _uIndex$4[ebp], eax
$LN4@SoftwareTr:
  0019b	81 7d ec 21 01
	00 00		 cmp	 DWORD PTR _uIndex$4[ebp], 289 ; 00000121H
  001a2	0f 84 d7 00 00
	00		 je	 $LN3@SoftwareTr

; 153  : 		float fDot=D3DXVec3Dot(&akSrcVertex[uIndex].kNormal, &kLightDir);

  001a8	6b 45 ec 1c	 imul	 eax, DWORD PTR _uIndex$4[ebp], 28
  001ac	8b 4d bc	 mov	 ecx, DWORD PTR _akSrcVertex$[ebp]
  001af	8d 44 01 0c	 lea	 eax, DWORD PTR [ecx+eax+12]
  001b3	89 45 dc	 mov	 DWORD PTR _pV1$[ebp], eax
; File D:\Metin2 Server Files\mainline\SRC_2014\M2Data\include\d3dx8math.inl

; 1264 :     return pV1->x * pV2->x + pV1->y * pV2->y + pV1->z * pV2->z;

  001b6	8b 45 dc	 mov	 eax, DWORD PTR _pV1$[ebp]
  001b9	f3 0f 10 40 08	 movss	 xmm0, DWORD PTR [eax+8]
  001be	f3 0f 59 45 f8	 mulss	 xmm0, DWORD PTR _kLightDir$[ebp+8]
  001c3	8b 45 dc	 mov	 eax, DWORD PTR _pV1$[ebp]
  001c6	f3 0f 10 48 04	 movss	 xmm1, DWORD PTR [eax+4]
  001cb	f3 0f 59 4d f4	 mulss	 xmm1, DWORD PTR _kLightDir$[ebp+4]
  001d0	8b 45 dc	 mov	 eax, DWORD PTR _pV1$[ebp]
  001d3	f3 0f 10 10	 movss	 xmm2, DWORD PTR [eax]
  001d7	f3 0f 59 55 f0	 mulss	 xmm2, DWORD PTR _kLightDir$[ebp]
  001dc	f3 0f 58 d1	 addss	 xmm2, xmm1
  001e0	f3 0f 58 d0	 addss	 xmm2, xmm0
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp

; 153  : 		float fDot=D3DXVec3Dot(&akSrcVertex[uIndex].kNormal, &kLightDir);

  001e4	f3 0f 11 55 d8	 movss	 DWORD PTR _fDot$3[ebp], xmm2

; 154  : 
; 155  : 		const float N=0xffffff;

  001e9	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@4b7fffff
  001f1	f3 0f 11 45 b8	 movss	 DWORD PTR _N$2[ebp], xmm0

; 156  : 		const int S=24;

  001f6	c7 45 b4 18 00
	00 00		 mov	 DWORD PTR _S$1[ebp], 24	; 00000018H

; 157  : 		if (fDot<0.0f) 

  001fd	0f 57 c0	 xorps	 xmm0, xmm0
  00200	0f 2f 45 d8	 comiss	 xmm0, DWORD PTR _fDot$3[ebp]
  00204	76 1e		 jbe	 SHORT $LN10@SoftwareTr

; 158  : 			dwDot=(N*-fDot);

  00206	f3 0f 10 45 d8	 movss	 xmm0, DWORD PTR _fDot$3[ebp]
  0020b	0f 57 05 00 00
	00 00		 xorps	 xmm0, DWORD PTR __xmm@80000000800000008000000080000000
  00212	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@4b7fffff
  0021a	e8 00 00 00 00	 call	 __ftoui3
  0021f	89 45 e8	 mov	 DWORD PTR _dwDot$[ebp], eax
  00222	eb 15		 jmp	 SHORT $LN11@SoftwareTr
$LN10@SoftwareTr:

; 159  : 		else
; 160  : 			dwDot=(N*+fDot);

  00224	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@4b7fffff
  0022c	f3 0f 59 45 d8	 mulss	 xmm0, DWORD PTR _fDot$3[ebp]
  00231	e8 00 00 00 00	 call	 __ftoui3
  00236	89 45 e8	 mov	 DWORD PTR _dwDot$[ebp], eax
$LN11@SoftwareTr:

; 161  : 		
; 162  : 		akSrcVertex[uIndex].dwDiffuse=(0xff000000)|

  00239	8b 45 d4	 mov	 eax, DWORD PTR _dwDiffuseR$[ebp]
  0023c	0f af 45 e8	 imul	 eax, DWORD PTR _dwDot$[ebp]
  00240	c1 e8 18	 shr	 eax, 24			; 00000018H
  00243	03 45 d0	 add	 eax, DWORD PTR _dwAmbientR$[ebp]
  00246	c1 e0 10	 shl	 eax, 16			; 00000010H
  00249	0d 00 00 00 ff	 or	 eax, -16777216		; ff000000H
  0024e	8b 4d cc	 mov	 ecx, DWORD PTR _dwDiffuseG$[ebp]
  00251	0f af 4d e8	 imul	 ecx, DWORD PTR _dwDot$[ebp]
  00255	c1 e9 18	 shr	 ecx, 24			; 00000018H
  00258	03 4d c8	 add	 ecx, DWORD PTR _dwAmbientG$[ebp]
  0025b	c1 e1 08	 shl	 ecx, 8
  0025e	0b c1		 or	 eax, ecx
  00260	8b 4d c4	 mov	 ecx, DWORD PTR _dwDiffuseB$[ebp]
  00263	0f af 4d e8	 imul	 ecx, DWORD PTR _dwDot$[ebp]
  00267	c1 e9 18	 shr	 ecx, 24			; 00000018H
  0026a	03 4d c0	 add	 ecx, DWORD PTR _dwAmbientB$[ebp]
  0026d	0b c1		 or	 eax, ecx
  0026f	6b 4d ec 1c	 imul	 ecx, DWORD PTR _uIndex$4[ebp], 28
  00273	8b 55 bc	 mov	 edx, DWORD PTR _akSrcVertex$[ebp]
  00276	89 44 0a 18	 mov	 DWORD PTR [edx+ecx+24], eax

; 163  : 			(((dwDiffuseR*dwDot>>S)+dwAmbientR)<<16)|
; 164  : 			(((dwDiffuseG*dwDot>>S)+dwAmbientG)<<8)|
; 165  : 			((dwDiffuseB*dwDot>>S)+dwAmbientB);
; 166  : 	}

  0027a	e9 15 ff ff ff	 jmp	 $LN2@SoftwareTr
$LN3@SoftwareTr:
$LN1@SoftwareTr:

; 167  : 
; 168  : }

  0027f	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00282	33 cd		 xor	 ecx, ebp
  00284	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00289	c9		 leave
  0028a	c2 0c 00	 ret	 12			; 0000000cH
?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatch@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z ENDP ; CTerrainPatch::SoftwareTransformPatch_UpdateTerrainLighting
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?GetWaterFaceCount@CTerrainPatch@@QAEIXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?GetWaterFaceCount@CTerrainPatch@@QAEIXZ PROC		; CTerrainPatch::GetWaterFaceCount, COMDAT
; _this$ = ecx

; 171  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 172  : 	return m_dwWaterPriCount;

  00007	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000a	8b 40 20	 mov	 eax, DWORD PTR [eax+32]

; 173  : }

  0000d	c9		 leave
  0000e	c3		 ret	 0
?GetWaterFaceCount@CTerrainPatch@@QAEIXZ ENDP		; CTerrainPatch::GetWaterFaceCount
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.h
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp
;	COMDAT ?Clear@CTerrainPatch@@QAEXXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?Clear@CTerrainPatch@@QAEXXZ PROC			; CTerrainPatch::Clear, COMDAT
; _this$ = ecx

; 44   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 45   : 	m_kHT.m_kVB.Destroy();

  00007	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0000a	83 c1 4c	 add	 ecx, 76			; 0000004cH
  0000d	e8 00 00 00 00	 call	 ?Destroy@CGraphicVertexBuffer@@QAEXXZ ; CGraphicVertexBuffer::Destroy

; 46   : 	m_kST.Destroy();

  00012	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00015	83 c1 6c	 add	 ecx, 108		; 0000006cH
  00018	e8 00 00 00 00	 call	 ?Destroy@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::Destroy

; 47   : 	
; 48   : 	m_WaterVertexBuffer.Destroy();

  0001d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00020	83 c1 24	 add	 ecx, 36			; 00000024H
  00023	e8 00 00 00 00	 call	 ?Destroy@CGraphicVertexBuffer@@QAEXXZ ; CGraphicVertexBuffer::Destroy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.h

; 88   : 	void SetID(DWORD dwID)									{ m_dwID = dwID; }

  00028	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0002b	83 48 1c ff	 or	 DWORD PTR [eax+28], -1

; 82   : 	void SetUse(bool bUse)									{ m_bUse = bUse; }

  0002f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00032	c6 40 18 00	 mov	 BYTE PTR [eax+24], 0
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\TerrainPatch.cpp

; 52   : 	m_bWaterExist = false;

  00036	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00039	c6 40 19 00	 mov	 BYTE PTR [eax+25], 0

; 53   : 	m_bNeedUpdate = true;

  0003d	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00040	c6 40 45 01	 mov	 BYTE PTR [eax+69], 1

; 54   : 
; 55   : 	m_dwWaterPriCount = 0;

  00044	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00047	83 60 20 00	 and	 DWORD PTR [eax+32], 0

; 56   : 	m_byType = PATCH_TYPE_PLAIN;

  0004b	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0004e	c6 40 44 00	 mov	 BYTE PTR [eax+68], 0

; 57   : 	
; 58   : 	m_fMinX = m_fMaxX = m_fMinY = m_fMaxY = m_fMinZ = m_fMaxZ = 0.0f;

  00052	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00055	0f 57 c0	 xorps	 xmm0, xmm0
  00058	f3 0f 11 40 14	 movss	 DWORD PTR [eax+20], xmm0
  0005d	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00060	0f 57 c0	 xorps	 xmm0, xmm0
  00063	f3 0f 11 40 10	 movss	 DWORD PTR [eax+16], xmm0
  00068	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0006b	0f 57 c0	 xorps	 xmm0, xmm0
  0006e	f3 0f 11 40 0c	 movss	 DWORD PTR [eax+12], xmm0
  00073	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00076	0f 57 c0	 xorps	 xmm0, xmm0
  00079	f3 0f 11 40 08	 movss	 DWORD PTR [eax+8], xmm0
  0007e	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00081	0f 57 c0	 xorps	 xmm0, xmm0
  00084	f3 0f 11 40 04	 movss	 DWORD PTR [eax+4], xmm0
  00089	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0008c	0f 57 c0	 xorps	 xmm0, xmm0
  0008f	f3 0f 11 00	 movss	 DWORD PTR [eax], xmm0

; 59   : 
; 60   : 	m_dwVersion=0;

  00093	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00096	83 60 48 00	 and	 DWORD PTR [eax+72], 0

; 61   : }

  0009a	c9		 leave
  0009b	c3		 ret	 0
?Clear@CTerrainPatch@@QAEXXZ ENDP			; CTerrainPatch::Clear
_TEXT	ENDS
; Function compile flags: /Odspy
;	COMDAT ??_H@YGXPAXIIP6EPAX0@Z@Z
_TEXT	SEGMENT
tv66 = -4						; size = 4
___t$ = 8						; size = 4
___s$ = 12						; size = 4
___n$ = 16						; size = 4
___f$ = 20						; size = 4
??_H@YGXPAXIIP6EPAX0@Z@Z PROC				; `vector constructor iterator', COMDAT
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
$LN2@vector:
  00004	8b 45 10	 mov	 eax, DWORD PTR ___n$[ebp]
  00007	89 45 fc	 mov	 DWORD PTR tv66[ebp], eax
  0000a	8b 45 10	 mov	 eax, DWORD PTR ___n$[ebp]
  0000d	48		 dec	 eax
  0000e	89 45 10	 mov	 DWORD PTR ___n$[ebp], eax
  00011	83 7d fc 00	 cmp	 DWORD PTR tv66[ebp], 0
  00015	76 11		 jbe	 SHORT $LN1@vector
  00017	8b 4d 08	 mov	 ecx, DWORD PTR ___t$[ebp]
  0001a	ff 55 14	 call	 DWORD PTR ___f$[ebp]
  0001d	8b 45 08	 mov	 eax, DWORD PTR ___t$[ebp]
  00020	03 45 0c	 add	 eax, DWORD PTR ___s$[ebp]
  00023	89 45 08	 mov	 DWORD PTR ___t$[ebp], eax
  00026	eb dc		 jmp	 SHORT $LN2@vector
$LN1@vector:
  00028	c9		 leave
  00029	c2 10 00	 ret	 16			; 00000010H
??_H@YGXPAXIIP6EPAX0@Z@Z ENDP				; `vector constructor iterator'
_TEXT	ENDS
END

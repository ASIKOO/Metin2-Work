; Listing generated by Microsoft (R) Optimizing Compiler Version 19.28.29335.0 

	TITLE	D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?dwLightEnable@@3KA				; dwLightEnable
_BSS	SEGMENT
?dwLightEnable@@3KA DD 01H DUP (?)			; dwLightEnable
_BSS	ENDS
PUBLIC	??_H@YGXPAXIIP6EPAX0@Z@Z			; `vector constructor iterator'
PUBLIC	?CreateCharacterShadowTexture@CMapOutdoor@@QAEXXZ ; CMapOutdoor::CreateCharacterShadowTexture
PUBLIC	?ReleaseCharacterShadowTexture@CMapOutdoor@@QAEXXZ ; CMapOutdoor::ReleaseCharacterShadowTexture
PUBLIC	?SetShadowTextureSize@CMapOutdoor@@QAEXG@Z	; CMapOutdoor::SetShadowTextureSize
PUBLIC	?BeginRenderCharacterShadowToTexture@CMapOutdoor@@QAE_NXZ ; CMapOutdoor::BeginRenderCharacterShadowToTexture
PUBLIC	?EndRenderCharacterShadowToTexture@CMapOutdoor@@QAEXXZ ; CMapOutdoor::EndRenderCharacterShadowToTexture
PUBLIC	?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
PUBLIC	?ms_singleton@?$CSingleton@VCCameraManager@@@@0PAVCCameraManager@@A ; CSingleton<CCameraManager>::ms_singleton
PUBLIC	??_C@_0CD@LDDALIJO@ShadowTextureSize?5changed?5?$CFd?5?9?$DO@ ; `string'
PUBLIC	??_C@_0EF@FIJKIKCP@CMapOutdoor?5Unable?5to?5create?5Ch@ ; `string'
PUBLIC	??_C@_0EO@LLLBCDDM@CMapOutdoor?5Unable?5to?5GetSurfac@ ; `string'
PUBLIC	??_C@_0DN@FOIDJBLJ@CMapOutdoor?5Unable?5to?5create?5Ch@ ; `string'
PUBLIC	??_C@_0FI@KOMMFBEO@CMapOutdoor?3?3BeginRenderCharact@ ; `string'
PUBLIC	??_C@_0FI@HJJEHOCK@CMapOutdoor?3?3BeginRenderCharact@ ; `string'
PUBLIC	??_C@_0FL@BICJPFM@CMapOutdoor?3?3BeginRenderCharact@ ; `string'
PUBLIC	??_C@_0FB@MDNNINIF@CMapOutdoor?3?3BeginRenderCharact@ ; `string'
PUBLIC	??_C@_0FD@NHMJOND@CMapOutdoor?3?3BeginRenderCharact@ ; `string'
PUBLIC	??_C@_0FG@DOCFFNBC@CMapOutdoor?3?3BeginRenderCharact@ ; `string'
PUBLIC	__real@3f800000
PUBLIC	__real@449c4000
PUBLIC	__real@45075000
PUBLIC	__real@451f6000
PUBLIC	__real@45875000
PUBLIC	__real@466a6000
EXTRN	_D3DXMatrixLookAtRH@16:PROC
EXTRN	_D3DXMatrixOrthoRH@20:PROC
EXTRN	?Tracenf@@YAXPBDZZ:PROC				; Tracenf
EXTRN	?TraceError@@YAXPBDZZ:PROC			; TraceError
EXTRN	?IsLowTextureMemory@CGraphicBase@@SA_NXZ:PROC	; CGraphicBase::IsLowTextureMemory
EXTRN	?SaveRenderState@CStateManager@@QAEXW4_D3DRENDERSTATETYPE@@K@Z:PROC ; CStateManager::SaveRenderState
EXTRN	?RestoreRenderState@CStateManager@@QAEXW4_D3DRENDERSTATETYPE@@@Z:PROC ; CStateManager::RestoreRenderState
EXTRN	?SetRenderState@CStateManager@@QAEXW4_D3DRENDERSTATETYPE@@K@Z:PROC ; CStateManager::SetRenderState
EXTRN	?SetTextureStageState@CStateManager@@QAEXKW4_D3DTEXTURESTAGESTATETYPE@@K@Z:PROC ; CStateManager::SetTextureStageState
EXTRN	?SaveTransform@CStateManager@@QAEXW4_D3DTRANSFORMSTATETYPE@@PBU_D3DMATRIX@@@Z:PROC ; CStateManager::SaveTransform
EXTRN	?RestoreTransform@CStateManager@@QAEXW4_D3DTRANSFORMSTATETYPE@@@Z:PROC ; CStateManager::RestoreTransform
EXTRN	?GetRenderState@CStateManager@@QAEKW4_D3DRENDERSTATETYPE@@@Z:PROC ; CStateManager::GetRenderState
EXTRN	?GetCurrentCamera@CCameraManager@@QAEPAVCCamera@@XZ:PROC ; CCameraManager::GetCurrentCamera
EXTRN	@__security_check_cookie@4:PROC
EXTRN	?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A:DWORD ; CGraphicBase::ms_lpd3dDevice
EXTRN	?GRAPHICS_CAPS_CAN_NOT_DRAW_SHADOW@@3_NA:BYTE	; GRAPHICS_CAPS_CAN_NOT_DRAW_SHADOW
EXTRN	___security_cookie:DWORD
EXTRN	__fltused:DWORD
;	COMDAT ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A
_BSS	SEGMENT
?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A DD 01H DUP (?) ; CSingleton<CStateManager>::ms_singleton
_BSS	ENDS
;	COMDAT ?ms_singleton@?$CSingleton@VCCameraManager@@@@0PAVCCameraManager@@A
_BSS	SEGMENT
?ms_singleton@?$CSingleton@VCCameraManager@@@@0PAVCCameraManager@@A DD 01H DUP (?) ; CSingleton<CCameraManager>::ms_singleton
_BSS	ENDS
_BSS	SEGMENT
?recreate@@3HA DD 01H DUP (?)				; recreate
_BSS	ENDS
;	COMDAT __real@466a6000
CONST	SEGMENT
__real@466a6000 DD 0466a6000r			; 15000
CONST	ENDS
;	COMDAT __real@45875000
CONST	SEGMENT
__real@45875000 DD 045875000r			; 4330
CONST	ENDS
;	COMDAT __real@451f6000
CONST	SEGMENT
__real@451f6000 DD 0451f6000r			; 2550
CONST	ENDS
;	COMDAT __real@45075000
CONST	SEGMENT
__real@45075000 DD 045075000r			; 2165
CONST	ENDS
;	COMDAT __real@449c4000
CONST	SEGMENT
__real@449c4000 DD 0449c4000r			; 1250
CONST	ENDS
;	COMDAT __real@3f800000
CONST	SEGMENT
__real@3f800000 DD 03f800000r			; 1
CONST	ENDS
;	COMDAT ??_C@_0FG@DOCFFNBC@CMapOutdoor?3?3BeginRenderCharact@
CONST	SEGMENT
??_C@_0FG@DOCFFNBC@CMapOutdoor?3?3BeginRenderCharact@ DB 'CMapOutdoor::Be'
	DB	'ginRenderCharacterShadowToTexture : Unable to Set Shadow Map '
	DB	'viewport', 0aH, 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0FD@NHMJOND@CMapOutdoor?3?3BeginRenderCharact@
CONST	SEGMENT
??_C@_0FD@NHMJOND@CMapOutdoor?3?3BeginRenderCharact@ DB 'CMapOutdoor::Beg'
	DB	'inRenderCharacterShadowToTexture : Unable to Save Window View'
	DB	'port', 0aH, 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0FB@MDNNINIF@CMapOutdoor?3?3BeginRenderCharact@
CONST	SEGMENT
??_C@_0FB@MDNNINIF@CMapOutdoor?3?3BeginRenderCharact@ DB 'CMapOutdoor::Be'
	DB	'ginRenderCharacterShadowToTexture : Unable to Clear Render Ta'
	DB	'rget', 00H					; `string'
CONST	ENDS
;	COMDAT ??_C@_0FL@BICJPFM@CMapOutdoor?3?3BeginRenderCharact@
CONST	SEGMENT
??_C@_0FL@BICJPFM@CMapOutdoor?3?3BeginRenderCharact@ DB 'CMapOutdoor::Beg'
	DB	'inRenderCharacterShadowToTexture : Unable to Set Shadow Map R'
	DB	'ender Target', 0aH, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0FI@HJJEHOCK@CMapOutdoor?3?3BeginRenderCharact@
CONST	SEGMENT
??_C@_0FI@HJJEHOCK@CMapOutdoor?3?3BeginRenderCharact@ DB 'CMapOutdoor::Be'
	DB	'ginRenderCharacterShadowToTexture : Unable to Save Window Dep'
	DB	'th Surface', 0aH, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0FI@KOMMFBEO@CMapOutdoor?3?3BeginRenderCharact@
CONST	SEGMENT
??_C@_0FI@KOMMFBEO@CMapOutdoor?3?3BeginRenderCharact@ DB 'CMapOutdoor::Be'
	DB	'ginRenderCharacterShadowToTexture : Unable to Save Window Ren'
	DB	'der Target', 0aH, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0DN@FOIDJBLJ@CMapOutdoor?5Unable?5to?5create?5Ch@
CONST	SEGMENT
??_C@_0DN@FOIDJBLJ@CMapOutdoor?5Unable?5to?5create?5Ch@ DB 'CMapOutdoor U'
	DB	'nable to create Character Shadow depth Surface', 0aH, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0EO@LLLBCDDM@CMapOutdoor?5Unable?5to?5GetSurfac@
CONST	SEGMENT
??_C@_0EO@LLLBCDDM@CMapOutdoor?5Unable?5to?5GetSurfac@ DB 'CMapOutdoor Un'
	DB	'able to GetSurfaceLevel Character Shadow render target textur'
	DB	'e', 0aH, 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0EF@FIJKIKCP@CMapOutdoor?5Unable?5to?5create?5Ch@
CONST	SEGMENT
??_C@_0EF@FIJKIKCP@CMapOutdoor?5Unable?5to?5create?5Ch@ DB 'CMapOutdoor U'
	DB	'nable to create Character Shadow render target texture', 0aH, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0CD@LDDALIJO@ShadowTextureSize?5changed?5?$CFd?5?9?$DO@
CONST	SEGMENT
??_C@_0CD@LDDALIJO@ShadowTextureSize?5changed?5?$CFd?5?9?$DO@ DB 'ShadowT'
	DB	'extureSize changed %d -> %d', 00H		; `string'
CONST	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp
;	COMDAT ?EndRenderCharacterShadowToTexture@CMapOutdoor@@QAEXXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?EndRenderCharacterShadowToTexture@CMapOutdoor@@QAEXXZ PROC ; CMapOutdoor::EndRenderCharacterShadowToTexture, COMDAT
; _this$ = ecx

; 150  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 151  : 	ms_lpd3dDevice->SetViewport(&m_BackupViewport);

  00007	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000a	05 04 02 00 00	 add	 eax, 516		; 00000204H
  0000f	50		 push	 eax
  00010	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  00015	8b 00		 mov	 eax, DWORD PTR [eax]
  00017	ff 35 00 00 00
	00		 push	 DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  0001d	ff 90 a0 00 00
	00		 call	 DWORD PTR [eax+160]

; 152  : 
; 153  : 	ms_lpd3dDevice->SetRenderTarget(m_lpBackupRenderTargetSurface, m_lpBackupDepthSurface);

  00023	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00026	ff b0 00 02 00
	00		 push	 DWORD PTR [eax+512]
  0002c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0002f	ff b0 fc 01 00
	00		 push	 DWORD PTR [eax+508]
  00035	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  0003a	8b 00		 mov	 eax, DWORD PTR [eax]
  0003c	ff 35 00 00 00
	00		 push	 DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  00042	ff 50 7c	 call	 DWORD PTR [eax+124]

; 154  : 
; 155  : 	SAFE_RELEASE(m_lpBackupRenderTargetSurface);

  00045	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00048	83 b8 fc 01 00
	00 00		 cmp	 DWORD PTR [eax+508], 0
  0004f	74 21		 je	 SHORT $LN2@EndRenderC
  00051	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00054	8b 80 fc 01 00
	00		 mov	 eax, DWORD PTR [eax+508]
  0005a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0005d	8b 00		 mov	 eax, DWORD PTR [eax]
  0005f	ff b1 fc 01 00
	00		 push	 DWORD PTR [ecx+508]
  00065	ff 50 08	 call	 DWORD PTR [eax+8]
  00068	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0006b	83 a0 fc 01 00
	00 00		 and	 DWORD PTR [eax+508], 0
$LN2@EndRenderC:

; 156  : 	SAFE_RELEASE(m_lpBackupDepthSurface);

  00072	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00075	83 b8 00 02 00
	00 00		 cmp	 DWORD PTR [eax+512], 0
  0007c	74 21		 je	 SHORT $LN5@EndRenderC
  0007e	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00081	8b 80 00 02 00
	00		 mov	 eax, DWORD PTR [eax+512]
  00087	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0008a	8b 00		 mov	 eax, DWORD PTR [eax]
  0008c	ff b1 00 02 00
	00		 push	 DWORD PTR [ecx+512]
  00092	ff 50 08	 call	 DWORD PTR [eax+8]
  00095	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00098	83 a0 00 02 00
	00 00		 and	 DWORD PTR [eax+512], 0
$LN5@EndRenderC:

; 157  : 
; 158  : 	STATEMANAGER.RestoreTransform(D3DTS_VIEW);

  0009f	6a 02		 push	 2
  000a1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  000a7	e8 00 00 00 00	 call	 ?RestoreTransform@CStateManager@@QAEXW4_D3DTRANSFORMSTATETYPE@@@Z ; CStateManager::RestoreTransform

; 159  : 	STATEMANAGER.RestoreTransform(D3DTS_PROJECTION);

  000ac	6a 03		 push	 3
  000ae	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  000b4	e8 00 00 00 00	 call	 ?RestoreTransform@CStateManager@@QAEXW4_D3DTRANSFORMSTATETYPE@@@Z ; CStateManager::RestoreTransform

; 160  : 
; 161  : 	// Restore Device Context
; 162  : 	STATEMANAGER.SetRenderState(D3DRS_LIGHTING, dwLightEnable);

  000b9	ff 35 00 00 00
	00		 push	 DWORD PTR ?dwLightEnable@@3KA ; dwLightEnable
  000bf	68 89 00 00 00	 push	 137			; 00000089H
  000c4	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  000ca	e8 00 00 00 00	 call	 ?SetRenderState@CStateManager@@QAEXW4_D3DRENDERSTATETYPE@@K@Z ; CStateManager::SetRenderState

; 163  : 	STATEMANAGER.RestoreRenderState(D3DRS_TEXTUREFACTOR);

  000cf	6a 3c		 push	 60			; 0000003cH
  000d1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  000d7	e8 00 00 00 00	 call	 ?RestoreRenderState@CStateManager@@QAEXW4_D3DRENDERSTATETYPE@@@Z ; CStateManager::RestoreRenderState

; 164  : }

  000dc	c9		 leave
  000dd	c3		 ret	 0
?EndRenderCharacterShadowToTexture@CMapOutdoor@@QAEXXZ ENDP ; CMapOutdoor::EndRenderCharacterShadowToTexture
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterBase\Singleton.h
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterlib\Camera.h
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\M2Data\include\d3dx8math.inl
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterBase\Singleton.h
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp
;	COMDAT ?BeginRenderCharacterShadowToTexture@CMapOutdoor@@QAE_NXZ
_TEXT	SEGMENT
$T1 = -80						; size = 4
_fz$ = -76						; size = 4
_fy$ = -72						; size = 4
_fx$ = -68						; size = 4
$T2 = -64						; size = 4
_pCurrentCamera$ = -60					; size = 4
_this$ = -56						; size = 4
_bSuccess$ = -49					; size = 1
_matLightProj$ = -48					; size = 64
_matLightView$ = 16					; size = 64
_v3Eye$ = 80						; size = 12
$T3 = 92						; size = 12
_v3Target$ = 104					; size = 12
__$ArrayPad$ = 116					; size = 4
?BeginRenderCharacterShadowToTexture@CMapOutdoor@@QAE_NXZ PROC ; CMapOutdoor::BeginRenderCharacterShadowToTexture, COMDAT
; _this$ = ecx

; 68   : {

  00000	55		 push	 ebp
  00001	8d 6c 24 88	 lea	 ebp, DWORD PTR [esp-120]
  00005	81 ec c8 00 00
	00		 sub	 esp, 200		; 000000c8H
  0000b	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00010	33 c5		 xor	 eax, ebp
  00012	89 45 74	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00015	56		 push	 esi
  00016	57		 push	 edi
  00017	89 4d c8	 mov	 DWORD PTR _this$[ebp], ecx
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterBase\Singleton.h

; 27   : 		return (*ms_singleton);

  0001a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_singleton@?$CSingleton@VCCameraManager@@@@0PAVCCameraManager@@A ; CSingleton<CCameraManager>::ms_singleton
  0001f	89 45 c0	 mov	 DWORD PTR $T2[ebp], eax
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp

; 71   : 	CCamera* pCurrentCamera = CCameraManager::Instance().GetCurrentCamera();

  00022	8b 4d c0	 mov	 ecx, DWORD PTR $T2[ebp]
  00025	e8 00 00 00 00	 call	 ?GetCurrentCamera@CCameraManager@@QAEPAVCCamera@@XZ ; CCameraManager::GetCurrentCamera
  0002a	89 45 c4	 mov	 DWORD PTR _pCurrentCamera$[ebp], eax

; 72   : 
; 73   : 	if (!pCurrentCamera)

  0002d	83 7d c4 00	 cmp	 DWORD PTR _pCurrentCamera$[ebp], 0
  00031	75 07		 jne	 SHORT $LN2@BeginRende

; 74   : 		return false;

  00033	32 c0		 xor	 al, al
  00035	e9 c5 02 00 00	 jmp	 $LN1@BeginRende
$LN2@BeginRende:

; 75   : 
; 76   : 	if (recreate)

  0003a	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?recreate@@3HA, 0
  00041	74 0f		 je	 SHORT $LN3@BeginRende

; 77   : 	{
; 78   : 		CreateCharacterShadowTexture();

  00043	8b 4d c8	 mov	 ecx, DWORD PTR _this$[ebp]
  00046	e8 00 00 00 00	 call	 ?CreateCharacterShadowTexture@CMapOutdoor@@QAEXXZ ; CMapOutdoor::CreateCharacterShadowTexture

; 79   : 		recreate = false;

  0004b	83 25 00 00 00
	00 00		 and	 DWORD PTR ?recreate@@3HA, 0
$LN3@BeginRende:
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterlib\Camera.h

; 169  : 		const D3DXVECTOR3 & GetTarget() const	{ return m_v3Target; }

  00052	8b 75 c4	 mov	 esi, DWORD PTR _pCurrentCamera$[ebp]
  00055	83 c6 3c	 add	 esi, 60			; 0000003cH
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp

; 82   : 	D3DXVECTOR3 v3Target = pCurrentCamera->GetTarget();

  00058	8d 7d 68	 lea	 edi, DWORD PTR _v3Target$[ebp]
  0005b	a5		 movsd
  0005c	a5		 movsd
  0005d	a5		 movsd

; 83   : 	
; 84   : 	D3DXVECTOR3 v3Eye(v3Target.x - 1.732f * 1250.0f,

  0005e	f3 0f 10 45 68	 movss	 xmm0, DWORD PTR _v3Target$[ebp]
  00063	f3 0f 5c 05 00
	00 00 00	 subss	 xmm0, DWORD PTR __real@45075000
  0006b	f3 0f 11 45 bc	 movss	 DWORD PTR _fx$[ebp], xmm0
  00070	f3 0f 10 45 6c	 movss	 xmm0, DWORD PTR _v3Target$[ebp+4]
  00075	f3 0f 5c 05 00
	00 00 00	 subss	 xmm0, DWORD PTR __real@449c4000
  0007d	f3 0f 11 45 b8	 movss	 DWORD PTR _fy$[ebp], xmm0
  00082	f3 0f 10 45 70	 movss	 xmm0, DWORD PTR _v3Target$[ebp+8]
  00087	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR __real@45875000
  0008f	f3 0f 11 45 b4	 movss	 DWORD PTR _fz$[ebp], xmm0
; File D:\Metin2 Server Files\mainline\SRC_2014\M2Data\include\d3dx8math.inl

; 180  :     x = fx;

  00094	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _fx$[ebp]
  00099	f3 0f 11 45 50	 movss	 DWORD PTR _v3Eye$[ebp], xmm0

; 181  :     y = fy;

  0009e	f3 0f 10 45 b8	 movss	 xmm0, DWORD PTR _fy$[ebp]
  000a3	f3 0f 11 45 54	 movss	 DWORD PTR _v3Eye$[ebp+4], xmm0

; 182  :     z = fz;

  000a8	f3 0f 10 45 b4	 movss	 xmm0, DWORD PTR _fz$[ebp]
  000ad	f3 0f 11 45 58	 movss	 DWORD PTR _v3Eye$[ebp+8], xmm0

; 180  :     x = fx;

  000b2	0f 57 c0	 xorps	 xmm0, xmm0
  000b5	f3 0f 11 45 5c	 movss	 DWORD PTR $T3[ebp], xmm0

; 181  :     y = fy;

  000ba	0f 57 c0	 xorps	 xmm0, xmm0
  000bd	f3 0f 11 45 60	 movss	 DWORD PTR $T3[ebp+4], xmm0

; 182  :     z = fz;

  000c2	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  000ca	f3 0f 11 45 64	 movss	 DWORD PTR $T3[ebp+8], xmm0
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp

; 88   : 	D3DXMatrixLookAtRH(&matLightView,

  000cf	8d 45 5c	 lea	 eax, DWORD PTR $T3[ebp]
  000d2	50		 push	 eax
  000d3	8d 45 68	 lea	 eax, DWORD PTR _v3Target$[ebp]
  000d6	50		 push	 eax
  000d7	8d 45 50	 lea	 eax, DWORD PTR _v3Eye$[ebp]
  000da	50		 push	 eax
  000db	8d 45 10	 lea	 eax, DWORD PTR _matLightView$[ebp]
  000de	50		 push	 eax
  000df	e8 00 00 00 00	 call	 _D3DXMatrixLookAtRH@16

; 89   : 					   &v3Eye,
; 90   : 					   &v3Target,
; 91   : 					   &D3DXVECTOR3(0.0f, 0.0f, 1.0f));
; 92   : 	
; 93   : 	D3DXMatrixOrthoRH(&matLightProj, 2550.0f, 2550.0f, 1.0f, 15000.0f);

  000e4	51		 push	 ecx
  000e5	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@466a6000
  000ed	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  000f2	51		 push	 ecx
  000f3	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  000fb	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00100	51		 push	 ecx
  00101	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@451f6000
  00109	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0010e	51		 push	 ecx
  0010f	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@451f6000
  00117	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0011c	8d 45 d0	 lea	 eax, DWORD PTR _matLightProj$[ebp]
  0011f	50		 push	 eax
  00120	e8 00 00 00 00	 call	 _D3DXMatrixOrthoRH@20

; 94   : 
; 95   : 	STATEMANAGER.SaveTransform(D3DTS_VIEW, &matLightView);

  00125	8d 45 10	 lea	 eax, DWORD PTR _matLightView$[ebp]
  00128	50		 push	 eax
  00129	6a 02		 push	 2
  0012b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  00131	e8 00 00 00 00	 call	 ?SaveTransform@CStateManager@@QAEXW4_D3DTRANSFORMSTATETYPE@@PBU_D3DMATRIX@@@Z ; CStateManager::SaveTransform

; 96   : 	STATEMANAGER.SaveTransform(D3DTS_PROJECTION, &matLightProj);

  00136	8d 45 d0	 lea	 eax, DWORD PTR _matLightProj$[ebp]
  00139	50		 push	 eax
  0013a	6a 03		 push	 3
  0013c	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  00142	e8 00 00 00 00	 call	 ?SaveTransform@CStateManager@@QAEXW4_D3DTRANSFORMSTATETYPE@@PBU_D3DMATRIX@@@Z ; CStateManager::SaveTransform
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterBase\Singleton.h

; 27   : 		return (*ms_singleton);

  00147	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  0014c	89 45 b0	 mov	 DWORD PTR $T1[ebp], eax
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp

; 98   : 	dwLightEnable = STATEMANAGER.GetRenderState(D3DRS_LIGHTING);

  0014f	68 89 00 00 00	 push	 137			; 00000089H
  00154	8b 4d b0	 mov	 ecx, DWORD PTR $T1[ebp]
  00157	e8 00 00 00 00	 call	 ?GetRenderState@CStateManager@@QAEKW4_D3DRENDERSTATETYPE@@@Z ; CStateManager::GetRenderState
  0015c	a3 00 00 00 00	 mov	 DWORD PTR ?dwLightEnable@@3KA, eax ; dwLightEnable

; 99   : 	STATEMANAGER.SetRenderState(D3DRS_LIGHTING, FALSE);

  00161	6a 00		 push	 0
  00163	68 89 00 00 00	 push	 137			; 00000089H
  00168	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  0016e	e8 00 00 00 00	 call	 ?SetRenderState@CStateManager@@QAEXW4_D3DRENDERSTATETYPE@@K@Z ; CStateManager::SetRenderState

; 100  : 	
; 101  : 	STATEMANAGER.SaveRenderState(D3DRS_TEXTUREFACTOR, 0xFF808080);

  00173	68 80 80 80 ff	 push	 -8355712		; ff808080H
  00178	6a 3c		 push	 60			; 0000003cH
  0017a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  00180	e8 00 00 00 00	 call	 ?SaveRenderState@CStateManager@@QAEXW4_D3DRENDERSTATETYPE@@K@Z ; CStateManager::SaveRenderState

; 102  : 	STATEMANAGER.SetTextureStageState(0, D3DTSS_COLOROP, D3DTOP_SELECTARG1);

  00185	6a 02		 push	 2
  00187	6a 01		 push	 1
  00189	6a 00		 push	 0
  0018b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  00191	e8 00 00 00 00	 call	 ?SetTextureStageState@CStateManager@@QAEXKW4_D3DTEXTURESTAGESTATETYPE@@K@Z ; CStateManager::SetTextureStageState

; 103  : 	STATEMANAGER.SetTextureStageState(0, D3DTSS_COLORARG1, D3DTA_TFACTOR);

  00196	6a 03		 push	 3
  00198	6a 02		 push	 2
  0019a	6a 00		 push	 0
  0019c	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  001a2	e8 00 00 00 00	 call	 ?SetTextureStageState@CStateManager@@QAEXKW4_D3DTEXTURESTAGESTATETYPE@@K@Z ; CStateManager::SetTextureStageState

; 104  : 	STATEMANAGER.SetTextureStageState(0, D3DTSS_ALPHAOP, D3DTOP_DISABLE);

  001a7	6a 01		 push	 1
  001a9	6a 04		 push	 4
  001ab	6a 00		 push	 0
  001ad	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  001b3	e8 00 00 00 00	 call	 ?SetTextureStageState@CStateManager@@QAEXKW4_D3DTEXTURESTAGESTATETYPE@@K@Z ; CStateManager::SetTextureStageState

; 105  : 	STATEMANAGER.SetTextureStageState(1, D3DTSS_COLOROP, D3DTOP_DISABLE);

  001b8	6a 01		 push	 1
  001ba	6a 01		 push	 1
  001bc	6a 01		 push	 1
  001be	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCStateManager@@@@0PAVCStateManager@@A ; CSingleton<CStateManager>::ms_singleton
  001c4	e8 00 00 00 00	 call	 ?SetTextureStageState@CStateManager@@QAEXKW4_D3DTEXTURESTAGESTATETYPE@@K@Z ; CStateManager::SetTextureStageState

; 106  : 	
; 107  : 	bool bSuccess = true;

  001c9	c6 45 cf 01	 mov	 BYTE PTR _bSuccess$[ebp], 1

; 108  : 
; 109  : 	// Backup Device Context
; 110  : 	if (FAILED(ms_lpd3dDevice->GetRenderTarget(&m_lpBackupRenderTargetSurface)))

  001cd	8b 45 c8	 mov	 eax, DWORD PTR _this$[ebp]
  001d0	05 fc 01 00 00	 add	 eax, 508		; 000001fcH
  001d5	50		 push	 eax
  001d6	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  001db	8b 00		 mov	 eax, DWORD PTR [eax]
  001dd	ff 35 00 00 00
	00		 push	 DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  001e3	ff 90 80 00 00
	00		 call	 DWORD PTR [eax+128]
  001e9	85 c0		 test	 eax, eax
  001eb	7d 0f		 jge	 SHORT $LN4@BeginRende

; 111  : 	{
; 112  : 		TraceError("CMapOutdoor::BeginRenderCharacterShadowToTexture : Unable to Save Window Render Target\n");

  001ed	68 00 00 00 00	 push	 OFFSET ??_C@_0FI@KOMMFBEO@CMapOutdoor?3?3BeginRenderCharact@
  001f2	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  001f7	59		 pop	 ecx

; 113  : 		bSuccess = false;

  001f8	c6 45 cf 00	 mov	 BYTE PTR _bSuccess$[ebp], 0
$LN4@BeginRende:

; 114  : 	}
; 115  : 	
; 116  : 	if (FAILED(ms_lpd3dDevice->GetDepthStencilSurface(&m_lpBackupDepthSurface)))

  001fc	8b 45 c8	 mov	 eax, DWORD PTR _this$[ebp]
  001ff	05 00 02 00 00	 add	 eax, 512		; 00000200H
  00204	50		 push	 eax
  00205	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  0020a	8b 00		 mov	 eax, DWORD PTR [eax]
  0020c	ff 35 00 00 00
	00		 push	 DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  00212	ff 90 84 00 00
	00		 call	 DWORD PTR [eax+132]
  00218	85 c0		 test	 eax, eax
  0021a	7d 0f		 jge	 SHORT $LN5@BeginRende

; 117  : 	{
; 118  : 		TraceError("CMapOutdoor::BeginRenderCharacterShadowToTexture : Unable to Save Window Depth Surface\n");

  0021c	68 00 00 00 00	 push	 OFFSET ??_C@_0FI@HJJEHOCK@CMapOutdoor?3?3BeginRenderCharact@
  00221	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  00226	59		 pop	 ecx

; 119  : 		bSuccess = false;

  00227	c6 45 cf 00	 mov	 BYTE PTR _bSuccess$[ebp], 0
$LN5@BeginRende:

; 120  : 	}
; 121  : 	
; 122  : 	if (FAILED(ms_lpd3dDevice->SetRenderTarget(m_lpCharacterShadowMapRenderTargetSurface, m_lpCharacterShadowMapDepthSurface)))

  0022b	8b 45 c8	 mov	 eax, DWORD PTR _this$[ebp]
  0022e	ff b0 dc 01 00
	00		 push	 DWORD PTR [eax+476]
  00234	8b 45 c8	 mov	 eax, DWORD PTR _this$[ebp]
  00237	ff b0 d8 01 00
	00		 push	 DWORD PTR [eax+472]
  0023d	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  00242	8b 00		 mov	 eax, DWORD PTR [eax]
  00244	ff 35 00 00 00
	00		 push	 DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  0024a	ff 50 7c	 call	 DWORD PTR [eax+124]
  0024d	85 c0		 test	 eax, eax
  0024f	7d 0f		 jge	 SHORT $LN6@BeginRende

; 123  : 	{
; 124  : 		TraceError("CMapOutdoor::BeginRenderCharacterShadowToTexture : Unable to Set Shadow Map Render Target\n");

  00251	68 00 00 00 00	 push	 OFFSET ??_C@_0FL@BICJPFM@CMapOutdoor?3?3BeginRenderCharact@
  00256	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  0025b	59		 pop	 ecx

; 125  : 		bSuccess = false;

  0025c	c6 45 cf 00	 mov	 BYTE PTR _bSuccess$[ebp], 0
$LN6@BeginRende:

; 126  : 	}
; 127  : 	
; 128  : 	if (FAILED(ms_lpd3dDevice->Clear(0L, NULL, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, D3DCOLOR_XRGB(0xFF, 0xFF, 0xFF), 1.0f, 0)))

  00260	6a 00		 push	 0
  00262	51		 push	 ecx
  00263	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  0026b	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00270	6a ff		 push	 -1
  00272	6a 03		 push	 3
  00274	6a 00		 push	 0
  00276	6a 00		 push	 0
  00278	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  0027d	8b 00		 mov	 eax, DWORD PTR [eax]
  0027f	ff 35 00 00 00
	00		 push	 DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  00285	ff 90 90 00 00
	00		 call	 DWORD PTR [eax+144]
  0028b	85 c0		 test	 eax, eax
  0028d	7d 0f		 jge	 SHORT $LN7@BeginRende

; 129  : 	{
; 130  : 		TraceError("CMapOutdoor::BeginRenderCharacterShadowToTexture : Unable to Clear Render Target");

  0028f	68 00 00 00 00	 push	 OFFSET ??_C@_0FB@MDNNINIF@CMapOutdoor?3?3BeginRenderCharact@
  00294	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  00299	59		 pop	 ecx

; 131  : 		bSuccess = false;

  0029a	c6 45 cf 00	 mov	 BYTE PTR _bSuccess$[ebp], 0
$LN7@BeginRende:

; 132  : 	}
; 133  : 	
; 134  : 	if (FAILED(ms_lpd3dDevice->GetViewport(&m_BackupViewport)))

  0029e	8b 45 c8	 mov	 eax, DWORD PTR _this$[ebp]
  002a1	05 04 02 00 00	 add	 eax, 516		; 00000204H
  002a6	50		 push	 eax
  002a7	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  002ac	8b 00		 mov	 eax, DWORD PTR [eax]
  002ae	ff 35 00 00 00
	00		 push	 DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  002b4	ff 90 a4 00 00
	00		 call	 DWORD PTR [eax+164]
  002ba	85 c0		 test	 eax, eax
  002bc	7d 0f		 jge	 SHORT $LN8@BeginRende

; 135  : 	{
; 136  : 		TraceError("CMapOutdoor::BeginRenderCharacterShadowToTexture : Unable to Save Window Viewport\n");

  002be	68 00 00 00 00	 push	 OFFSET ??_C@_0FD@NHMJOND@CMapOutdoor?3?3BeginRenderCharact@
  002c3	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  002c8	59		 pop	 ecx

; 137  : 		bSuccess = false;

  002c9	c6 45 cf 00	 mov	 BYTE PTR _bSuccess$[ebp], 0
$LN8@BeginRende:

; 138  : 	}
; 139  : 	
; 140  : 	if (FAILED(ms_lpd3dDevice->SetViewport(&m_ShadowMapViewport)))

  002cd	8b 45 c8	 mov	 eax, DWORD PTR _this$[ebp]
  002d0	05 e0 01 00 00	 add	 eax, 480		; 000001e0H
  002d5	50		 push	 eax
  002d6	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  002db	8b 00		 mov	 eax, DWORD PTR [eax]
  002dd	ff 35 00 00 00
	00		 push	 DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  002e3	ff 90 a0 00 00
	00		 call	 DWORD PTR [eax+160]
  002e9	85 c0		 test	 eax, eax
  002eb	7d 0f		 jge	 SHORT $LN9@BeginRende

; 141  : 	{
; 142  : 		TraceError("CMapOutdoor::BeginRenderCharacterShadowToTexture : Unable to Set Shadow Map viewport\n");

  002ed	68 00 00 00 00	 push	 OFFSET ??_C@_0FG@DOCFFNBC@CMapOutdoor?3?3BeginRenderCharact@
  002f2	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  002f7	59		 pop	 ecx

; 143  : 		bSuccess = false;

  002f8	c6 45 cf 00	 mov	 BYTE PTR _bSuccess$[ebp], 0
$LN9@BeginRende:

; 144  : 	}
; 145  : 	
; 146  : 	return bSuccess;

  002fc	8a 45 cf	 mov	 al, BYTE PTR _bSuccess$[ebp]
$LN1@BeginRende:

; 147  : }

  002ff	5f		 pop	 edi
  00300	5e		 pop	 esi
  00301	8b 4d 74	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00304	33 cd		 xor	 ecx, ebp
  00306	e8 00 00 00 00	 call	 @__security_check_cookie@4
  0030b	83 c5 78	 add	 ebp, 120		; 00000078H
  0030e	c9		 leave
  0030f	c3		 ret	 0
?BeginRenderCharacterShadowToTexture@CMapOutdoor@@QAE_NXZ ENDP ; CMapOutdoor::BeginRenderCharacterShadowToTexture
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp
;	COMDAT ?SetShadowTextureSize@CMapOutdoor@@QAEXG@Z
_TEXT	SEGMENT
_this$ = -4						; size = 4
_size$ = 8						; size = 2
?SetShadowTextureSize@CMapOutdoor@@QAEXG@Z PROC		; CMapOutdoor::SetShadowTextureSize, COMDAT
; _this$ = ecx

; 10   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 11   : 	if (m_wShadowMapSize != size)

  00007	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000a	0f b7 80 f8 01
	00 00		 movzx	 eax, WORD PTR [eax+504]
  00011	0f b7 4d 08	 movzx	 ecx, WORD PTR _size$[ebp]
  00015	3b c1		 cmp	 eax, ecx
  00017	74 27		 je	 SHORT $LN2@SetShadowT

; 12   : 	{
; 13   : 		recreate = true;

  00019	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?recreate@@3HA, 1

; 14   : 		Tracenf("ShadowTextureSize changed %d -> %d", m_wShadowMapSize, size);

  00023	0f b7 45 08	 movzx	 eax, WORD PTR _size$[ebp]
  00027	50		 push	 eax
  00028	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0002b	0f b7 80 f8 01
	00 00		 movzx	 eax, WORD PTR [eax+504]
  00032	50		 push	 eax
  00033	68 00 00 00 00	 push	 OFFSET ??_C@_0CD@LDDALIJO@ShadowTextureSize?5changed?5?$CFd?5?9?$DO@
  00038	e8 00 00 00 00	 call	 ?Tracenf@@YAXPBDZZ	; Tracenf
  0003d	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN2@SetShadowT:

; 15   : 	}
; 16   : 
; 17   : 	m_wShadowMapSize = size;

  00040	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00043	66 8b 4d 08	 mov	 cx, WORD PTR _size$[ebp]
  00047	66 89 88 f8 01
	00 00		 mov	 WORD PTR [eax+504], cx

; 18   : }

  0004e	c9		 leave
  0004f	c2 04 00	 ret	 4
?SetShadowTextureSize@CMapOutdoor@@QAEXG@Z ENDP		; CMapOutdoor::SetShadowTextureSize
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp
;	COMDAT ?ReleaseCharacterShadowTexture@CMapOutdoor@@QAEXXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?ReleaseCharacterShadowTexture@CMapOutdoor@@QAEXXZ PROC	; CMapOutdoor::ReleaseCharacterShadowTexture, COMDAT
; _this$ = ecx

; 59   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 60   : 	SAFE_RELEASE(m_lpCharacterShadowMapRenderTargetSurface);

  00007	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000a	83 b8 d8 01 00
	00 00		 cmp	 DWORD PTR [eax+472], 0
  00011	74 21		 je	 SHORT $LN2@ReleaseCha
  00013	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00016	8b 80 d8 01 00
	00		 mov	 eax, DWORD PTR [eax+472]
  0001c	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0001f	8b 00		 mov	 eax, DWORD PTR [eax]
  00021	ff b1 d8 01 00
	00		 push	 DWORD PTR [ecx+472]
  00027	ff 50 08	 call	 DWORD PTR [eax+8]
  0002a	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0002d	83 a0 d8 01 00
	00 00		 and	 DWORD PTR [eax+472], 0
$LN2@ReleaseCha:

; 61   : 	SAFE_RELEASE(m_lpCharacterShadowMapDepthSurface);

  00034	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00037	83 b8 dc 01 00
	00 00		 cmp	 DWORD PTR [eax+476], 0
  0003e	74 21		 je	 SHORT $LN3@ReleaseCha
  00040	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00043	8b 80 dc 01 00
	00		 mov	 eax, DWORD PTR [eax+476]
  00049	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0004c	8b 00		 mov	 eax, DWORD PTR [eax]
  0004e	ff b1 dc 01 00
	00		 push	 DWORD PTR [ecx+476]
  00054	ff 50 08	 call	 DWORD PTR [eax+8]
  00057	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0005a	83 a0 dc 01 00
	00 00		 and	 DWORD PTR [eax+476], 0
$LN3@ReleaseCha:

; 62   : 	SAFE_RELEASE(m_lpCharacterShadowMapTexture);

  00061	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00064	83 b8 d4 01 00
	00 00		 cmp	 DWORD PTR [eax+468], 0
  0006b	74 21		 je	 SHORT $LN1@ReleaseCha
  0006d	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00070	8b 80 d4 01 00
	00		 mov	 eax, DWORD PTR [eax+468]
  00076	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00079	8b 00		 mov	 eax, DWORD PTR [eax]
  0007b	ff b1 d4 01 00
	00		 push	 DWORD PTR [ecx+468]
  00081	ff 50 08	 call	 DWORD PTR [eax+8]
  00084	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00087	83 a0 d4 01 00
	00 00		 and	 DWORD PTR [eax+468], 0
$LN1@ReleaseCha:

; 63   : }

  0008e	c9		 leave
  0008f	c3		 ret	 0
?ReleaseCharacterShadowTexture@CMapOutdoor@@QAEXXZ ENDP	; CMapOutdoor::ReleaseCharacterShadowTexture
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\GameLib\MapOutdoorCharacterShadow.cpp
;	COMDAT ?CreateCharacterShadowTexture@CMapOutdoor@@QAEXXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?CreateCharacterShadowTexture@CMapOutdoor@@QAEXXZ PROC	; CMapOutdoor::CreateCharacterShadowTexture, COMDAT
; _this$ = ecx

; 21   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 22   : 	extern bool GRAPHICS_CAPS_CAN_NOT_DRAW_SHADOW;
; 23   : 
; 24   : 	if (GRAPHICS_CAPS_CAN_NOT_DRAW_SHADOW)

  00007	0f b6 05 00 00
	00 00		 movzx	 eax, BYTE PTR ?GRAPHICS_CAPS_CAN_NOT_DRAW_SHADOW@@3_NA ; GRAPHICS_CAPS_CAN_NOT_DRAW_SHADOW
  0000e	85 c0		 test	 eax, eax
  00010	74 05		 je	 SHORT $LN2@CreateChar

; 25   : 		return;

  00012	e9 43 01 00 00	 jmp	 $LN1@CreateChar
$LN2@CreateChar:

; 26   : 
; 27   : 	ReleaseCharacterShadowTexture();

  00017	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0001a	e8 00 00 00 00	 call	 ?ReleaseCharacterShadowTexture@CMapOutdoor@@QAEXXZ ; CMapOutdoor::ReleaseCharacterShadowTexture

; 28   : 
; 29   : 	if (IsLowTextureMemory())

  0001f	e8 00 00 00 00	 call	 ?IsLowTextureMemory@CGraphicBase@@SA_NXZ ; CGraphicBase::IsLowTextureMemory
  00024	0f b6 c0	 movzx	 eax, al
  00027	85 c0		 test	 eax, eax
  00029	74 0d		 je	 SHORT $LN3@CreateChar

; 30   : 		SetShadowTextureSize(128);

  0002b	68 80 00 00 00	 push	 128			; 00000080H
  00030	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00033	e8 00 00 00 00	 call	 ?SetShadowTextureSize@CMapOutdoor@@QAEXG@Z ; CMapOutdoor::SetShadowTextureSize
$LN3@CreateChar:

; 31   : 
; 32   : 	m_ShadowMapViewport.X = 1;

  00038	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0003b	c7 80 e0 01 00
	00 01 00 00 00	 mov	 DWORD PTR [eax+480], 1

; 33   : 	m_ShadowMapViewport.Y = 1;

  00045	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00048	c7 80 e4 01 00
	00 01 00 00 00	 mov	 DWORD PTR [eax+484], 1

; 34   : 	m_ShadowMapViewport.Width = m_wShadowMapSize - 2;

  00052	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00055	0f b7 80 f8 01
	00 00		 movzx	 eax, WORD PTR [eax+504]
  0005c	48		 dec	 eax
  0005d	48		 dec	 eax
  0005e	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00061	89 81 e8 01 00
	00		 mov	 DWORD PTR [ecx+488], eax

; 35   : 	m_ShadowMapViewport.Height = m_wShadowMapSize - 2;

  00067	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0006a	0f b7 80 f8 01
	00 00		 movzx	 eax, WORD PTR [eax+504]
  00071	48		 dec	 eax
  00072	48		 dec	 eax
  00073	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00076	89 81 ec 01 00
	00		 mov	 DWORD PTR [ecx+492], eax

; 36   : 	m_ShadowMapViewport.MinZ = 0.0f;

  0007c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0007f	0f 57 c0	 xorps	 xmm0, xmm0
  00082	f3 0f 11 80 f0
	01 00 00	 movss	 DWORD PTR [eax+496], xmm0

; 37   : 	m_ShadowMapViewport.MaxZ = 1.0f;

  0008a	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0008d	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  00095	f3 0f 11 80 f4
	01 00 00	 movss	 DWORD PTR [eax+500], xmm0

; 38   : 
; 39   : 	if (FAILED(ms_lpd3dDevice->CreateTexture(m_wShadowMapSize, m_wShadowMapSize, 1, D3DUSAGE_RENDERTARGET, D3DFMT_R5G6B5, D3DPOOL_DEFAULT, &m_lpCharacterShadowMapTexture)))

  0009d	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000a0	05 d4 01 00 00	 add	 eax, 468		; 000001d4H
  000a5	50		 push	 eax
  000a6	6a 00		 push	 0
  000a8	6a 17		 push	 23			; 00000017H
  000aa	6a 01		 push	 1
  000ac	6a 01		 push	 1
  000ae	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000b1	0f b7 80 f8 01
	00 00		 movzx	 eax, WORD PTR [eax+504]
  000b8	50		 push	 eax
  000b9	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000bc	0f b7 80 f8 01
	00 00		 movzx	 eax, WORD PTR [eax+504]
  000c3	50		 push	 eax
  000c4	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  000c9	8b 00		 mov	 eax, DWORD PTR [eax]
  000cb	ff 35 00 00 00
	00		 push	 DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  000d1	ff 50 50	 call	 DWORD PTR [eax+80]
  000d4	85 c0		 test	 eax, eax
  000d6	7d 0d		 jge	 SHORT $LN4@CreateChar

; 40   : 	{
; 41   : 		TraceError("CMapOutdoor Unable to create Character Shadow render target texture\n");

  000d8	68 00 00 00 00	 push	 OFFSET ??_C@_0EF@FIJKIKCP@CMapOutdoor?5Unable?5to?5create?5Ch@
  000dd	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  000e2	59		 pop	 ecx

; 42   : 		return;

  000e3	eb 75		 jmp	 SHORT $LN1@CreateChar
$LN4@CreateChar:

; 43   : 	}
; 44   : 
; 45   : 	if (FAILED(m_lpCharacterShadowMapTexture->GetSurfaceLevel(0, &m_lpCharacterShadowMapRenderTargetSurface)))

  000e5	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000e8	05 d8 01 00 00	 add	 eax, 472		; 000001d8H
  000ed	50		 push	 eax
  000ee	6a 00		 push	 0
  000f0	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000f3	8b 80 d4 01 00
	00		 mov	 eax, DWORD PTR [eax+468]
  000f9	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  000fc	8b 00		 mov	 eax, DWORD PTR [eax]
  000fe	ff b1 d4 01 00
	00		 push	 DWORD PTR [ecx+468]
  00104	ff 50 3c	 call	 DWORD PTR [eax+60]
  00107	85 c0		 test	 eax, eax
  00109	7d 0d		 jge	 SHORT $LN5@CreateChar

; 46   : 	{
; 47   : 		TraceError("CMapOutdoor Unable to GetSurfaceLevel Character Shadow render target texture\n");

  0010b	68 00 00 00 00	 push	 OFFSET ??_C@_0EO@LLLBCDDM@CMapOutdoor?5Unable?5to?5GetSurfac@
  00110	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  00115	59		 pop	 ecx

; 48   : 		return;

  00116	eb 42		 jmp	 SHORT $LN1@CreateChar
$LN5@CreateChar:

; 49   : 	}
; 50   : 
; 51   : 	if (FAILED(ms_lpd3dDevice->CreateDepthStencilSurface(m_wShadowMapSize, m_wShadowMapSize, D3DFMT_D16, D3DMULTISAMPLE_NONE, &m_lpCharacterShadowMapDepthSurface)))

  00118	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0011b	05 dc 01 00 00	 add	 eax, 476		; 000001dcH
  00120	50		 push	 eax
  00121	6a 00		 push	 0
  00123	6a 50		 push	 80			; 00000050H
  00125	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00128	0f b7 80 f8 01
	00 00		 movzx	 eax, WORD PTR [eax+504]
  0012f	50		 push	 eax
  00130	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00133	0f b7 80 f8 01
	00 00		 movzx	 eax, WORD PTR [eax+504]
  0013a	50		 push	 eax
  0013b	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  00140	8b 00		 mov	 eax, DWORD PTR [eax]
  00142	ff 35 00 00 00
	00		 push	 DWORD PTR ?ms_lpd3dDevice@CGraphicBase@@1PAUIDirect3DDevice8@@A ; CGraphicBase::ms_lpd3dDevice
  00148	ff 50 68	 call	 DWORD PTR [eax+104]
  0014b	85 c0		 test	 eax, eax
  0014d	7d 0b		 jge	 SHORT $LN6@CreateChar

; 52   : 	{
; 53   : 		TraceError("CMapOutdoor Unable to create Character Shadow depth Surface\n");

  0014f	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@FOIDJBLJ@CMapOutdoor?5Unable?5to?5create?5Ch@
  00154	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  00159	59		 pop	 ecx
$LN6@CreateChar:
$LN1@CreateChar:

; 54   : 		return;
; 55   : 	}
; 56   : }

  0015a	c9		 leave
  0015b	c3		 ret	 0
?CreateCharacterShadowTexture@CMapOutdoor@@QAEXXZ ENDP	; CMapOutdoor::CreateCharacterShadowTexture
_TEXT	ENDS
; Function compile flags: /Odspy
;	COMDAT ??_H@YGXPAXIIP6EPAX0@Z@Z
_TEXT	SEGMENT
tv66 = -4						; size = 4
___t$ = 8						; size = 4
___s$ = 12						; size = 4
___n$ = 16						; size = 4
___f$ = 20						; size = 4
??_H@YGXPAXIIP6EPAX0@Z@Z PROC				; `vector constructor iterator', COMDAT
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
$LN2@vector:
  00004	8b 45 10	 mov	 eax, DWORD PTR ___n$[ebp]
  00007	89 45 fc	 mov	 DWORD PTR tv66[ebp], eax
  0000a	8b 45 10	 mov	 eax, DWORD PTR ___n$[ebp]
  0000d	48		 dec	 eax
  0000e	89 45 10	 mov	 DWORD PTR ___n$[ebp], eax
  00011	83 7d fc 00	 cmp	 DWORD PTR tv66[ebp], 0
  00015	76 11		 jbe	 SHORT $LN1@vector
  00017	8b 4d 08	 mov	 ecx, DWORD PTR ___t$[ebp]
  0001a	ff 55 14	 call	 DWORD PTR ___f$[ebp]
  0001d	8b 45 08	 mov	 eax, DWORD PTR ___t$[ebp]
  00020	03 45 0c	 add	 eax, DWORD PTR ___s$[ebp]
  00023	89 45 08	 mov	 DWORD PTR ___t$[ebp], eax
  00026	eb dc		 jmp	 SHORT $LN2@vector
$LN1@vector:
  00028	c9		 leave
  00029	c2 10 00	 ret	 16			; 00000010H
??_H@YGXPAXIIP6EPAX0@Z@Z ENDP				; `vector constructor iterator'
_TEXT	ENDS
END

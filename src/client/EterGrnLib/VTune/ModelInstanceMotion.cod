; Listing generated by Microsoft (R) Optimizing Compiler Version 19.28.29335.0 

	TITLE	D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterGrnLib\ModelInstanceMotion.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?SetMotionPointer@CGrannyModelInstance@@QAEXPBVCGrannyMotion@@MHM@Z ; CGrannyModelInstance::SetMotionPointer
PUBLIC	?ChangeMotionPointer@CGrannyModelInstance@@QAEXPBVCGrannyMotion@@HM@Z ; CGrannyModelInstance::ChangeMotionPointer
PUBLIC	?SetMotionAtEnd@CGrannyModelInstance@@QAEXXZ	; CGrannyModelInstance::SetMotionAtEnd
PUBLIC	?IsMotionPlaying@CGrannyModelInstance@@QAE_NXZ	; CGrannyModelInstance::IsMotionPlaying
PUBLIC	?CopyMotion@CGrannyModelInstance@@QAEXPAV1@_N@Z	; CGrannyModelInstance::CopyMotion
PUBLIC	__real@00000000
PUBLIC	__real@3e99999a
PUBLIC	__real@3f800000
EXTRN	__imp__GrannyFreeControl@4:PROC
EXTRN	__imp__GrannyFreeControlOnceUnused@4:PROC
EXTRN	__imp__GrannyCompleteControlAt@8:PROC
EXTRN	__imp__GrannyControlIsComplete@4:PROC
EXTRN	__imp__GrannyFreeControlIfComplete@4:PROC
EXTRN	__imp__GrannyGetControlLoopCount@4:PROC
EXTRN	__imp__GrannySetControlLoopCount@8:PROC
EXTRN	__imp__GrannyGetControlSpeed@4:PROC
EXTRN	__imp__GrannySetControlSpeed@8:PROC
EXTRN	__imp__GrannyGetControlLocalDuration@4:PROC
EXTRN	__imp__GrannySetControlEaseIn@8:PROC
EXTRN	__imp__GrannySetControlEaseInCurve@28:PROC
EXTRN	__imp__GrannySetControlEaseOut@8:PROC
EXTRN	__imp__GrannySetControlEaseOutCurve@28:PROC
EXTRN	__imp__GrannyGetControlRawLocalClock@4:PROC
EXTRN	__imp__GrannySetControlRawLocalClock@8:PROC
EXTRN	__imp__GrannyPlayControlledAnimation@12:PROC
EXTRN	?GetGrannyAnimationPointer@CGrannyMotion@@QBEPAUgranny_animation@@XZ:PROC ; CGrannyMotion::GetGrannyAnimationPointer
EXTRN	?GetLocalTime@CGrannyModelInstance@@QAEMXZ:PROC	; CGrannyModelInstance::GetLocalTime
EXTRN	__fltused:DWORD
;	COMDAT __real@3f800000
CONST	SEGMENT
__real@3f800000 DD 03f800000r			; 1
CONST	ENDS
;	COMDAT __real@3e99999a
CONST	SEGMENT
__real@3e99999a DD 03e99999ar			; 0.3
CONST	ENDS
;	COMDAT __real@00000000
CONST	SEGMENT
__real@00000000 DD 000000000r			; 0
CONST	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterGrnLib\ModelInstanceMotion.cpp
;	COMDAT ?CopyMotion@CGrannyModelInstance@@QAEXPAV1@_N@Z
_TEXT	SEGMENT
_localTime$ = -8					; size = 4
_this$ = -4						; size = 4
_pModelInstance$ = 8					; size = 4
_bIsFreeSourceControl$ = 12				; size = 1
?CopyMotion@CGrannyModelInstance@@QAEXPAV1@_N@Z PROC	; CGrannyModelInstance::CopyMotion, COMDAT
; _this$ = ecx

; 6    : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	51		 push	 ecx
  00005	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 7    : 	if (!pModelInstance->IsMotionPlaying())

  00008	8b 4d 08	 mov	 ecx, DWORD PTR _pModelInstance$[ebp]
  0000b	e8 00 00 00 00	 call	 ?IsMotionPlaying@CGrannyModelInstance@@QAE_NXZ ; CGrannyModelInstance::IsMotionPlaying
  00010	0f b6 c0	 movzx	 eax, al
  00013	85 c0		 test	 eax, eax
  00015	75 05		 jne	 SHORT $LN2@CopyMotion

; 8    : 		return;

  00017	e9 f1 00 00 00	 jmp	 $LN1@CopyMotion
$LN2@CopyMotion:

; 9    : 
; 10   : 	if (m_pgrnCtrl)

  0001c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0001f	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  00023	74 0c		 je	 SHORT $LN3@CopyMotion

; 11   : 		GrannyFreeControl(m_pgrnCtrl);

  00025	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00028	ff 70 0c	 push	 DWORD PTR [eax+12]
  0002b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyFreeControl@4
$LN3@CopyMotion:

; 12   : 
; 13   : 	float localTime = GetLocalTime();

  00031	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00034	e8 00 00 00 00	 call	 ?GetLocalTime@CGrannyModelInstance@@QAEMXZ ; CGrannyModelInstance::GetLocalTime
  00039	d9 5d f8	 fstp	 DWORD PTR _localTime$[ebp]

; 14   : 	m_pgrnAni = pModelInstance->m_pgrnAni;

  0003c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0003f	8b 4d 08	 mov	 ecx, DWORD PTR _pModelInstance$[ebp]
  00042	8b 49 10	 mov	 ecx, DWORD PTR [ecx+16]
  00045	89 48 10	 mov	 DWORD PTR [eax+16], ecx

; 15   : 	m_pgrnCtrl = GrannyPlayControlledAnimation(localTime, m_pgrnAni, m_pgrnModelInstance);

  00048	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0004b	ff 70 08	 push	 DWORD PTR [eax+8]
  0004e	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00051	ff 70 10	 push	 DWORD PTR [eax+16]
  00054	51		 push	 ecx
  00055	f3 0f 10 45 f8	 movss	 xmm0, DWORD PTR _localTime$[ebp]
  0005a	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0005f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyPlayControlledAnimation@12
  00065	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00068	89 41 0c	 mov	 DWORD PTR [ecx+12], eax

; 16   : 
; 17   : 	if (!m_pgrnCtrl)

  0006b	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0006e	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  00072	75 05		 jne	 SHORT $LN4@CopyMotion

; 18   : 		return;

  00074	e9 94 00 00 00	 jmp	 $LN1@CopyMotion
$LN4@CopyMotion:

; 19   : 
; 20   : 	GrannySetControlSpeed(m_pgrnCtrl, GrannyGetControlSpeed(pModelInstance->m_pgrnCtrl));

  00079	8b 45 08	 mov	 eax, DWORD PTR _pModelInstance$[ebp]
  0007c	ff 70 0c	 push	 DWORD PTR [eax+12]
  0007f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyGetControlSpeed@4
  00085	51		 push	 ecx
  00086	d9 1c 24	 fstp	 DWORD PTR [esp]
  00089	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0008c	ff 70 0c	 push	 DWORD PTR [eax+12]
  0008f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlSpeed@8

; 21   : 	GrannySetControlLoopCount(m_pgrnCtrl, GrannyGetControlLoopCount(pModelInstance->m_pgrnCtrl));

  00095	8b 45 08	 mov	 eax, DWORD PTR _pModelInstance$[ebp]
  00098	ff 70 0c	 push	 DWORD PTR [eax+12]
  0009b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyGetControlLoopCount@4
  000a1	50		 push	 eax
  000a2	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000a5	ff 70 0c	 push	 DWORD PTR [eax+12]
  000a8	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlLoopCount@8

; 22   : 
; 23   : 	GrannySetControlEaseIn(m_pgrnCtrl, true);

  000ae	6a 01		 push	 1
  000b0	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000b3	ff 70 0c	 push	 DWORD PTR [eax+12]
  000b6	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseIn@8

; 24   : 	GrannySetControlEaseOut(m_pgrnCtrl, false);

  000bc	6a 00		 push	 0
  000be	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000c1	ff 70 0c	 push	 DWORD PTR [eax+12]
  000c4	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseOut@8

; 25   : 
; 26   : 	GrannySetControlRawLocalClock(m_pgrnCtrl, GrannyGetControlRawLocalClock(pModelInstance->m_pgrnCtrl));

  000ca	8b 45 08	 mov	 eax, DWORD PTR _pModelInstance$[ebp]
  000cd	ff 70 0c	 push	 DWORD PTR [eax+12]
  000d0	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyGetControlRawLocalClock@4
  000d6	51		 push	 ecx
  000d7	d9 1c 24	 fstp	 DWORD PTR [esp]
  000da	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000dd	ff 70 0c	 push	 DWORD PTR [eax+12]
  000e0	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlRawLocalClock@8

; 27   : 
; 28   : 	GrannyFreeControlOnceUnused(m_pgrnCtrl);

  000e6	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000e9	ff 70 0c	 push	 DWORD PTR [eax+12]
  000ec	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyFreeControlOnceUnused@4

; 29   : 
; 30   : 	if (bIsFreeSourceControl)

  000f2	0f b6 45 0c	 movzx	 eax, BYTE PTR _bIsFreeSourceControl$[ebp]
  000f6	85 c0		 test	 eax, eax
  000f8	74 13		 je	 SHORT $LN5@CopyMotion

; 31   : 	{
; 32   : 		GrannyFreeControl(pModelInstance->m_pgrnCtrl);

  000fa	8b 45 08	 mov	 eax, DWORD PTR _pModelInstance$[ebp]
  000fd	ff 70 0c	 push	 DWORD PTR [eax+12]
  00100	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyFreeControl@4

; 33   : 		pModelInstance->m_pgrnCtrl = NULL;

  00106	8b 45 08	 mov	 eax, DWORD PTR _pModelInstance$[ebp]
  00109	83 60 0c 00	 and	 DWORD PTR [eax+12], 0
$LN5@CopyMotion:
$LN1@CopyMotion:

; 34   : 	}
; 35   : }

  0010d	c9		 leave
  0010e	c2 08 00	 ret	 8
?CopyMotion@CGrannyModelInstance@@QAEXPAV1@_N@Z ENDP	; CGrannyModelInstance::CopyMotion
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterGrnLib\ModelInstanceMotion.cpp
;	COMDAT ?IsMotionPlaying@CGrannyModelInstance@@QAE_NXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?IsMotionPlaying@CGrannyModelInstance@@QAE_NXZ PROC	; CGrannyModelInstance::IsMotionPlaying, COMDAT
; _this$ = ecx

; 38   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 39   : 	if (!m_pgrnCtrl)

  00007	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000a	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  0000e	75 04		 jne	 SHORT $LN2@IsMotionPl

; 40   : 		return false;

  00010	32 c0		 xor	 al, al
  00012	eb 19		 jmp	 SHORT $LN1@IsMotionPl
$LN2@IsMotionPl:

; 41   : 
; 42   : 	if (GrannyControlIsComplete(m_pgrnCtrl))

  00014	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00017	ff 70 0c	 push	 DWORD PTR [eax+12]
  0001a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyControlIsComplete@4
  00020	0f b6 c0	 movzx	 eax, al
  00023	85 c0		 test	 eax, eax
  00025	74 04		 je	 SHORT $LN3@IsMotionPl

; 43   : 		return false;

  00027	32 c0		 xor	 al, al
  00029	eb 02		 jmp	 SHORT $LN1@IsMotionPl
$LN3@IsMotionPl:

; 44   : 
; 45   : 	return true;

  0002b	b0 01		 mov	 al, 1
$LN1@IsMotionPl:

; 46   : }

  0002d	c9		 leave
  0002e	c3		 ret	 0
?IsMotionPlaying@CGrannyModelInstance@@QAE_NXZ ENDP	; CGrannyModelInstance::IsMotionPlaying
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterGrnLib\ModelInstanceMotion.cpp
;	COMDAT ?SetMotionAtEnd@CGrannyModelInstance@@QAEXXZ
_TEXT	SEGMENT
_endingTime$ = -8					; size = 4
_this$ = -4						; size = 4
?SetMotionAtEnd@CGrannyModelInstance@@QAEXXZ PROC	; CGrannyModelInstance::SetMotionAtEnd, COMDAT
; _this$ = ecx

; 141  : {	

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	51		 push	 ecx
  00005	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 142  : 	if (!m_pgrnCtrl)

  00008	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000b	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  0000f	75 02		 jne	 SHORT $LN2@SetMotionA

; 143  : 		return;

  00011	eb 26		 jmp	 SHORT $LN1@SetMotionA
$LN2@SetMotionA:

; 144  : 
; 145  : 	//Tracef("%f\n", endingTime);
; 146  : 	float endingTime = GrannyGetControlLocalDuration(m_pgrnCtrl);

  00013	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00016	ff 70 0c	 push	 DWORD PTR [eax+12]
  00019	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyGetControlLocalDuration@4
  0001f	d9 5d f8	 fstp	 DWORD PTR _endingTime$[ebp]

; 147  : 	GrannySetControlRawLocalClock(m_pgrnCtrl, endingTime);

  00022	51		 push	 ecx
  00023	f3 0f 10 45 f8	 movss	 xmm0, DWORD PTR _endingTime$[ebp]
  00028	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0002d	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00030	ff 70 0c	 push	 DWORD PTR [eax+12]
  00033	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlRawLocalClock@8
$LN1@SetMotionA:

; 148  : }

  00039	c9		 leave
  0003a	c3		 ret	 0
?SetMotionAtEnd@CGrannyModelInstance@@QAEXXZ ENDP	; CGrannyModelInstance::SetMotionAtEnd
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterGrnLib\ModelInstanceMotion.cpp
;	COMDAT ?ChangeMotionPointer@CGrannyModelInstance@@QAEXPBVCGrannyMotion@@HM@Z
_TEXT	SEGMENT
_fSkipTime$ = -20					; size = 4
tv145 = -16						; size = 4
_localTime$ = -12					; size = 4
_pgrnModelInstance$ = -8				; size = 4
_this$ = -4						; size = 4
_pMotion$ = 8						; size = 4
_loopCount$ = 12					; size = 4
_speedRatio$ = 16					; size = 4
?ChangeMotionPointer@CGrannyModelInstance@@QAEXPBVCGrannyMotion@@HM@Z PROC ; CGrannyModelInstance::ChangeMotionPointer, COMDAT
; _this$ = ecx

; 110  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 111  : 	granny_model_instance * pgrnModelInstance = m_pgrnModelInstance;

  00009	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000c	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  0000f	89 45 f8	 mov	 DWORD PTR _pgrnModelInstance$[ebp], eax

; 112  : 	if (!pgrnModelInstance)

  00012	83 7d f8 00	 cmp	 DWORD PTR _pgrnModelInstance$[ebp], 0
  00016	75 05		 jne	 SHORT $LN2@ChangeMoti

; 113  : 		return;

  00018	e9 f6 00 00 00	 jmp	 $LN1@ChangeMoti
$LN2@ChangeMoti:

; 114  : 
; 115  : 	// 보간 되는 앞부분을 스킵 하기 위해 LocalTime 을 어느 정도 무시한다. - [levites]
; 116  : 	float fSkipTime = 0.3f;

  0001d	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3e99999a
  00025	f3 0f 11 45 ec	 movss	 DWORD PTR _fSkipTime$[ebp], xmm0

; 117  : 	float localTime = GetLocalTime() - fSkipTime;

  0002a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0002d	e8 00 00 00 00	 call	 ?GetLocalTime@CGrannyModelInstance@@QAEMXZ ; CGrannyModelInstance::GetLocalTime
  00032	d9 5d f0	 fstp	 DWORD PTR tv145[ebp]
  00035	f3 0f 10 45 f0	 movss	 xmm0, DWORD PTR tv145[ebp]
  0003a	f3 0f 5c 45 ec	 subss	 xmm0, DWORD PTR _fSkipTime$[ebp]
  0003f	f3 0f 11 45 f4	 movss	 DWORD PTR _localTime$[ebp], xmm0

; 118  : 
; 119  : 	if (m_pgrnCtrl)

  00044	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00047	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  0004b	74 3f		 je	 SHORT $LN3@ChangeMoti

; 120  : 	{
; 121  : 		GrannySetControlEaseIn(m_pgrnCtrl, false);

  0004d	6a 00		 push	 0
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00052	ff 70 0c	 push	 DWORD PTR [eax+12]
  00055	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseIn@8

; 122  : 		GrannySetControlEaseOut(m_pgrnCtrl, false);

  0005b	6a 00		 push	 0
  0005d	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00060	ff 70 0c	 push	 DWORD PTR [eax+12]
  00063	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseOut@8

; 123  : 		GrannyCompleteControlAt(m_pgrnCtrl, localTime);

  00069	51		 push	 ecx
  0006a	f3 0f 10 45 f4	 movss	 xmm0, DWORD PTR _localTime$[ebp]
  0006f	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00074	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00077	ff 70 0c	 push	 DWORD PTR [eax+12]
  0007a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyCompleteControlAt@8

; 124  : 		GrannyFreeControlIfComplete(m_pgrnCtrl);

  00080	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00083	ff 70 0c	 push	 DWORD PTR [eax+12]
  00086	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyFreeControlIfComplete@4
$LN3@ChangeMoti:

; 125  : 	}
; 126  : 
; 127  : 	m_pgrnAni = pMotion->GetGrannyAnimationPointer();

  0008c	8b 4d 08	 mov	 ecx, DWORD PTR _pMotion$[ebp]
  0008f	e8 00 00 00 00	 call	 ?GetGrannyAnimationPointer@CGrannyMotion@@QBEPAUgranny_animation@@XZ ; CGrannyMotion::GetGrannyAnimationPointer
  00094	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00097	89 41 10	 mov	 DWORD PTR [ecx+16], eax

; 128  : 	m_pgrnCtrl = GrannyPlayControlledAnimation(localTime, m_pgrnAni, pgrnModelInstance);

  0009a	ff 75 f8	 push	 DWORD PTR _pgrnModelInstance$[ebp]
  0009d	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000a0	ff 70 10	 push	 DWORD PTR [eax+16]
  000a3	51		 push	 ecx
  000a4	f3 0f 10 45 f4	 movss	 xmm0, DWORD PTR _localTime$[ebp]
  000a9	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  000ae	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyPlayControlledAnimation@12
  000b4	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  000b7	89 41 0c	 mov	 DWORD PTR [ecx+12], eax

; 129  : 	if (!m_pgrnCtrl)

  000ba	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000bd	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  000c1	75 02		 jne	 SHORT $LN4@ChangeMoti

; 130  : 		return;

  000c3	eb 4e		 jmp	 SHORT $LN1@ChangeMoti
$LN4@ChangeMoti:

; 131  : 
; 132  : 	GrannySetControlSpeed(m_pgrnCtrl, speedRatio);

  000c5	51		 push	 ecx
  000c6	f3 0f 10 45 10	 movss	 xmm0, DWORD PTR _speedRatio$[ebp]
  000cb	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  000d0	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000d3	ff 70 0c	 push	 DWORD PTR [eax+12]
  000d6	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlSpeed@8

; 133  : 	GrannySetControlLoopCount(m_pgrnCtrl, loopCount);

  000dc	ff 75 0c	 push	 DWORD PTR _loopCount$[ebp]
  000df	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000e2	ff 70 0c	 push	 DWORD PTR [eax+12]
  000e5	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlLoopCount@8

; 134  : 	GrannySetControlEaseIn(m_pgrnCtrl, false);

  000eb	6a 00		 push	 0
  000ed	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000f0	ff 70 0c	 push	 DWORD PTR [eax+12]
  000f3	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseIn@8

; 135  : 	GrannySetControlEaseOut(m_pgrnCtrl, false);

  000f9	6a 00		 push	 0
  000fb	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000fe	ff 70 0c	 push	 DWORD PTR [eax+12]
  00101	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseOut@8

; 136  : 
; 137  : 	GrannyFreeControlOnceUnused(m_pgrnCtrl);

  00107	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0010a	ff 70 0c	 push	 DWORD PTR [eax+12]
  0010d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyFreeControlOnceUnused@4
$LN1@ChangeMoti:

; 138  : }

  00113	c9		 leave
  00114	c2 0c 00	 ret	 12			; 0000000cH
?ChangeMotionPointer@CGrannyModelInstance@@QAEXPBVCGrannyMotion@@HM@Z ENDP ; CGrannyModelInstance::ChangeMotionPointer
_TEXT	ENDS
; Function compile flags: /Odspy
; File D:\Metin2 Server Files\mainline\SRC_2014\Metin2Client\eterGrnLib\ModelInstanceMotion.cpp
;	COMDAT ?SetMotionPointer@CGrannyModelInstance@@QAEXPBVCGrannyMotion@@MHM@Z
_TEXT	SEGMENT
_pgrnModelInstance$ = -16				; size = 4
_localTime$ = -12					; size = 4
_this$ = -8						; size = 4
_isFirst$ = -1						; size = 1
_pMotion$ = 8						; size = 4
_blendTime$ = 12					; size = 4
_loopCount$ = 16					; size = 4
_speedRatio$ = 20					; size = 4
?SetMotionPointer@CGrannyModelInstance@@QAEXPBVCGrannyMotion@@MHM@Z PROC ; CGrannyModelInstance::SetMotionPointer, COMDAT
; _this$ = ecx

; 49   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 10	 sub	 esp, 16			; 00000010H
  00006	89 4d f8	 mov	 DWORD PTR _this$[ebp], ecx

; 50   : 	// TEST
; 51   : 	if (!m_pgrnWorldPoseReal)

  00009	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0000c	83 78 3c 00	 cmp	 DWORD PTR [eax+60], 0
  00010	75 05		 jne	 SHORT $LN2@SetMotionP

; 52   : 		return;

  00012	e9 e2 01 00 00	 jmp	 $LN1@SetMotionP
$LN2@SetMotionP:

; 53   : 	// END_OF_TEST
; 54   : 
; 55   : 	granny_model_instance * pgrnModelInstance = m_pgrnModelInstance;

  00017	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0001a	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  0001d	89 45 f0	 mov	 DWORD PTR _pgrnModelInstance$[ebp], eax

; 56   : 	if (!pgrnModelInstance)

  00020	83 7d f0 00	 cmp	 DWORD PTR _pgrnModelInstance$[ebp], 0
  00024	75 05		 jne	 SHORT $LN3@SetMotionP

; 57   : 		return;

  00026	e9 ce 01 00 00	 jmp	 $LN1@SetMotionP
$LN3@SetMotionP:

; 58   : 
; 59   : 	float localTime = GetLocalTime();

  0002b	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  0002e	e8 00 00 00 00	 call	 ?GetLocalTime@CGrannyModelInstance@@QAEMXZ ; CGrannyModelInstance::GetLocalTime
  00033	d9 5d f4	 fstp	 DWORD PTR _localTime$[ebp]

; 60   : 
; 61   : 	bool isFirst=false;

  00036	c6 45 ff 00	 mov	 BYTE PTR _isFirst$[ebp], 0

; 62   : 	if (m_pgrnCtrl)

  0003a	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0003d	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  00041	0f 84 9b 00 00
	00		 je	 $LN4@SetMotionP

; 63   : 	{
; 64   : 		//float durationLeft = GrannyGetControlDurationLeft(m_pgrnCtrl);
; 65   : 		//float easeOutTime = (blendTime < durationLeft) ? blendTime : durationLeft;
; 66   : 		//float oldCtrlFinishTime = GrannyEaseControlOut(m_pgrnCtrl, blendTime); //easeOutTime);
; 67   : 		GrannySetControlEaseOutCurve(m_pgrnCtrl, localTime, localTime + blendTime, 1.0f, 1.0f, 0.0f, 0.0f);

  00047	51		 push	 ecx
  00048	0f 57 c0	 xorps	 xmm0, xmm0
  0004b	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00050	51		 push	 ecx
  00051	0f 57 c0	 xorps	 xmm0, xmm0
  00054	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00059	51		 push	 ecx
  0005a	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  00062	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00067	51		 push	 ecx
  00068	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  00070	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00075	f3 0f 10 45 f4	 movss	 xmm0, DWORD PTR _localTime$[ebp]
  0007a	f3 0f 58 45 0c	 addss	 xmm0, DWORD PTR _blendTime$[ebp]
  0007f	51		 push	 ecx
  00080	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00085	51		 push	 ecx
  00086	f3 0f 10 45 f4	 movss	 xmm0, DWORD PTR _localTime$[ebp]
  0008b	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00090	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00093	ff 70 0c	 push	 DWORD PTR [eax+12]
  00096	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseOutCurve@28

; 68   : 
; 69   : 		GrannySetControlEaseIn(m_pgrnCtrl, false);

  0009c	6a 00		 push	 0
  0009e	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000a1	ff 70 0c	 push	 DWORD PTR [eax+12]
  000a4	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseIn@8

; 70   : 		GrannySetControlEaseOut(m_pgrnCtrl, true);

  000aa	6a 01		 push	 1
  000ac	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000af	ff 70 0c	 push	 DWORD PTR [eax+12]
  000b2	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseOut@8

; 71   : 
; 72   : 		//Tracef("easeOut %f\n", easeOutTime);
; 73   : 		GrannyCompleteControlAt(m_pgrnCtrl, localTime + blendTime);

  000b8	f3 0f 10 45 f4	 movss	 xmm0, DWORD PTR _localTime$[ebp]
  000bd	f3 0f 58 45 0c	 addss	 xmm0, DWORD PTR _blendTime$[ebp]
  000c2	51		 push	 ecx
  000c3	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  000c8	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000cb	ff 70 0c	 push	 DWORD PTR [eax+12]
  000ce	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyCompleteControlAt@8

; 74   : 		//GrannyCompleteControlAt(m_pgrnCtrl, oldCtrlFinishTime);
; 75   : 		//GrannyCompleteControlAt(m_pgrnCtrl, localTime);
; 76   : 		GrannyFreeControlIfComplete(m_pgrnCtrl);

  000d4	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000d7	ff 70 0c	 push	 DWORD PTR [eax+12]
  000da	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyFreeControlIfComplete@4

; 77   : 	}

  000e0	eb 04		 jmp	 SHORT $LN5@SetMotionP
$LN4@SetMotionP:

; 78   : 	else
; 79   : 	{
; 80   : 		isFirst=true;

  000e2	c6 45 ff 01	 mov	 BYTE PTR _isFirst$[ebp], 1
$LN5@SetMotionP:

; 81   : 	}
; 82   : 
; 83   : 	m_pgrnAni = pMotion->GetGrannyAnimationPointer();

  000e6	8b 4d 08	 mov	 ecx, DWORD PTR _pMotion$[ebp]
  000e9	e8 00 00 00 00	 call	 ?GetGrannyAnimationPointer@CGrannyMotion@@QBEPAUgranny_animation@@XZ ; CGrannyMotion::GetGrannyAnimationPointer
  000ee	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  000f1	89 41 10	 mov	 DWORD PTR [ecx+16], eax

; 84   : 	m_pgrnCtrl = GrannyPlayControlledAnimation(localTime, m_pgrnAni, pgrnModelInstance);

  000f4	ff 75 f0	 push	 DWORD PTR _pgrnModelInstance$[ebp]
  000f7	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000fa	ff 70 10	 push	 DWORD PTR [eax+16]
  000fd	51		 push	 ecx
  000fe	f3 0f 10 45 f4	 movss	 xmm0, DWORD PTR _localTime$[ebp]
  00103	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00108	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyPlayControlledAnimation@12
  0010e	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00111	89 41 0c	 mov	 DWORD PTR [ecx+12], eax

; 85   : 	if (!m_pgrnCtrl)

  00114	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00117	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  0011b	75 05		 jne	 SHORT $LN6@SetMotionP

; 86   : 		return;

  0011d	e9 d7 00 00 00	 jmp	 $LN1@SetMotionP
$LN6@SetMotionP:

; 87   : 
; 88   : 	GrannySetControlSpeed(m_pgrnCtrl, speedRatio);

  00122	51		 push	 ecx
  00123	f3 0f 10 45 14	 movss	 xmm0, DWORD PTR _speedRatio$[ebp]
  00128	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0012d	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00130	ff 70 0c	 push	 DWORD PTR [eax+12]
  00133	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlSpeed@8

; 89   : 	GrannySetControlLoopCount(m_pgrnCtrl, loopCount);

  00139	ff 75 10	 push	 DWORD PTR _loopCount$[ebp]
  0013c	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0013f	ff 70 0c	 push	 DWORD PTR [eax+12]
  00142	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlLoopCount@8

; 90   : 
; 91   : 	if (isFirst)

  00148	0f b6 45 ff	 movzx	 eax, BYTE PTR _isFirst$[ebp]
  0014c	85 c0		 test	 eax, eax
  0014e	74 1e		 je	 SHORT $LN7@SetMotionP

; 92   : 	{
; 93   : 		GrannySetControlEaseIn(m_pgrnCtrl, false);

  00150	6a 00		 push	 0
  00152	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00155	ff 70 0c	 push	 DWORD PTR [eax+12]
  00158	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseIn@8

; 94   : 		GrannySetControlEaseOut(m_pgrnCtrl, false);

  0015e	6a 00		 push	 0
  00160	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00163	ff 70 0c	 push	 DWORD PTR [eax+12]
  00166	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseOut@8

; 95   : 	}

  0016c	eb 7f		 jmp	 SHORT $LN9@SetMotionP
$LN7@SetMotionP:

; 96   : 	else
; 97   : 	{
; 98   : 		GrannySetControlEaseIn(m_pgrnCtrl, true);

  0016e	6a 01		 push	 1
  00170	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00173	ff 70 0c	 push	 DWORD PTR [eax+12]
  00176	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseIn@8

; 99   : 		GrannySetControlEaseOut(m_pgrnCtrl, false);

  0017c	6a 00		 push	 0
  0017e	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00181	ff 70 0c	 push	 DWORD PTR [eax+12]
  00184	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseOut@8

; 100  : 		if (blendTime > 0.0f)

  0018a	f3 0f 10 45 0c	 movss	 xmm0, DWORD PTR _blendTime$[ebp]
  0018f	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@00000000
  00196	76 55		 jbe	 SHORT $LN9@SetMotionP

; 101  : 			GrannySetControlEaseInCurve(m_pgrnCtrl, localTime, localTime + blendTime, 0.0f, 0.0f, 1.0f, 1.0f);

  00198	51		 push	 ecx
  00199	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  001a1	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001a6	51		 push	 ecx
  001a7	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  001af	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001b4	51		 push	 ecx
  001b5	0f 57 c0	 xorps	 xmm0, xmm0
  001b8	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001bd	51		 push	 ecx
  001be	0f 57 c0	 xorps	 xmm0, xmm0
  001c1	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001c6	f3 0f 10 45 f4	 movss	 xmm0, DWORD PTR _localTime$[ebp]
  001cb	f3 0f 58 45 0c	 addss	 xmm0, DWORD PTR _blendTime$[ebp]
  001d0	51		 push	 ecx
  001d1	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001d6	51		 push	 ecx
  001d7	f3 0f 10 45 f4	 movss	 xmm0, DWORD PTR _localTime$[ebp]
  001dc	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001e1	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  001e4	ff 70 0c	 push	 DWORD PTR [eax+12]
  001e7	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannySetControlEaseInCurve@28
$LN9@SetMotionP:

; 102  : 	}
; 103  : 
; 104  : 	//GrannyEaseControlIn(m_pgrnCtrl, blendTime, false);
; 105  : 	GrannyFreeControlOnceUnused(m_pgrnCtrl);

  001ed	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  001f0	ff 70 0c	 push	 DWORD PTR [eax+12]
  001f3	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GrannyFreeControlOnceUnused@4
$LN1@SetMotionP:

; 106  : 	//Tracef("easeIn %f\n", blendTime);
; 107  : }

  001f9	c9		 leave
  001fa	c2 10 00	 ret	 16			; 00000010H
?SetMotionPointer@CGrannyModelInstance@@QAEXPBVCGrannyMotion@@MHM@Z ENDP ; CGrannyModelInstance::SetMotionPointer
_TEXT	ENDS
END
